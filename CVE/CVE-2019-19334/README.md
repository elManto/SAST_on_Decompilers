# Project 

libyang (https://github.com/CESNET/libyang), commit 9c3ee622f812129620f78d0c4a9909c54d47f63e 

# Description

The bug is a buffer overflow in the src/parser.c file originated from an unchecked strcpy() invocation (line 1028)

# Detections

1. cppcheck
2. flawfinder
3. Clang Static Analyser 
4. ikos
5. joern (probably)

# Decompiled code

Failure in recovering the correct size of the buffer use to write the data with the strcpy. More specifically IDA cannot recover the size (so in IDA decompiled code the buffer is just a ```char*``` variable, whereas in ghidra the type inference is wrong (uint instead of char) leading to a different size. User should help the decompiler to guess the correct size (or the correct type).

Notice, that in this case decompiler should infer the correct size, because at the beginning of the vulnerable function, the bug is declared as ```const uint16_t buf_len = 511; char buf[buf_len + 1];```. Therefore, even if the decompiler replaces this with the ```alloca()``` macro, we can guess the correct size, but the decompilers then fail to understand that buf is the destination of the strcpy.
