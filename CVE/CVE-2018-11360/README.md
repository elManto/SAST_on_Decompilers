# Project 

Wireshark (https://github.com/wireshark/wireshark.git), commit ab8a33ef083b9732c89117747a83a905a676faf6

# Description

The bug is an off-by-one overflow in a heap-allocated buffer. It is more complicated because it takes place in two distinct procedures. First, in the file ```/epan/dissectors/packet-gsm_a_dtap.c``` the code invokes a memory allocation with size ```ia5_string_len``` (function ```de_sub_addr```, line 2321).

Then, the procedure ```IA5_7BIT_decode()``` is called. Looking at its implementation in file ```epan/strutil.c```, we can note at line 1192 the following write:

	dest[i] = 0

where ```dest``` is the dynamically allocated buffer previously described, whereas ```i``` evaluates ```ia5_string_len + 1```. That creates an off-by-one error.

# Detections

1. ikos
2. code-ql

# Decompiled code

If the analyst can fix the decompiled code and port it to a compiled version, ikos can detect the bug anyway
