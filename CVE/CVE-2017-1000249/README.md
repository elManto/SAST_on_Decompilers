# Project 

File (https://github.com/file/file.git), commit 9611f31313a93aa036389c5f3b15eea53510d4d1

# Description

The bug is a buffer overflow in the readelf.c file and it is originated from a wrong check. In line 512 we have the following condition:
	
	if (... && (descsz >= 4 || descsz <= 20)) { ... }

However this boolean expression evaluates always true and leads to a buffer overflow at line 533

# Detections

1. cppcheck
2. flawfinder
3. joern (probably)
4. ikos 

# Decompiled code

It changes in 2 ways:

1. memcpy\_chk instead of memcpy (it depends on the compiler options, in this case fortify was enabled)
2. the useless check on ```descsz``` is removed at compile time (compiler generates optimized code)


# Porting pseudocode to compiled code

Time: ~4h
LOCs: ~18K
Actions:

1. Add the Include
2. Define global variables
3. Exclude libc-level functions
4. Fix some function call
