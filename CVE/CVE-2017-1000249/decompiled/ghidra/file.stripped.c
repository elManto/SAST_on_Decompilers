#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>

typedef unsigned char   undefined;

typedef unsigned char    byte;
typedef unsigned char    dwfenc;
typedef unsigned int    dword;
typedef unsigned long    qword;
typedef unsigned char    uchar;
typedef unsigned int    uint;
typedef unsigned long    ulong;
typedef unsigned long long    ulonglong;
typedef unsigned char    undefined1;
typedef unsigned short    undefined2;
typedef unsigned int    undefined4;
typedef unsigned long    undefined8;
typedef unsigned short    ushort;
typedef int    wchar_t;
typedef unsigned short    word;


typedef struct stat stat, *Pstat;







long DAT_003204e8;
long DAT_0011b5c0;
long DAT_0011b620;
long DAT_0011b5e0;
long DAT_0011b165;
long DAT_0011b168;
long DAT_0011b16c;
long DAT_0011b6ff;
long DAT_0011b1b6;
long DAT_0011b6eb;
long DAT_0011ad97;
long DAT_0011b6ee;
long DAT_0011b239;
long DAT_0031f860;
long DAT_0031f6c0;
long DAT_003204e0;
long PTR_LOOP_00320380;
long DAT_001183af;
long _bVar4;
long DAT_003204f4;
long DAT_003205e0;
long DAT_00320500;
long DAT_00119671;
long DAT_001184e3;
long DAT_001184de;
long DAT_0011850a;
long _DAT_003204f0;
long DAT_00119680;
long DAT_00118468;
long PTR_DAT_0031f4a0;
long PTR_FUN_0031f4b0;
long LAB_001075e0;
long DAT_00118717;
long LAB_00107920;
long DAT_00119dc8;
long DAT_00119dc3;
long DAT_00119f10;
long DAT_0011a8d6;
long DAT_0011a8f2;
long DAT_0011a8fa;
long DAT_0011a8f6;
long DAT_0011ab80;
long DAT_0011aa80;
long stack0x00000008;
long DAT_0031f508;
long DAT_0011acd5;
long DAT_0031f518;
long DAT_0031f528;
long PTR_PTR_DAT_0031f530;
long DAT_0011b6e1;
long DAT_0011b6e6;
long DAT_0011b6ed;
long DAT_0011b6f3;
long DAT_0011b6fe;
long DAT_0011b702;
long DAT_0011b707;
long DAT_0011b6e2;
long PTR_DAT_0031f920;
long DAT_0011bc1f;
long _bVar2;
long DAT_0011bc3d;
long DAT_0011bc21;
long DAT_003204f8;
long DAT_0031fa30;
long PTR_s_Code_page_0031fa28;
long DAT_0011bdca;
long DAT_0011bdcf;
long DAT_0011bdda;
long DAT_0011c100;
long DAT_003204c0;
long DAT_0031fb98;
long PTR_s_EncryptedPackage_0031fb70;
long DAT_0011c18a;
long DAT_0031fc18;
long DAT_0031fc58;
long DAT_0031fd40;
long PTR_DAT_0031fc80;
long PTR_DAT_0031fce0;
long PTR_s_mfbu_header_0031fbc0;
long DAT_0031fbe8;
long PTR_s_Encrypted_0031fb60;
long PTR_s_encrypted_0031fb68;


























typedef struct eh_frame_hdr eh_frame_hdr, *Peh_frame_hdr;

struct eh_frame_hdr {
    byte eh_frame_hdr_version; // Exception Handler Frame Header Version
    dwfenc eh_frame_pointer_encoding; // Exception Handler Frame Pointer Encoding
    dwfenc eh_frame_desc_entry_count_encoding; // Encoding of # of Exception Handler FDEs
    dwfenc eh_frame_table_encoding; // Exception Handler Table Encoding
};

typedef struct fde_table_entry fde_table_entry, *Pfde_table_entry;

struct fde_table_entry {
    dword initial_loc; // Initial Location
    dword data_loc; // Data location
};

typedef void _IO_lock_t;

typedef struct _IO_marker _IO_marker, *P_IO_marker;

typedef struct _IO_FILE _IO_FILE, *P_IO_FILE;

typedef long __off_t;

typedef long __off64_t;

typedef ulong size_t;

//struct _IO_FILE {
//    int _flags;
//    char * _IO_read_ptr;
//    char * _IO_read_end;
//    char * _IO_read_base;
//    char * _IO_write_base;
//    char * _IO_write_ptr;
//    char * _IO_write_end;
//    char * _IO_buf_base;
//    char * _IO_buf_end;
//    char * _IO_save_base;
//    char * _IO_backup_base;
//    char * _IO_save_end;
//    struct _IO_marker * _markers;
//    struct _IO_FILE * _chain;
//    int _fileno;
//    int _flags2;
//    __off_t _old_offset;
//    ushort _cur_column;
//    char _vtable_offset;
//    char _shortbuf[1];
//    _IO_lock_t * _lock;
//    __off64_t _offset;
//    void * __pad1;
//    void * __pad2;
//    void * __pad3;
//    void * __pad4;
//    size_t __pad5;
//    int _mode;
//    char _unused2[15];
//};
//
//struct _IO_marker {
//    struct _IO_marker * _next;
//    struct _IO_FILE * _sbuf;
//    int _pos;
//};
//


typedef ulong __dev_t;

typedef ulong __ino_t;

typedef ulong __nlink_t;

typedef uint __mode_t;

typedef uint __uid_t;

typedef uint __gid_t;

typedef long __blksize_t;

typedef long __blkcnt_t;

//typedef struct timespec timespec, *Ptimespec;

typedef long __time_t;

//struct timespec {
//    __time_t tv_sec;
//    long tv_nsec;
//};

struct stat {
    __dev_t st_dev;
    __ino_t st_ino;
    __nlink_t st_nlink;
    __mode_t st_mode;
    __uid_t st_uid;
    __gid_t st_gid;
    int __pad0;
    __dev_t st_rdev;
    __off_t st_size;
    __blksize_t st_blksize;
    __blkcnt_t st_blocks;
    struct timespec st_atim;
    struct timespec st_mtim;
    struct timespec st_ctim;
    long __unused[3];
};

typedef struct timeval timeval, *Ptimeval;

typedef long __suseconds_t;

//struct timeval {
//    __time_t tv_sec;
//    __suseconds_t tv_usec;
//};

typedef struct tm tm, *Ptm;

struct tm {
    int tm_sec;
    int tm_min;
    int tm_hour;
    int tm_mday;
    int tm_mon;
    int tm_year;
    int tm_wday;
    int tm_yday;
    int tm_isdst;
    long tm_gmtoff;
    char * tm_zone;
};

typedef __time_t time_t;

//typedef struct _IO_FILE FILE;

typedef struct __locale_data __locale_data, *P__locale_data;

struct __locale_data {
};

typedef struct __locale_struct __locale_struct, *P__locale_struct;

struct __locale_struct {
    struct __locale_data * __locales[13];
    ushort * __ctype_b;
    int * __ctype_tolower;
    int * __ctype_toupper;
    char * __names[13];
};

typedef struct __locale_struct * __locale_t;

typedef uint wint_t;

typedef long __fd_mask;

//typedef struct fd_set fd_set, *Pfd_set;

struct fd_set {
    __fd_mask __fds_bits[128];
};

typedef long __ssize_t;

typedef __ssize_t ssize_t;

typedef int __pid_t;

typedef int __int32_t;

typedef void (* __sighandler_t)(int);

typedef struct evp_pkey_ctx_st evp_pkey_ctx_st, *Pevp_pkey_ctx_st;

struct evp_pkey_ctx_st {
};

typedef struct evp_pkey_ctx_st EVP_PKEY_CTX;

typedef struct __dirstream __dirstream, *P__dirstream;

struct __dirstream {
};

typedef struct __dirstream DIR;

typedef struct dirent dirent, *Pdirent;

struct dirent {
    __ino_t d_ino;
    __off_t d_off;
    ushort d_reclen;
    uchar d_type;
    char d_name[256];
};

typedef struct re_pattern_buffer re_pattern_buffer, *Pre_pattern_buffer;

typedef ulong reg_syntax_t;

struct re_pattern_buffer {
    uchar * buffer;
    ulong allocated;
    ulong used;
    reg_syntax_t syntax;
    char * fastmap;
    uchar * translate;
    size_t re_nsub;
    uint can_be_null:1;
    uint regs_allocated:2;
    uint fastmap_accurate:1;
    uint no_sub:1;
    uint not_bol:1;
    uint not_eol:1;
    uint newline_anchor:1;
};

typedef struct regmatch_t regmatch_t, *Pregmatch_t;

typedef int regoff_t;

struct regmatch_t {
    regoff_t rm_so;
    regoff_t rm_eo;
};

typedef struct re_pattern_buffer regex_t;

//typedef struct __mbstate_t __mbstate_t, *P__mbstate_t;

typedef union _union_27 _union_27, *P_union_27;

union _union_27 {
    uint __wch;
    char __wchb[4];
};

struct __mbstate_t {
    int __count;
    union _union_27 __value;
};

typedef struct __mbstate_t mbstate_t;

//typedef int (* __compar_fn_t)(void *, void *);

typedef struct Elf64_Shdr Elf64_Shdr, *PElf64_Shdr;

typedef enum Elf_SectionHeaderType {
    SHT_CHECKSUM=1879048184,
    SHT_DYNAMIC=6,
    SHT_DYNSYM=11,
    SHT_FINI_ARRAY=15,
    SHT_GNU_ATTRIBUTES=1879048181,
    SHT_GNU_HASH=1879048182,
    SHT_GNU_LIBLIST=1879048183,
    SHT_GNU_verdef=1879048189,
    SHT_GNU_verneed=1879048190,
    SHT_GNU_versym=1879048191,
    SHT_GROUP=17,
    SHT_HASH=5,
    SHT_INIT_ARRAY=14,
    SHT_NOBITS=8,
    SHT_NOTE=7,
    SHT_NULL=0,
    SHT_PREINIT_ARRAY=16,
    SHT_PROGBITS=1,
    SHT_REL=9,
    SHT_RELA=4,
    SHT_SHLIB=10,
    SHT_STRTAB=3,
    SHT_SUNW_COMDAT=1879048187,
    SHT_SUNW_move=1879048186,
    SHT_SUNW_syminfo=1879048188,
    SHT_SYMTAB=2,
    SHT_SYMTAB_SHNDX=18
} Elf_SectionHeaderType;

struct Elf64_Shdr {
    dword sh_name;
    enum Elf_SectionHeaderType sh_type;
    qword sh_flags;
    qword sh_addr;
    qword sh_offset;
    qword sh_size;
    dword sh_link;
    dword sh_info;
    qword sh_addralign;
    qword sh_entsize;
};

typedef enum Elf64_DynTag {
    DT_AUDIT=1879047932,
    DT_AUXILIARY=2147483645,
    DT_BIND_NOW=24,
    DT_CHECKSUM=1879047672,
    DT_CONFIG=1879047930,
    DT_DEBUG=21,
    DT_DEPAUDIT=1879047931,
    DT_ENCODING=32,
    DT_FEATURE_1=1879047676,
    DT_FILTER=2147483647,
    DT_FINI=13,
    DT_FINI_ARRAY=26,
    DT_FINI_ARRAYSZ=28,
    DT_FLAGS=30,
    DT_FLAGS_1=1879048187,
    DT_GNU_CONFLICT=1879047928,
    DT_GNU_CONFLICTSZ=1879047670,
    DT_GNU_HASH=1879047925,
    DT_GNU_LIBLIST=1879047929,
    DT_GNU_LIBLISTSZ=1879047671,
    DT_GNU_PRELINKED=1879047669,
    DT_HASH=4,
    DT_INIT=12,
    DT_INIT_ARRAY=25,
    DT_INIT_ARRAYSZ=27,
    DT_JMPREL=23,
    DT_MOVEENT=1879047674,
    DT_MOVESZ=1879047675,
    DT_MOVETAB=1879047934,
    DT_NEEDED=1,
    DT_NULL=0,
    DT_PLTGOT=3,
    DT_PLTPAD=1879047933,
    DT_PLTPADSZ=1879047673,
    DT_PLTREL=20,
    DT_PLTRELSZ=2,
    DT_POSFLAG_1=1879047677,
    DT_PREINIT_ARRAYSZ=33,
    DT_REL=17,
    DT_RELA=7,
    DT_RELACOUNT=1879048185,
    DT_RELAENT=9,
    DT_RELASZ=8,
    DT_RELCOUNT=1879048186,
    DT_RELENT=19,
    DT_RELSZ=18,
    DT_RPATH=15,
    DT_RUNPATH=29,
    DT_SONAME=14,
    DT_STRSZ=10,
    DT_STRTAB=5,
    DT_SYMBOLIC=16,
    DT_SYMENT=11,
    DT_SYMINENT=1879047679,
    DT_SYMINFO=1879047935,
    DT_SYMINSZ=1879047678,
    DT_SYMTAB=6,
    DT_TEXTREL=22,
    DT_TLSDESC_GOT=1879047927,
    DT_TLSDESC_PLT=1879047926,
    DT_VERDEF=1879048188,
    DT_VERDEFNUM=1879048189,
    DT_VERNEED=1879048190,
    DT_VERNEEDNUM=1879048191,
    DT_VERSYM=1879048176
} Elf64_DynTag;

typedef enum Elf_ProgramHeaderType {
    PT_DYNAMIC=2,
    PT_GNU_EH_FRAME=1685382480,
    PT_GNU_RELRO=1685382482,
    PT_GNU_STACK=1685382481,
    PT_INTERP=3,
    PT_LOAD=1,
    PT_NOTE=4,
    PT_NULL=0,
    PT_PHDR=6,
    PT_SHLIB=5,
    PT_TLS=7
} Elf_ProgramHeaderType;

typedef struct Elf64_Rela Elf64_Rela, *PElf64_Rela;

struct Elf64_Rela {
    qword r_offset; // location to apply the relocation action
    qword r_info; // the symbol table index and the type of relocation
    qword r_addend; // a constant addend used to compute the relocatable field value
};

typedef struct Elf64_Dyn Elf64_Dyn, *PElf64_Dyn;

struct Elf64_Dyn {
    enum Elf64_DynTag d_tag;
    qword d_val;
};

typedef struct Elf64_Phdr Elf64_Phdr, *PElf64_Phdr;

struct Elf64_Phdr {
    enum Elf_ProgramHeaderType p_type;
    dword p_flags;
    qword p_offset;
    qword p_vaddr;
    qword p_paddr;
    qword p_filesz;
    qword p_memsz;
    qword p_align;
};

typedef struct Elf64_Sym Elf64_Sym, *PElf64_Sym;

struct Elf64_Sym {
    dword st_name;
    byte st_info;
    byte st_other;
    word st_shndx;
    qword st_value;
    qword st_size;
};

typedef struct Elf64_Ehdr Elf64_Ehdr, *PElf64_Ehdr;

struct Elf64_Ehdr {
    byte e_ident_magic_num;
    char e_ident_magic_str[3];
    byte e_ident_class;
    byte e_ident_data;
    byte e_ident_version;
    byte e_ident_pad[9];
    word e_type;
    word e_machine;
    dword e_version;
    qword e_entry;
    qword e_phoff;
    qword e_shoff;
    dword e_flags;
    word e_ehsize;
    word e_phentsize;
    word e_phnum;
    word e_shentsize;
    word e_shnum;
    word e_shstrndx;
};


ulong FUN_00106440(undefined8 param_1,undefined8 param_2,char *param_3);
undefined8 FUN_00107090(long param_1,long param_2,long param_3) ;
undefined8 FUN_00107100(undefined8 param_1,uint **param_2,undefined8 param_3);
char * FUN_00107f60(uint *param_1,char *param_2,int param_3);
ulong FUN_00108100(long param_1,long param_2,undefined8 param_3);
void * FUN_0010a770(long param_1,char *param_2,uint param_3);
ulong FUN_0010e750(long param_1,long param_2,uint param_3,undefined8 param_4,undefined8 param_5, undefined8 param_6,uint param_7,uint param_8,uint param_9,undefined8 param_10, undefined8 param_11,uint *param_12,int *param_13,uint *param_14);
undefined8 FUN_0010f8a0(long param_1,ulong param_2,long param_3,long *param_4) ;
undefined8 FUN_0010fa40(undefined8 param_1,byte *param_2,ulong param_3,void **param_4,ulong *param_5, char **param_6,undefined8 *param_7,undefined8 *param_8);
ulong FUN_00110380(int param_1,void *param_2,size_t param_3,int param_4);
undefined8 * FUN_00111d40(time_t param_1,ulong param_2,undefined8 *param_3);
ulong FUN_00112530(long param_1,char *param_2,stat *param_3) ;
ulong FUN_00112e00(long param_1,undefined8 param_2,undefined8 param_3);
ulong FUN_00113170(long param_1,uint param_2,ulong param_3,undefined8 param_4,ulong param_5);
undefined8 FUN_00113670(long *param_1);
char * FUN_001136d0(long param_1);
undefined8 FUN_00113920(long param_1,uint param_2);
size_t FUN_001139a0(long param_1) ;
ulong FUN_00113b30(long param_1,undefined8 param_2,undefined8 param_3);
undefined8 * FUN_00113c50(long param_1);
undefined8 FUN_00113ca0(long param_1,void **param_2);
byte * FUN_00113cf0(byte *param_1,long param_2,byte *param_3);
ulong FUN_00113ea0(long param_1,ushort *param_2,ulong param_3);
ulong FUN_00112530(long param_1,char *param_2,stat *param_3);
undefined8 FUN_00113f60(long param_1,long param_2) ;
undefined8 FUN_00116ae0(time_t *param_1,long param_2);
ulong FUN_00116f70(long param_1,undefined4 param_2,undefined8 param_3,undefined8 param_4);
char * FUN_00117c00(char *param_1,char *param_2,long param_3) ;
 char * FUN_00117c50(char *param_1,char *param_2,long param_3);
long FUN_00118170(long param_1,long param_2) ;
int FUN_00112ee0(undefined4 param_1,undefined4 param_2,...);
void __stack_chk_fail(void);
void FUN_00106fb0(void **param_1);
void FUN_00107040(void *param_1);
void FUN_00107d70(long *param_1,uint param_2);
void FUN_00107ea0(void);
void FUN_00111c10(undefined4 param_1,const char* param_2,...);
void FUN_00111e30(ushort *param_1);
void FUN_00112ce0(undefined4 param_1,const char* param_2, ...);
void FUN_00112fc0(undefined4 param_1,const char* param_2,...);
void FUN_00113100(undefined8 param_1,undefined8 param_2);
void FUN_00113130(undefined8 param_1);
void FUN_00113150(undefined8 param_1);
void FUN_001139c0(char **param_1,char *param_2,int param_3);
void FUN_00113a60(long param_1,char *param_2,size_t param_3,regmatch_t *param_4,int param_5);
void FUN_00113a80(long param_1);
void FUN_00113ab0(undefined8 *param_1,uint param_2,undefined8 param_3);




//int _init(EVP_PKEY_CTX *ctx)
//
//{
//  int iVar1;
//  
//  iVar1 = __gmon_start__();
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//__int32_t ** __ctype_toupper_loc(void)
//
//{
//  __int32_t **pp_Var1;
//  
//  pp_Var1 = __ctype_toupper_loc();
//  return pp_Var1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//char * getenv(char *__name)
//
//{
//  char *pcVar1;
//  
//  pcVar1 = getenv(__name);
//  return pcVar1;
//}
//


//void snprintf(void)
//
//{
//  snprintf();
//  return;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//void free(void *__ptr)
//
//{
//  free(__ptr);
//  return;
//}
//
//
//
//void __vfprintf_chk(void)
//
//{
//  __vfprintf_chk();
//  return;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//void abort(void)
//
//{
//                    // WARNING: Subroutine does not return
//  abort();
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
int * __errno_location(void)

{
  int *piVar1;
  
  piVar1 = __errno_location();
  return piVar1;
}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int unlink(char *__name)
//
//{
//  int iVar1;
//  
//  iVar1 = unlink(__name);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int strncmp(char *__s1,char *__s2,size_t __n)
//
//{
//  int iVar1;
//  
//  iVar1 = strncmp(__s1,__s2,__n);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//tm * localtime_r(time_t *__timer,tm *__tp)
//
//{
//  tm *ptVar1;
//  
//  ptVar1 = localtime_r(__timer,__tp);
//  return ptVar1;
//}
//
//
//
//void inflate(void)
//
//{
//  inflate();
//  return;
//}
//
//
//
//void __read_chk(void)
//
//{
//  __read_chk();
//  return;
//}
//


// WARNING: Unknown calling convention yet parameter storage is locked

//int puts(char *__s)
//
//{
//  int iVar1;
//  
//  iVar1 = puts(__s);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//void qsort(void *__base,size_t __nmemb,size_t __size,__compar_fn_t __compar)
//
//{
//  qsort(__base,__nmemb,__size,__compar);
//  return;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//double strtod(char *__nptr,char **__endptr)
//
//{
//  double dVar1;
//  
//  dVar1 = strtod(__nptr,__endptr);
//  return dVar1;
//}
//
//

// WARNING: Unknown calling convention yet parameter storage is locked

ssize_t readlink(char *__path,char *__buf,size_t __len)

{
  ssize_t sVar1;
  
  sVar1 = readlink(__path,__buf,__len);
  return sVar1;
}



// WARNING: Unknown calling convention yet parameter storage is locked

int fcntl(int __fd,int __cmd,...)

{
  int iVar1;
  
  iVar1 = fcntl(__fd,__cmd);
  return iVar1;
}



// WARNING: Unknown calling convention yet parameter storage is locked

ssize_t write(int __fd,void *__buf,size_t __n)

{
  ssize_t sVar1;
  
  sVar1 = write(__fd,__buf,__n);
  return sVar1;
}


ssize_t read(int __fd,void *__buf,size_t __nbytes)

{
  ssize_t sVar1;
  
  sVar1 = read(__fd,__buf,__nbytes);
  return sVar1;
}
//void __open_2(void)
//
//{
//  __open_2();
//  return;
//}
int close(int __fd)

{
  int iVar1;
  
  iVar1 = close(__fd);
  return iVar1;
}


// WARNING: Unknown calling convention yet parameter storage is locked

int fclose(FILE *__stream)

{
  int iVar1;
  
  iVar1 = fclose(__stream);
  return iVar1;
}



// WARNING: Unknown calling convention yet parameter storage is locked

DIR * opendir(char *__name)

{
  DIR *pDVar1;
  
  pDVar1 = opendir(__name);
  return pDVar1;
}



// WARNING: Unknown calling convention yet parameter storage is locked

void regfree(regex_t *__preg)

{
  regfree(__preg);
  return;
}



// WARNING: Unknown calling convention yet parameter storage is locked

size_t strlen(char *__s)

{
  size_t sVar1;
  
  sVar1 = strlen(__s);
  return sVar1;
}



// WARNING: Unknown calling convention yet parameter storage is locked

int __lxstat(int __ver,char *__filename,stat *__stat_buf)

{
  int iVar1;
  
  iVar1 = __lxstat(__ver,__filename,__stat_buf);
  return iVar1;
}



// WARNING: Removing unreachable block (ram,0x00106728)
// WARNING: Removing unreachable block (ram,0x0010672d)
// WARNING: Removing unreachable block (ram,0x001069a6)
// WARNING: Removing unreachable block (ram,0x00106748)

undefined8 magic_file(long param_1,char *param_2)

{
  int iVar1;
  uint __fd;
  int iVar2;
  void *__ptr;
  long lVar3;
  undefined8 uVar4;
  uint *puVar5;
  ulong uVar6;
  char *pcVar7;
  size_t __nbytes;
  ulong uVar8;
  uint uVar9;
  int __fd_00;
  undefined8 *puVar10;
  ssize_t sVar11;
  long in_FS_OFFSET;
  bool bVar12;
  byte bVar13;
  uint *puStack256;
  __time_t _Stack248;
  undefined4 uStack240;
  undefined4 uStack236;
  __time_t _Stack232;
  undefined8 uStack224;
  stat sStack216;
  long lStack64;
  
  bVar13 = 0;
  if (param_1 == 0) {
    return 0;
  }
  uVar8 = 0;
  __fd_00 = 0;
  //lStack64 = *(long *)(in_FS_OFFSET + 0x28);
  iVar1 = FUN_00113670(param_1);
  if ((iVar1 != -1) && (__ptr = malloc(*(long *)(param_1 + 0xe0) + 0x61), __ptr != (void *)0x0)) {
    iVar1 = FUN_00112530(param_1,param_2,&sStack216);
    if (iVar1 != -1) {
      if (iVar1 == 0) {
        if (param_2 == (char *)0x0) {
          iVar2 = __fxstat(1,0,&sStack216);
          if ((iVar2 != 0) || ((sStack216.st_mode & 0xf000) != 0x1000)) {
            puStack256 = (uint *)lseek(0,0,1);
            sVar11 = read(0,__ptr,*(size_t *)(param_1 + 0xe0));
            if (sVar11 != -1) goto LAB_00106651;
            puVar5 = (uint *)__errno_location();
            __fd = *puVar5;
            pcVar7 = "/dev/stdin";
LAB_001067db:
            FUN_00112ce0(param_1,(ulong)__fd,"cannot read `%s\'",pcVar7);
LAB_001067ec:
            free(__ptr);
            if (__fd_00 == -1) goto LAB_00106768;
            iVar2 = -1;
LAB_001066a3:
            if (puStack256 != (uint *)0xffffffffffffffff) {
              lseek(__fd_00,(__off_t)puStack256,0);
            }
            goto LAB_001066b7;
          }
          __nbytes = *(size_t *)(param_1 + 0xe0);
LAB_0010660b:
          __fd_00 = (int)uVar8;
          sVar11 = 0;
          while ((lVar3 = FUN_00110380(uVar8,(long)__ptr + sVar11,__nbytes - sVar11, 0), 0 < lVar3 &&
                 (sVar11 = sVar11 + lVar3, 0xfff < lVar3))) {
            __nbytes = *(size_t *)(param_1 + 0xe0);
          }
          if ((sVar11 != 0) || (param_2 == (char *)0x0)) {
            puStack256 = (uint *)0xffffffffffffffff;
LAB_00106651:
            __fd_00 = (int)uVar8;
            puVar10 = (undefined8 *)((long)__ptr + sVar11);
            *puVar10 = 0;
            *(undefined8 *)((long)puVar10 + 0x59) = 0;
            uVar6 = (ulong)(((int)puVar10 -
                            (int)(undefined8 *)((ulong)(puVar10 + 1) & 0xfffffffffffffff8)) + 0x61U
                           >> 3);
            puVar10 = (undefined8 *)((ulong)(puVar10 + 1) & 0xfffffffffffffff8);
            while (uVar6 != 0) {
              uVar6 = uVar6 - 1;
              *puVar10 = 0;
              puVar10 = puVar10 + (ulong)bVar13 * 0x1ffffffffffffffe + 1;
            }
            iVar2 = FUN_00113170(param_1,uVar8,param_2,__ptr,sVar11);
            if (iVar2 != -1) goto LAB_00106696;
            goto LAB_001067ec;
          }
          iVar1 = FUN_00106440(param_1,(ulong)sStack216.st_mode,param_2);
          iVar2 = -(uint)(iVar1 == -1);
          free(__ptr);
          if (__fd_00 != -1) goto LAB_001066b7;
        }
        else {
          __fd = __xstat(1,param_2,&sStack216);
          if (__fd == 0) {
            bVar12 = (sStack216.st_mode & 0xf000) == 0x1000;
            uVar9 = 0x800;
            if (!bVar12) {
              uVar9 = __fd;
            }
            puStack256 = (uint *)__errno_location();
            *puStack256 = 0;
            __fd = __open_2(param_2,(ulong)uVar9);
            uVar8 = (ulong)__fd;
            if (-1 < (int)__fd) {
              __fd = fcntl(__fd,3);
              if (__fd != 0xffffffff) {
LAB_001068aa:
                fcntl((int)uVar8,4,(ulong)(__fd & 0xfffff7ff));
              }
              __nbytes = *(size_t *)(param_1 + 0xe0);
              if (bVar12) goto LAB_0010660b;
              goto LAB_00106947;
            }
            iVar1 = FUN_00106440(param_1,(ulong)sStack216.st_mode,param_2);
            if (iVar1 != -1) goto LAB_00106833;
            free(__ptr);
            if (__fd == 0xffffffff) {
              uVar4 = 0;
              goto LAB_001066e9;
            }
            iVar2 = -1;
            close(__fd);
            if ((*(byte *)(param_1 + 0x38) & 0x80) == 0) goto LAB_00106768;
          }
          else {
            puStack256 = (uint *)__errno_location();
            *puStack256 = 0;
            __fd = __open_2(param_2,0);
            uVar8 = (ulong)__fd;
            if ((int)__fd < 0) {
LAB_00106833:
              free(__ptr);
              if (__fd != 0xffffffff) {
                iVar2 = 0;
                close(__fd);
                if ((*(byte *)(param_1 + 0x38) & 0x80) != 0) goto LAB_00106855;
              }
              goto LAB_001066e1;
            }
            __fd = fcntl(__fd,3);
            if (__fd != 0xffffffff) {
              bVar12 = false;
              goto LAB_001068aa;
            }
            __nbytes = *(size_t *)(param_1 + 0xe0);
LAB_00106947:
            __fd_00 = (int)uVar8;
            sVar11 = read(__fd_00,__ptr,__nbytes);
            if (sVar11 == -1) {
              __fd = *puStack256;
              pcVar7 = param_2;
              puStack256 = (uint *)sVar11;
              goto LAB_001067db;
            }
            puVar10 = (undefined8 *)((long)__ptr + sVar11);
            *puVar10 = 0;
            *(undefined8 *)((long)puVar10 + 0x59) = 0;
            uVar6 = (ulong)(((int)puVar10 -
                            (int)(undefined8 *)((ulong)(puVar10 + 1) & 0xfffffffffffffff8)) + 0x61U
                           >> 3);
            puVar10 = (undefined8 *)((ulong)(puVar10 + 1) & 0xfffffffffffffff8);
            while (uVar6 != 0) {
              uVar6 = uVar6 - 1;
              *puVar10 = 0;
              puVar10 = puVar10 + (ulong)bVar13 * 0x1ffffffffffffffe + 1;
            }
            iVar2 = FUN_00113170(param_1,uVar8,param_2,__ptr, 0);
            if (iVar2 != -1) {
              puStack256 = (uint *)0xffffffffffffffff;
LAB_00106696:
              free(__ptr);
              iVar2 = iVar1;
              if (__fd_00 == -1) goto LAB_001066e1;
              goto LAB_001066a3;
            }
            free(__ptr);
LAB_001066b7:
            if (((__fd_00 == 0) || (param_2 == (char *)0x0)) ||
               (close(__fd_00), (*(byte *)(param_1 + 0x38) & 0x80) == 0)) goto LAB_001066d8;
          }
LAB_00106855:
          _Stack248 = sStack216.st_atim.tv_sec;
          uStack240 = 0;
          uStack236 = 0;
          uStack224 = 0;
          _Stack232 = sStack216.st_mtim.tv_sec;
          utimes(param_2,(timeval *)&_Stack248);
        }
LAB_001066d8:
        if (iVar2 != 0) goto LAB_00106768;
      }
      else {
        free(__ptr);
      }
LAB_001066e1:
      uVar4 = FUN_001136d0(param_1);
      goto LAB_001066e9;
    }
    free(__ptr);
  }
LAB_00106768:
  uVar4 = 0;
LAB_001066e9:
  if (lStack64 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar4;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void __stack_chk_fail(void)

{
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



// WARNING: Unknown calling convention yet parameter storage is locked

void * mmap(void *__addr,size_t __len,int __prot,int __flags,int __fd,__off_t __offset)

{
  void *pvVar1;
  
  pvVar1 = mmap(__addr,__len,__prot,__flags,__fd,__offset);
  return pvVar1;
}



// WARNING: Unknown calling convention yet parameter storage is locked

void freelocale(__locale_t __dataset)

{
  freelocale(__dataset);
  return;
}



// WARNING: Unknown calling convention yet parameter storage is locked

size_t mbrtowc(wchar_t *__pwc,char *__s,size_t __n,mbstate_t *__p)

{
  size_t sVar1;
  
  sVar1 = mbrtowc(__pwc,__s,__n,__p);
  return sVar1;
}



// WARNING: Unknown calling convention yet parameter storage is locked

int dup2(int __fd,int __fd2)

{
  int iVar1;
  
  iVar1 = dup2(__fd,__fd2);
  return iVar1;
}



// WARNING: Unknown calling convention yet parameter storage is locked

char * strchr(char *__s,int __c)

{
  char *pcVar1;
  
  pcVar1 = strchr(__s,__c);
  return pcVar1;
}



void zError(void)

{
  zError();
  return;
}



void __fdelt_chk(void)

{
  __fdelt_chk();
  return;
}



// WARNING: Unknown calling convention yet parameter storage is locked

__locale_t newlocale(int __category_mask,char *__locale,__locale_t __base)

{
  __locale_t p_Var1;
  
  p_Var1 = newlocale(__category_mask,__locale,__base);
  return p_Var1;
}



// WARNING: Unknown calling convention yet parameter storage is locked

char * strrchr(char *__s,int __c)

{
  char *pcVar1;
  
  pcVar1 = strrchr(__s,__c);
  return pcVar1;
}



// WARNING: Unknown calling convention yet parameter storage is locked

tm * gmtime_r(time_t *__timer,tm *__tp)

{
  tm *ptVar1;
  
  ptVar1 = gmtime_r(__timer,__tp);
  return ptVar1;
}



// WARNING: Unknown calling convention yet parameter storage is locked

//__off_t lseek(int __fd,__off_t __offset,int __whence)
//
//{
//  __off_t _Var1;
//  
//  _Var1 = lseek(__fd,__offset,__whence);
//  return _Var1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//void __assert_fail(char *__assertion,char *__file,uint __line,char *__function)
//
//{
//                    // WARNING: Subroutine does not return
//  __assert_fail(__assertion,__file,__line,__function);
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//float strtof(char *__nptr,char **__endptr)
//
//{
//  float fVar1;
//  
//  fVar1 = strtof(__nptr,__endptr);
//  return fVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//void * memset(void *__s,int __c,size_t __n)
//
//{
//  void *pvVar1;
//  
//  pvVar1 = memset(__s,__c,__n);
//  return pvVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int ioctl(int __fd,ulong __request,...)
//
//{
//  int iVar1;
//  
//  iVar1 = ioctl(__fd,__request);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//

//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int pipe(int *__pipedes)
//
//{
//  int iVar1;
//  
//  iVar1 = pipe(__pipedes);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int closedir(DIR *__dirp)
//
//{
//  int iVar1;
//  
//  iVar1 = closedir(__dirp);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int regcomp(regex_t *__preg,char *__pattern,int __cflags)
//
//{
//  int iVar1;
//  
//  iVar1 = regcomp(__preg,__pattern,__cflags);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int fputc(int __c,FILE *__stream)
//
//{
//  int iVar1;
//  
//  iVar1 = fputc(__c,__stream);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//size_t strcspn(char *__s,char *__reject)
//
//{
//  size_t sVar1;
//  
//  sVar1 = strcspn(__s,__reject);
//  return sVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//void * memchr(void *__s,int __c,size_t __n)
//
//{
//  void *pvVar1;
//  
//  pvVar1 = memchr(__s,__c,__n);
//  return pvVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//

//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//char * strndup(char *__string,size_t __n)
//
//{
//  char *pcVar1;
//  
//  pcVar1 = strndup(__string,__n);
//  return pcVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int memcmp(void *__s1,void *__s2,size_t __n)
//
//{
//  int iVar1;
//  
//  iVar1 = memcmp(__s1,__s2,__n);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//ulonglong strtoull(char *__nptr,char **__endptr,int __base)
//
//{
//  ulonglong uVar1;
//  
//  uVar1 = strtoull(__nptr,__endptr,__base);
//  return uVar1;
//}
//
//
//
//void asprintf(void)
//
//{
//  asprintf();
//  return;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int utimes(char *__file,timeval *__tvp)
//
//{
//  int iVar1;
//  
//  iVar1 = utimes(__file,__tvp);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//void * calloc(size_t __nmemb,size_t __size)
//
//{
//  void *pvVar1;
//  
//  pvVar1 = calloc(__nmemb,__size);
//  return pvVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//__ssize_t __getdelim(char **__lineptr,size_t *__n,int __delimiter,FILE *__stream)
//
//{
//  __ssize_t _Var1;
//  
//  _Var1 = __getdelim(__lineptr,__n,__delimiter,__stream);
//  return _Var1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int strcmp(char *__s1,char *__s2)
//
//{
//  int iVar1;
//  
//  iVar1 = strcmp(__s1,__s2);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//__sighandler_t signal(int __sig,__sighandler_t __handler)
//
//{
//  __sighandler_t p_Var1;
//  
//  p_Var1 = signal(__sig,__handler);
//  return p_Var1;
//}
//
//
//
//void __memcpy_chk(void)
//
//{
//  __memcpy_chk();
//  return;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//long strtol(char *__nptr,char **__endptr,int __base)
//
//{
//  long lVar1;
//  
//  lVar1 = strtol(__nptr,__endptr,__base);
//  return lVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//void * memcpy(void *__dest,void *__src,size_t __n)
//
//{
//  void *pvVar1;
//  
//  pvVar1 = memcpy(__dest,__src,__n);
//  return pvVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//size_t regerror(int __errcode,regex_t *__preg,char *__errbuf,size_t __errbuf_size)
//
//{
//  size_t sVar1;
//  
//  sVar1 = regerror(__errcode,__preg,__errbuf,__errbuf_size);
//  return sVar1;
//}
//
//
//
//void inflateEnd(void)
//
//{
//  inflateEnd();
//  return;
//}
//


undefined8 magic_setflags(long param_1,undefined4 param_2)

{
  if (param_1 == 0) {
    return 0xffffffff;
  }
  *(undefined4 *)(param_1 + 0x38) = param_2;
  return 0;
}



// WARNING: Unknown calling convention yet parameter storage is locked
//
//int select(int __nfds,fd_set *__readfds,fd_set *__writefds,fd_set *__exceptfds,timeval *__timeout)
//
//{
//  int iVar1;
//  
//  iVar1 = select(__nfds,__readfds,__writefds,__exceptfds,__timeout);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int __xstat(int __ver,char *__filename,stat *__stat_buf)
//
//{
//  int iVar1;
//  
//  iVar1 = __xstat(__ver,__filename,__stat_buf);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//dirent * readdir(DIR *__dirp)
//
//{
//  dirent *pdVar1;
//  
//  pdVar1 = readdir(__dirp);
//  return pdVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//__locale_t uselocale(__locale_t __dataset)
//
//{
//  __locale_t p_Var1;
//  
//  p_Var1 = uselocale(__dataset);
//  return p_Var1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//void * malloc(size_t __size)
//
//{
//  void *pvVar1;
//  
//  pvVar1 = malloc(__size);
//  return pvVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int fflush(FILE *__stream)
//
//{
//  int iVar1;
//  
//  iVar1 = fflush(__stream);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//char * ctime_r(time_t *__timer,char *__buf)
//
//{
//  char *pcVar1;
//  
//  pcVar1 = ctime_r(__timer,__buf);
//  return pcVar1;
//}
//
//
//
//void vasprintf(void)
//
//{
//  vasprintf();
//  return;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int __fxstat(int __ver,int __fildes,stat *__stat_buf)
//
//{
//  int iVar1;
//  
//  iVar1 = __fxstat(__ver,__fildes,__stat_buf);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int regexec(regex_t *__preg,char *__string,size_t __nmatch,regmatch_t *__pmatch,int __eflags)
//
//{
//  int iVar1;
//  
//  iVar1 = regexec(__preg,__string,__nmatch,__pmatch,__eflags);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//time_t mktime(tm *__tp)
//
//{
//  time_t tVar1;
//  
//  tVar1 = mktime(__tp);
//  return tVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int mkstemp(char *__template)
//
//{
//  int iVar1;
//  
//  iVar1 = mkstemp(__template);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//void * realloc(void *__ptr,size_t __size)
//
//{
//  void *pvVar1;
//  
//  pvVar1 = realloc(__ptr,__size);
//  return pvVar1;
//}
//


char * magic_getpath(char *param_1,int param_2)

{
  int iVar1;
  char *pcVar2;
  long in_FS_OFFSET;
  char *pcStack192;
  stat sStack184;
  long lStack32;
  
  lStack32 = *(long *)(in_FS_OFFSET + 0x28);
  if (((param_1 != (char *)0x0) || (param_1 = getenv("MAGIC"), param_1 != (char *)0x0)) ||
     (param_1 = "/usr/local/share/misc/magic", param_2 != 0)) goto LAB_00106a16;
  if (DAT_003204e8 != (char *)0x0) {
    free(DAT_003204e8);
    DAT_003204e8 = (char *)0x0;
  }
  pcVar2 = getenv("HOME");
  if (pcVar2 != (char *)0x0) {
    iVar1 = asprintf(&pcStack192,1,"%s/.magic.mgc",pcVar2);
    if (-1 < iVar1) {
      iVar1 = __xstat(1,pcStack192,&sStack184);
      if (iVar1 == -1) {
        free(pcStack192);
        iVar1 = asprintf(&pcStack192,1,"%s/.magic",pcVar2);
        if (iVar1 < 0) goto LAB_00106b20;
        iVar1 = __xstat(1,pcStack192,&sStack184);
        if (iVar1 != -1) {
          if ((sStack184.st_mode & 0xf000) == 0x4000) {
            free(pcStack192);
            iVar1 = asprintf(&pcStack192,1,"%s/%s",pcVar2,"/.magic/magic.mgc");
            if (iVar1 < 0) goto LAB_00106b20;
            iVar1 = access(pcStack192,4);
            if (iVar1 == -1) goto LAB_00106b04;
          }
          goto LAB_00106ad6;
        }
      }
      else {
LAB_00106ad6:
        iVar1 = asprintf(&DAT_003204e8,1,"%s:%s",pcStack192,"/usr/local/share/misc/magic");
        if (-1 < iVar1) {
          free(pcStack192);
          param_1 = DAT_003204e8;
          goto LAB_00106a16;
        }
      }
LAB_00106b04:
      DAT_003204e8 = (char *)0x0;
      free(pcStack192);
    }
  }
LAB_00106b20:
  param_1 = "/usr/local/share/misc/magic";
LAB_00106a16:
  if (lStack32 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return param_1;
}



// WARNING: Unknown calling convention yet parameter storage is locked

//int munmap(void *__addr,size_t __len)
//
//{
//  int iVar1;
//  
//  iVar1 = munmap(__addr,__len);
//  return iVar1;
//}
//
//
//
//void __printf_chk(void)
//
//{
//  __printf_chk();
//  return;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//char * asctime_r(tm *__tp,char *__buf)
//
//{
//  char *pcVar1;
//  
//  pcVar1 = asctime_r(__tp,__buf);
//  return pcVar1;
//}
//
//
//
//void inflateInit_(void)
//
//{
//  inflateInit_();
//  return;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//void * memmove(void *__dest,void *__src,size_t __n)
//
//{
//  void *pvVar1;
//  
//  pvVar1 = memmove(__dest,__src,__n);
//  return pvVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int mprotect(void *__addr,size_t __len,int __prot)
//
//{
//  int iVar1;
//  
//  iVar1 = mprotect(__addr,__len,__prot);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
int open(char *__file,int __oflag,...)

{
  int iVar1;
  
  iVar1 = open(__file,__oflag);
  return iVar1;
}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int access(char *__name,int __type)
//
//{
//  int iVar1;
//  
//  iVar1 = access(__name,__type);
//  return iVar1;
//}
//
//
//
//void pread(void)
//
//{
//  pread();
//  return;
//}



// WARNING: Unknown calling convention yet parameter storage is locked

//FILE * fopen(char *__filename,char *__modes)
//
//{
//  FILE *pFVar1;
//  
//  pFVar1 = fopen(__filename,__modes);
//  return pFVar1;
//}
//
//
//
//void inflateInit2_(void)
//
//{
//  inflateInit2_();
//  return;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//char * strcasestr(char *__haystack,char *__needle)
//
//{
//  char *pcVar1;
//  
//  pcVar1 = strcasestr(__haystack,__needle);
//  return pcVar1;
//}
//
//
//
//void __dprintf_chk(void)
//
//{
//  __dprintf_chk();
//  return;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//ulong strtoul(char *__nptr,char **__endptr,int __base)
//
//{
//  ulong uVar1;
//  
//  uVar1 = strtoul(__nptr,__endptr,__base);
//  return uVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int execvp(char *__file,char **__argv)
//
//{
//  int iVar1;
//  
//  iVar1 = execvp(__file,__argv);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//ssize_t pread(int __fd,void *__buf,size_t __nbytes,__off_t __offset)
//
//{
//  ssize_t sVar1;
//  
//  sVar1 = pread(__fd,__buf,__nbytes,__offset);
//  return sVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//void exit(int __status)
//
//{
//                    // WARNING: Subroutine does not return
//  exit(__status);
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//size_t fwrite(void *__ptr,size_t __size,size_t __n,FILE *__s)
//
//{
//  size_t sVar1;
//  
//  sVar1 = fwrite(__ptr,__size,__n,__s);
//  return sVar1;
//}
//
//
//
//void fprintf(void)
//
//{
//  fprintf();
//  return;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//char * strdup(char *__s)
//
//{
//  char *pcVar1;
//  
//  pcVar1 = strdup(__s);
//  return pcVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//char * strerror(int __errnum)
//
//{
//  char *pcVar1;
//  
//  pcVar1 = strerror(__errnum);
//  return pcVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//int iswprint(wint_t __wc)
//
//{
//  int iVar1;
//  
//  iVar1 = iswprint(__wc);
//  return iVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//__pid_t wait(void *__stat_loc)
//
//{
//  __pid_t _Var1;
//  
//  _Var1 = wait(__stat_loc);
//  return _Var1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//__pid_t fork(void)
//
//{
//  __pid_t _Var1;
//  
//  _Var1 = fork();
//  return _Var1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//char * strstr(char *__haystack,char *__needle)
//
//{
//  char *pcVar1;
//  
//  pcVar1 = strstr(__haystack,__needle);
//  return pcVar1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//__int32_t ** __ctype_tolower_loc(void)
//
//{
//  __int32_t **pp_Var1;
//  
//  pp_Var1 = __ctype_tolower_loc();
//  return pp_Var1;
//}
//
//
//
//// WARNING: Unknown calling convention yet parameter storage is locked
//
//ushort ** __ctype_b_loc(void)
//
//{
//  ushort **ppuVar1;
//  
//  ppuVar1 = __ctype_b_loc();
//  return ppuVar1;
//}
//
//
//
//void __cxa_finalize(void)
//
//{
//  __cxa_finalize();
//  return;
//}
//


ulong entry(uint param_1)

{
  long in_FS_OFFSET;
  
  if (*(long *)(in_FS_OFFSET + 0x28) != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return (ulong)((uint)CONCAT11((char)((param_1 << 8) >> 0x18),(char)(param_1 >> 0x18)) |
                 (uint)(((ulong)(param_1 >> 8) & 0xff) << 0x10) | param_1 << 0x18);
}



undefined8
FUN_00103a23(undefined8 param_1,long param_2,int param_3,int param_4,uint param_5,uint param_6,
            long param_7,long param_8,uint *param_9,ulong param_10,int param_11)

{
  byte bVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  char *pcVar6;
  ushort **ppuVar7;
  undefined8 uVar8;
  long lVar9;
  ulong uVar10;
  byte *pbVar11;
  ulong uVar12;
  long lVar13;
  ulong uVar14;
  byte *pbVar15;
  ulong uVar16;
  long in_FS_OFFSET;
  undefined local_248 [520];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if (param_5 == 4) {
    iVar3 = strncmp((char *)(param_7 + param_2),"CORE",4);
    if (iVar3 != 0) goto LAB_00103bbb;
LAB_00103ad5:
    if ((*(byte *)param_9 & 8) == 0) {
      iVar4 = FUN_00112ee0(param_1,", %s-style",&DAT_0011b5c0 + (long)iVar3 * 8);
      if (iVar4 != -1) {
        *param_9 = *param_9 | 8;
        goto LAB_00103b07;
      }
      goto LAB_00103de0;
    }
LAB_00103b07:
    if (iVar3 != 2) goto LAB_00103bbb;
    if (param_3 == 1) {
      uVar8 = FUN_00113cf0(local_248,0x200,param_2 + 0x7c + param_8);
      iVar3 = FUN_00112ee0(param_1,", from \'%.31s\'",uVar8);
      if (iVar3 != -1) {
        uVar16 = (ulong)*(uint *)(param_2 + 8 + param_8);
        if (param_4 != 0) {
          uVar5 = entry(uVar16);
          uVar16 = (ulong)uVar5;
        }
        iVar3 = FUN_00112ee0(param_1," (signal %u)",uVar16);
        goto joined_r0x00103dc6;
      }
      goto LAB_00103de0;
    }
  }
  else {
    if (param_5 == 5) {
      iVar3 = strcmp((char *)(param_7 + param_2),"CORE");
      iVar4 = iVar3;
joined_r0x00103bb5:
      if (iVar4 == 0) goto LAB_00103ad5;
    }
    else {
      if (param_5 == 8) {
        iVar3 = strcmp((char *)(param_7 + param_2),"FreeBSD");
        if (iVar3 == 0) {
          iVar3 = 1;
          goto LAB_00103ad5;
        }
      }
      else {
        if (10 < param_5) {
          iVar3 = 2;
          iVar4 = strncmp((char *)(param_7 + param_2),"NetBSD-CORE",0xb);
          goto joined_r0x00103bb5;
        }
      }
    }
LAB_00103bbb:
    if ((param_3 == 3) && ((*param_9 >> 8 & 1) != 0)) {
      uVar16 = 0;
      do {
        if (param_11 == 1) {
          lVar9 = (&DAT_0011b620)[uVar16];
        }
        else {
          lVar9 = (&DAT_0011b5e0)[uVar16];
        }
        lVar13 = 0;
        while( true ) {
          if ((param_10 <= (ulong)(param_8 + lVar9 + lVar13)) ||
             ((ulong)param_6 <= (ulong)(lVar9 + lVar13))) goto LAB_00103dce;
          bVar1 = *(byte *)(param_2 + param_8 + lVar9 + lVar13);
          uVar12 = uVar16;
          if (bVar1 == 0) break;
          ppuVar7 = __ctype_b_loc();
          if (((*(byte *)((long)*ppuVar7 + (ulong)bVar1 * 2 + 1) & 0x40) == 0) ||
             (pcVar6 = strchr("\'\"`",(uint)bVar1), pcVar6 != (char *)0x0)) goto LAB_00103dce;
          lVar13 = lVar13 + 1;
          if (lVar13 == 0x10) goto LAB_00103cb3;
        }
        if (lVar13 != 0) goto LAB_00103cb3;
LAB_00103dce:
        uVar16 = uVar16 + 1;
      } while (uVar16 != 5);
    }
  }
  uVar8 = 0;
  goto LAB_00103de5;
LAB_00103cb3:
  while (uVar16 = uVar16 + 1, uVar16 < 5) {
    if (param_11 == 1) {
      uVar14 = (&DAT_0011b620)[uVar16];
      uVar10 = (&DAT_0011b620)[uVar12];
    }
    else {
      uVar14 = (&DAT_0011b5e0)[uVar16];
      uVar10 = (&DAT_0011b5e0)[uVar12];
    }
    if (uVar14 < uVar10) {
      uVar14 = uVar14 + param_8;
      uVar2 = 1;
      while (uVar14 < uVar10 + param_8) {
        if (uVar2 != 0) {
          ppuVar7 = __ctype_b_loc();
          uVar2 = (*ppuVar7)[*(byte *)(param_2 + uVar14)] >> 0xe & 1;
        }
        uVar14 = uVar14 + 1;
      }
      if (uVar2 != 0) {
        uVar12 = uVar16;
      }
    }
  }
  if (param_11 == 1) {
    lVar9 = (&DAT_0011b620)[uVar12];
  }
  else {
    lVar9 = (&DAT_0011b5e0)[uVar12];
  }
  pbVar11 = (byte *)(param_2 + lVar9 + param_8);
  pbVar15 = pbVar11;
  while ((bVar1 = *pbVar15, bVar1 != 0 &&
         (ppuVar7 = __ctype_b_loc(), (*(byte *)((long)*ppuVar7 + (ulong)bVar1 * 2 + 1) & 0x40) != 0)
         )) {
    pbVar15 = pbVar15 + 1;
  }
  while ((pbVar11 < pbVar15 &&
         (ppuVar7 = __ctype_b_loc(),
         (*(byte *)((long)*ppuVar7 + (ulong)pbVar15[-1] * 2 + 1) & 0x20) != 0))) {
    pbVar15 = pbVar15 + -1;
  }
  iVar3 = FUN_00112ee0(param_1,", from \'%.*s\'",pbVar15 + -(long)pbVar11,pbVar11);
joined_r0x00103dc6:
  if (iVar3 != -1) {
    *param_9 = *param_9 | 1;
  }
LAB_00103de0:
  uVar8 = 1;
LAB_00103de5:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar8;
}



ulong FUN_00103e0f(ulong param_1)

{
  long in_FS_OFFSET;
  
  if (*(long *)(in_FS_OFFSET + 0x28) != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return (ulong)CONCAT11((char)((param_1 << 8) >> 0x38),(char)(param_1 >> 0x38)) |
         (ulong)((uint)(param_1 >> 0x18) & 0xff0000) | (ulong)((uint)(param_1 >> 8) & 0xff000000) |
         (param_1 >> 0x18 & 0xff) << 0x20 | (ulong)((uint)(param_1 >> 0x10) & 0xff) << 0x28 |
         (param_1 >> 8 & 0xff) << 0x30 | param_1 << 0x38;
}



undefined8
FUN_00103ef8(undefined8 param_1,long param_2,int param_3,int param_4,uint param_5,long param_6,
            uint *param_7,int param_8,uint param_9,long param_10,int param_11,long param_12)

{
  ulong uVar1;
  byte bVar2;
  uint uVar3;
  int iVar4;
  ulong *puVar5;
  undefined *puVar6;
  undefined8 uVar7;
  long lVar8;
  ssize_t sVar9;
  ushort **ppuVar10;
  ulong uVar11;
  ulong uVar12;
  long __offset;
  char *pcVar13;
  byte *__buf;
  long lVar14;
  undefined *puVar15;
  ulong *puVar16;
  ulong uVar17;
  long in_FS_OFFSET;
  byte bVar18;
  ulong local_218;
  long local_1f8;
  int local_1d8;
  uint local_1c0;
  uint local_1bc;
  ulong local_1b8;
  ulong local_1b0;
  undefined local_1a8 [4];
  uint local_1a4;
  uint local_1a0;
  uint local_198;
  undefined local_188 [8];
  ulong local_180;
  ulong local_178;
  ulong local_168;
  byte abStack329 [265];
  long local_40;
  
  bVar18 = 0;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if (param_3 == 6) {
    uVar3 = *param_7;
    if ((uVar3 >> 8 & 1) != 0) {
      *param_7 = uVar3 & 0xffff0000 | (uint)CONCAT11((char)((ulong)uVar3 >> 8),(char)uVar3) | 0x200;
      uVar1 = (ulong)(param_8 != 1) * 8 + 8;
      local_1f8 = 0x33;
      puVar5 = &local_1b8;
      if (param_8 == 1) {
        puVar5 = (ulong *)&local_1c0;
      }
      puVar6 = local_188;
      if (param_8 == 1) {
        puVar6 = local_1a8;
      }
      lVar14 = 0x38;
      local_218 = uVar1;
      if (param_8 == 1) {
        lVar14 = 0x20;
      }
      while (local_218 <= param_5) {
        local_1f8 = local_1f8 + -1;
        uVar12 = uVar1;
        puVar15 = (undefined *)(((param_2 + param_6) - uVar1) + local_218);
        puVar16 = puVar5;
        while (uVar12 != 0) {
          uVar12 = uVar12 - 1;
          *(undefined *)puVar16 = *puVar15;
          puVar15 = puVar15 + (ulong)bVar18 * -2 + 1;
          puVar16 = (ulong *)((long)puVar16 + (ulong)bVar18 * -2 + 1);
        }
        if (local_1f8 == 0) {
          FUN_00112ce0(param_1,0,"Too many ELF Auxv elements");
          uVar7 = 1;
          goto LAB_001044bd;
        }
        if (param_8 == 1) {
          if (param_4 == 0) {
            if (local_1c0 != 0xd) {
              if (local_1c0 < 0xe) {
                if (local_1c0 == 0xb) goto LAB_0010433d;
                pcVar13 = "effective uid";
                if (local_1c0 == 0xc) goto LAB_00104344;
              }
              else {
                if (local_1c0 == 0xf) goto LAB_00104162;
                pcVar13 = "effective gid";
                if (local_1c0 < 0xf) goto LAB_00104344;
                pcVar13 = "execfn";
                if (local_1c0 == 0x1f) goto LAB_00104169;
              }
              goto LAB_00104059;
            }
LAB_0010447d:
            pcVar13 = "real gid";
LAB_00104344:
            uVar12 = (ulong)local_1bc;
            if (param_4 != 0) {
              uVar3 = entry((ulong)local_1bc);
              uVar12 = (ulong)uVar3;
            }
            goto LAB_00104373;
          }
          uVar3 = entry(0);
          if (uVar3 == 0xd) goto LAB_0010447d;
          if (uVar3 < 0xe) {
            if (uVar3 == 0xb) {
LAB_0010433d:
              pcVar13 = "real uid";
            }
            else {
              pcVar13 = "effective uid";
              if (uVar3 != 0xc) goto LAB_00104059;
            }
            goto LAB_00104344;
          }
          if (uVar3 == 0xf) {
LAB_00104162:
            pcVar13 = "platform";
          }
          else {
            pcVar13 = "effective gid";
            if (uVar3 < 0xf) goto LAB_00104344;
            pcVar13 = "execfn";
            if (uVar3 != 0x1f) goto LAB_00104059;
          }
LAB_00104169:
          uVar3 = local_1bc;
          if (param_4 != 0) {
            uVar3 = entry(0);
          }
          uVar12 = (ulong)uVar3;
LAB_001041a1:
          local_1d8 = param_11;
          __offset = param_10;
          while (local_1d8 != 0) {
            lVar8 = pread((ulong)param_9,puVar6,lVar14,__offset,0x38);
            if (lVar8 < lVar14) {
              FUN_00113150(lVar8);
              __offset = -1;
              goto LAB_001042d6;
            }
            __offset = __offset + lVar14;
            if (param_12 == -1) {
              if (param_8 == 1) {
LAB_00104257:
                uVar17 = 4;
                if (local_1a0 != 0) {
                  uVar3 = local_1a0;
                  if (param_4 != 0) {
                    uVar3 = entry(0);
                  }
                  uVar17 = (ulong)uVar3;
                }
                if (uVar17 <= uVar12) {
                  uVar3 = local_198;
                  if (param_4 != 0) {
                    uVar3 = entry(0);
                  }
                  uVar11 = (ulong)uVar3;
                  goto LAB_001042bf;
                }
              }
              else {
LAB_00104278:
                uVar11 = local_168;
                if (local_178 == 0) {
                  if (3 < uVar12) {
                    uVar17 = 4;
                    if (param_4 != 0) goto LAB_001043c2;
                    goto LAB_001042bf;
                  }
                }
                else {
                  if (param_4 == 0) {
                    uVar17 = local_178;
                    if (local_178 <= uVar12) goto LAB_001042bf;
                  }
                  else {
                    uVar17 = FUN_00103e0f(0);
                    if (uVar17 <= uVar12) {
LAB_001043c2:
                      uVar11 = FUN_00103e0f(0);
LAB_001042bf:
                      if (uVar12 < uVar11 + uVar17) {
                        if (param_8 == 1) {
                          uVar3 = local_1a4;
                          if (param_4 != 0) {
                            uVar3 = entry(0);
                          }
                          uVar11 = (ulong)uVar3;
                        }
                        else {
                          uVar11 = local_180;
                          if (param_4 != 0) {
                            uVar11 = FUN_00103e0f(0);
                          }
                        }
                        __offset = (uVar12 - uVar17) + uVar11;
                        goto LAB_001042d6;
                      }
                    }
                  }
                }
              }
            }
            else {
              if (param_8 == 1) {
                uVar3 = local_1a4;
                if (param_4 != 0) {
                  uVar3 = entry(0);
                }
                if ((long)(ulong)uVar3 <= param_12) goto LAB_00104257;
              }
              else {
                uVar11 = local_180;
                if (param_4 != 0) {
                  uVar11 = FUN_00103e0f(0);
                }
                if ((long)uVar11 <= param_12) goto LAB_00104278;
              }
            }
            local_1d8 = local_1d8 + -1;
          }
          __offset = 0;
LAB_001042d6:
          __buf = abStack329 + 1;
          sVar9 = pread(param_9,__buf,0x100,__offset);
          if (0 < sVar9) {
            abStack329[sVar9] = 0;
            while (bVar2 = *__buf, bVar2 != 0) {
              ppuVar10 = __ctype_b_loc();
              if ((*(byte *)((long)*ppuVar10 + (ulong)bVar2 * 2 + 1) & 0x40) == 0)
              goto LAB_00104059;
              __buf = __buf + 1;
            }
            if (__buf == abStack329 + 1) goto LAB_00104059;
            iVar4 = FUN_00112ee0(param_1,", %s: \'%s\'",pcVar13);
            goto joined_r0x00104011;
          }
          FUN_00113150(param_1);
        }
        else {
          if (param_4 == 0) {
            if (local_1b8 == 0xd) {
LAB_00104471:
              pcVar13 = "real gid";
            }
            else {
              if (0xd < local_1b8) {
                if (local_1b8 == 0xf) {
LAB_00104155:
                  pcVar13 = "platform";
                  if (param_8 == 1) goto LAB_00104162;
                }
                else {
                  if (local_1b8 < 0xf) {
                    pcVar13 = "effective gid";
                    goto LAB_00104362;
                  }
                  pcVar13 = "execfn";
                  if (local_1b8 != 0x1f) goto LAB_00104059;
                }
LAB_0010418d:
                uVar12 = local_1b0;
                if (param_4 != 0) {
                  uVar12 = FUN_00103e0f(0);
                }
                goto LAB_001041a1;
              }
              uVar12 = local_1b8;
              if (local_1b8 != 0xb) goto joined_r0x00104416;
LAB_00104330:
              pcVar13 = "real uid";
              if (param_8 == 1) goto LAB_0010433d;
            }
LAB_00104362:
            uVar12 = local_1b0;
            if (param_4 != 0) goto LAB_0010436b;
          }
          else {
            uVar12 = FUN_00103e0f(0);
            if (uVar12 == 0xd) goto LAB_00104471;
            if (uVar12 < 0xe) {
              if (uVar12 == 0xb) goto LAB_00104330;
joined_r0x00104416:
              pcVar13 = "effective uid";
              if (uVar12 != 0xc) goto LAB_00104059;
              goto LAB_00104362;
            }
            if (uVar12 == 0xf) goto LAB_00104155;
            if (0xe < uVar12) {
              pcVar13 = "execfn";
              if (uVar12 == 0x1f) goto LAB_0010418d;
              goto LAB_00104059;
            }
            pcVar13 = "effective gid";
LAB_0010436b:
            uVar12 = FUN_00103e0f(local_1b0);
          }
LAB_00104373:
          iVar4 = FUN_00112ee0(param_1,", %s: %d",pcVar13,uVar12 & 0xffffffff);
joined_r0x00104011:
          if (iVar4 == -1) goto LAB_00104013;
        }
LAB_00104059:
        local_218 = local_218 + uVar1;
      }
      uVar7 = 1;
      goto LAB_001044bd;
    }
  }
LAB_00104013:
  uVar7 = 0;
LAB_001044bd:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar7;
}



ulong FUN_001044e7(undefined8 param_1,long param_2,long param_3,ulong param_4,uint param_5,
                  ulong param_6,ulong param_7,uint *param_8,short *param_9,uint param_10,
                  undefined8 param_11,uint param_12,undefined8 param_13)

{
  byte *pbVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  int iVar5;
  uint uVar6;
  undefined8 *puVar7;
  ulong uVar8;
  char *pcVar9;
  undefined1 *puVar10;
  ulong uVar11;
  ulong uVar12;
  long lVar13;
  ulong uVar14;
  long in_FS_OFFSET;
  bool bVar15;
  ulong local_a0;
  uint local_90;
  uint local_70;
  uint uStack108;
  uint local_68;
  uint local_64;
  uint local_60;
  uint local_5c;
  byte local_58 [24];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_a0 = 0;
  if (*param_9 == 0) goto LAB_00105100;
  *param_9 = *param_9 + -1;
  uVar12 = param_3 + 0xc;
  local_a0 = uVar12;
  if (param_4 < uVar12) goto LAB_00105100;
  param_6 = param_6 & 0xffffffff;
  puVar7 = (undefined8 *)&local_64;
  if (param_5 == 1) {
    puVar7 = (undefined8 *)&local_70;
  }
  uVar4 = *(undefined4 *)((undefined8 *)(param_3 + param_2) + 1);
  *puVar7 = *(undefined8 *)(param_3 + param_2);
  *(undefined4 *)(puVar7 + 1) = uVar4;
  iVar5 = (int)param_6;
  if (param_5 == 1) {
    local_90 = local_70;
    local_60 = uStack108;
    if (iVar5 != 0) {
      local_90 = entry((ulong)local_70);
LAB_001045cd:
      local_60 = entry((ulong)uStack108);
    }
  }
  else {
    local_90 = local_64;
    if (iVar5 != 0) {
      local_90 = entry((ulong)local_64);
      uStack108 = local_60;
      goto LAB_001045cd;
    }
  }
  local_a0 = param_4;
  if ((local_90 | local_60) == 0) goto LAB_00105100;
  if ((int)local_90 < 0) {
    FUN_00112ee0(param_1,", bad note name size 0x%lx",(ulong)local_90);
    local_a0 = 0;
    goto LAB_00105100;
  }
  if ((int)local_60 < 0) {
    FUN_00112ee0(param_1,", bad note description size 0x%lx",(ulong)local_60);
    local_a0 = 0;
    goto LAB_00105100;
  }
  uVar8 = ((local_90 + uVar12 + (param_7 - 1)) / param_7) * param_7;
  local_a0 = uVar8;
  if (param_4 < local_90 + uVar12) goto LAB_00105100;
  param_7 = ((uVar8 + local_60 + (param_7 - 1)) / param_7) * param_7;
  local_a0 = param_7;
  if (param_4 < uVar8 + local_60) {
    local_a0 = param_4;
    if (param_4 <= param_7) {
      local_a0 = param_7;
    }
    goto LAB_00105100;
  }
  uVar6 = *param_8;
  if ((uVar6 & 2) == 0) {
    uVar2 = local_5c;
    if (param_5 == 1) {
      uVar2 = local_68;
    }
    if (iVar5 != 0) {
      uVar2 = entry((ulong)uVar2);
    }
    if (local_90 == 5) {
      iVar3 = strcmp((char *)(param_2 + uVar12),"SuSE");
      if (((iVar3 == 0) && (uVar2 == 1)) && (local_60 == 2)) {
        *param_8 = uVar6 | 2;
        FUN_00112ee0(param_1,", for SuSE %d.%d",(ulong)*(byte *)(param_2 + uVar8),
                     (ulong)*(byte *)(param_2 + 1 + uVar8));
        goto LAB_00105100;
      }
    }
    else {
      if (local_90 == 4) {
        iVar3 = strcmp((char *)(param_2 + uVar12),"GNU");
        if (((iVar3 == 0) && (uVar2 == 1)) && (local_60 == 0x10)) {
          uVar12 = *(ulong *)(param_2 + uVar8);
          uVar8 = *(ulong *)(param_2 + 8 + uVar8);
          *param_8 = uVar6 | 2;
          iVar3 = FUN_00112ee0(param_1,", for GNU/");
          if (iVar3 != -1) {
            uVar4 = (undefined4)uVar12;
            if (iVar5 != 0) {
              uVar4 = entry(uVar12 & 0xffffffff);
            }
            pcVar9 = "<unknown>";
            switch(uVar4) {
            case 0:
              pcVar9 = "Linux";
              break;
            case 1:
              pcVar9 = "Hurd";
              break;
            case 2:
              pcVar9 = "Solaris";
              break;
            case 3:
              pcVar9 = "kFreeBSD";
              break;
            case 4:
              pcVar9 = "kNetBSD";
            }
            iVar3 = FUN_00112ee0(param_1,pcVar9);
            if (iVar3 != -1) {
              uVar11 = uVar8 >> 0x20;
              if (iVar5 != 0) {
                uVar6 = entry(uVar11);
                uVar11 = (ulong)uVar6;
              }
              uVar14 = uVar8 & 0xffffffff;
              if (iVar5 != 0) {
                uVar6 = entry(uVar8 & 0xffffffff);
                uVar14 = (ulong)uVar6;
              }
              uVar6 = (uint)(uVar12 >> 0x20);
              if (iVar5 != 0) {
                uVar6 = entry(uVar12 >> 0x20);
              }
              FUN_00112ee0(param_1," %d.%d.%d",(ulong)uVar6,uVar14,uVar11);
            }
          }
          goto LAB_00105100;
        }
      }
      else {
        if (local_90 == 7) {
          iVar3 = strcmp((char *)(param_2 + uVar12),"NetBSD");
          if (((iVar3 == 0) && (uVar2 == 1)) && (local_60 == 4)) {
            *param_8 = uVar6 | 2;
            uVar6 = *(uint *)(param_2 + uVar8);
            if (iVar5 != 0) {
              uVar6 = entry((ulong)uVar6);
            }
            iVar5 = FUN_00112ee0(param_1,", for NetBSD");
            if (((iVar5 != -1) && (100000000 < uVar6)) &&
               (iVar5 = FUN_00112ee0(param_1,&DAT_0011b165,(ulong)(uVar6 / 100000000)), iVar5 != -1)
               ) {
              uVar12 = ((ulong)uVar6 / 100) % 100;
              uVar8 = ((ulong)uVar6 / 10000) % 100;
              if (((int)uVar8 == 0) && ((int)uVar12 != 0)) {
                FUN_00112ee0(param_1,&DAT_0011b168,uVar12);
              }
              else {
                if ((int)uVar8 != 0) {
                  while (uVar6 = (uint)uVar8, 0x1a < uVar6) {
                    iVar5 = FUN_00112ee0(param_1,&DAT_0011b16c);
                    if (iVar5 == -1) goto LAB_00105100;
                    uVar8 = (ulong)(uVar6 - 0x1a);
                  }
                  FUN_00112ee0(param_1,&DAT_0011b6ff,(ulong)(uVar6 + 0x40));
                }
              }
            }
            goto LAB_00105100;
          }
        }
        else {
          if (local_90 == 8) {
            iVar3 = strcmp((char *)(param_2 + uVar12),"FreeBSD");
            if (((iVar3 == 0) && (uVar2 == 1)) && (local_60 == 4)) {
              *param_8 = uVar6 | 2;
              uVar6 = *(uint *)(param_2 + uVar8);
              if (iVar5 != 0) {
                uVar6 = entry((ulong)uVar6);
              }
              iVar5 = FUN_00112ee0(param_1,", for FreeBSD");
              if (iVar5 == -1) goto LAB_00105100;
              if (uVar6 == 0x704e2) {
                FUN_00112ee0(param_1," 4.6.2");
                goto LAB_00105100;
              }
              if (uVar6 < 0x70544) {
                iVar5 = FUN_00112ee0(param_1,0x11c341,(ulong)(uVar6 / 100000),
                                     ((ulong)uVar6 / 10000) % 10);
                if (((iVar5 == -1) ||
                    (((int)(((ulong)uVar6 / 1000) % 10) != 0 &&
                     (iVar5 = FUN_00112ee0(param_1,0x11c344), iVar5 == -1)))) ||
                   ((uVar6 % 1000 == 0 && (uVar6 % 100000 != 0)))) goto LAB_00105100;
              }
              else {
                if (uVar6 < 500000) {
                  iVar5 = FUN_00112ee0(param_1,0x11c341,4,
                                       (ulong)((int)(((ulong)uVar6 / 10000) % 10) +
                                              (uVar6 / 1000) % 10));
                  if (iVar5 == -1) goto LAB_00105100;
                  if ((int)(((ulong)uVar6 / 100) % 10) == 0) {
                    iVar5 = (int)(((ulong)uVar6 / 10) % 10);
joined_r0x00104bfd:
                    if (iVar5 != 0) {
                      FUN_00112ee0(param_1,0x11c344);
                    }
                    goto LAB_00105100;
                  }
                }
                else {
                  iVar5 = FUN_00112ee0(param_1,0x11c341,(ulong)(uVar6 / 100000),
                                       (ulong)(uVar6 / 1000) % 100);
                  if (iVar5 == -1) goto LAB_00105100;
                  if (((int)(((ulong)uVar6 / 100) % 10) == 0) && (99 < uVar6 % 100000)) {
                    iVar5 = (int)(((ulong)uVar6 / 10) % 10);
                    goto joined_r0x00104bfd;
                  }
                }
              }
              FUN_00112ee0(param_1," (%d)",(ulong)uVar6);
              goto LAB_00105100;
            }
            iVar3 = strcmp((char *)(param_2 + uVar12),"OpenBSD");
            if (((iVar3 == 0) && (uVar2 == 1)) && (local_60 == 4)) {
              *param_8 = uVar6 | 2;
              FUN_00112ee0(param_1,", for OpenBSD");
              goto LAB_00105100;
            }
          }
          else {
            if ((((local_90 == 10) &&
                 (iVar3 = strcmp((char *)(param_2 + uVar12),"DragonFly"), iVar3 == 0)) &&
                (uVar2 == 1)) && (local_60 == 4)) {
              *param_8 = uVar6 | 2;
              iVar3 = FUN_00112ee0(param_1,", for DragonFly");
              if (iVar3 != -1) {
                uVar12 = (ulong)*(uint *)(param_2 + uVar8);
                if (iVar5 != 0) {
                  uVar6 = entry(uVar12);
                  uVar12 = (ulong)uVar6;
                }
                FUN_00112ee0(param_1," %d.%d.%d",uVar12 / 100000,(uVar12 / 10000) % 10,
                             uVar12 % 10000);
              }
              goto LAB_00105100;
            }
          }
        }
      }
    }
  }
  if ((uVar6 & 4) == 0) {
    uVar2 = local_5c;
    if (param_5 == 1) {
      uVar2 = local_68;
    }
    if (iVar5 != 0) {
      uVar2 = entry((ulong)uVar2);
    }
    if (((local_90 == 4) && (iVar3 = strcmp((char *)(param_2 + uVar12),"GNU"), iVar3 == 0)) &&
       (uVar2 == 3)) {
      pcVar9 = "md5/uuid";
      *param_8 = uVar6 | 4;
      if (((local_60 != 0x10) && (pcVar9 = "sha1", local_60 != 0x14)) &&
         (pcVar9 = "xxHash", local_60 != 8)) {
        pcVar9 = "unknown";
      }
      iVar5 = FUN_00112ee0(param_1,", BuildID[%s]=",pcVar9);
      if (iVar5 != -1) {
        lVar13 = 0;
        memcpy(local_58,uVar8 + param_2,(ulong)local_60);
        do {
          if (local_60 <= (uint)lVar13) break;
          pbVar1 = local_58 + lVar13;
          lVar13 = lVar13 + 1;
          iVar5 = FUN_00112ee0(param_1,&DAT_0011b1b6,(ulong)*pbVar1);
        } while (iVar5 != -1);
      }
      goto LAB_00105100;
    }
  }
  if ((uVar6 & 0x10) == 0) {
    uVar2 = local_5c;
    if (param_5 == 1) {
      uVar2 = local_68;
    }
    if (iVar5 != 0) {
      uVar2 = entry((ulong)uVar2);
    }
    if (((local_90 == 4) && (iVar3 = strcmp((char *)(param_2 + uVar12),"PaX"), iVar3 == 0)) &&
       ((uVar2 == 3 && (local_60 == 4)))) {
      *param_8 = uVar6 | 0x10;
      uVar6 = *(uint *)(param_2 + uVar8);
      if (iVar5 != 0) {
        uVar6 = entry((ulong)uVar6);
      }
      if ((uVar6 == 0) || (iVar5 = FUN_00112ee0(param_1,", PaX: "), iVar5 != -1)) {
        lVar13 = 0;
        do {
          if ((1 << ((byte)lVar13 & 0x1f) & uVar6) != 0) {
            bVar15 = iVar3 == 0;
            iVar3 = iVar3 + 1;
            puVar10 = &DAT_0011b6eb;
            if (bVar15) {
              puVar10 = &DAT_0011ad97;
            }
            iVar5 = FUN_00112ee0(param_1,&DAT_0011b6ee,puVar10);
            if (iVar5 == -1) break;
          }
          lVar13 = lVar13 + 1;
        } while (lVar13 != 6);
      }
      goto LAB_00105100;
    }
  }
  if ((uVar6 & 1) == 0) {
    uVar6 = local_5c;
    if (param_5 == 1) {
      uVar6 = local_68;
    }
    if (iVar5 != 0) {
      uVar6 = entry((ulong)uVar6);
    }
    iVar3 = FUN_00103a23(param_1,param_2,(ulong)uVar6,param_6,(ulong)local_90,(ulong)local_60,uVar12
                         ,uVar8,param_8,param_4,(ulong)param_5);
    if (iVar3 != 0) goto LAB_00105100;
  }
  if ((*param_8 >> 9 & 1) == 0) {
    uVar6 = local_5c;
    if (param_5 == 1) {
      uVar6 = local_68;
    }
    if (iVar5 != 0) {
      uVar6 = entry((ulong)uVar6);
    }
    iVar3 = FUN_00103ef8(param_1,param_2,(ulong)uVar6,param_6,(ulong)local_60,uVar8,param_8,
                         (ulong)param_5,(ulong)param_10,param_11,(ulong)param_12,param_13);
    if (iVar3 != 0) goto LAB_00105100;
  }
  if ((local_90 == 7) && (iVar3 = strcmp((char *)(uVar12 + param_2),"NetBSD"), iVar3 == 0)) {
    if (100 < local_60) {
      local_60 = 100;
    }
    if (param_5 == 1) {
      local_5c = local_68;
    }
    if (iVar5 != 0) {
      local_5c = entry((ulong)local_5c);
    }
    if (local_5c == 5) {
      if ((*param_8 & 0x20) == 0) {
        *param_8 = *param_8 | 0x20;
        FUN_00112ee0(param_1,", compiled for: %.*s",(ulong)local_60,uVar8 + param_2);
      }
    }
    else {
      if (local_5c == 6) {
        if ((*param_8 & 0x40) == 0) {
          *param_8 = *param_8 | 0x40;
          FUN_00112ee0(param_1,", compiler model: %.*s",(ulong)local_60,uVar8 + param_2);
        }
      }
      else {
        if ((local_5c != 1) && ((*param_8 & 0x80) == 0)) {
          *param_8 = *param_8 | 0x80;
          FUN_00112ee0(param_1,", note=%u",(ulong)local_5c);
        }
      }
    }
  }
LAB_00105100:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return local_a0;
}



ulong FUN_0010512c(undefined8 param_1,uint param_2,uint param_3,ulong param_4,long param_5,
                  uint param_6,long param_7,long param_8,undefined8 param_9,undefined8 param_10)

{
  uint uVar1;
  int iVar2;
  long lVar3;
  long lVar4;
  ulong uVar5;
  ulong uVar6;
  int *piVar7;
  ulong uVar8;
  long lVar9;
  long lVar10;
  long in_FS_OFFSET;
  undefined8 uVar11;
  int local_20a8;
  uint local_20a4;
  uint local_2098;
  int local_2088 [2];
  ulong local_2080;
  ulong local_2068;
  undefined local_2048 [8200];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  lVar3 = 0x38;
  lVar9 = 0x20;
  if (param_2 != 1) {
    lVar9 = 0x38;
  }
  if (lVar9 == param_7) {
    param_4 = param_4 & 0xffffffff;
    if (param_2 == 1) {
      lVar3 = 0x20;
    }
    uVar8 = (ulong)param_6;
    lVar10 = param_5;
    piVar7 = local_2088;
    if (param_2 == 1) {
      piVar7 = &local_20a8;
    }
    while ((int)uVar8 != 0) {
      lVar4 = pread(param_4,piVar7,lVar9,lVar10,0x38);
      if (lVar4 < lVar3) {
LAB_00105259:
        uVar8 = 0xffffffff;
        FUN_00113150(param_1);
        break;
      }
      if (param_8 == -1) {
        if (param_2 == 1) {
LAB_0010528e:
          if (param_3 == 0) {
            uVar1 = local_2098;
            if (local_20a8 == 4) goto LAB_001052ca;
          }
          else {
            iVar2 = entry(0);
            if (iVar2 == 4) {
              uVar1 = entry(0);
LAB_001052ca:
              uVar5 = (ulong)uVar1;
              if (0x1fff < uVar1) {
LAB_001052fb:
                uVar5 = 0x2000;
              }
              uVar1 = local_20a4;
              if (param_3 != 0) {
                uVar1 = entry(0);
              }
              uVar6 = (ulong)uVar1;
LAB_0010534d:
              uVar11 = 0x105363;
              uVar5 = pread(param_4,local_2048,uVar5,uVar6,0x2000);
              if (uVar5 == 0xffffffffffffffff) goto LAB_00105259;
              uVar6 = 0;
              do {
                if (uVar5 <= uVar6) break;
                uVar6 = FUN_001044e7(param_1,local_2048,uVar6,uVar5,(ulong)param_2,(ulong)param_3,4,
                                     param_9,param_10,param_4,param_5,(ulong)param_6,param_8)
                ;
              } while (uVar6 != 0);
            }
          }
        }
        else {
LAB_001052ac:
          if (param_3 == 0) {
            if (local_2088[0] == 4) {
              uVar5 = local_2068;
              if (0x1fff < local_2068) goto LAB_001052f0;
              goto LAB_00105338;
            }
          }
          else {
            iVar2 = entry(0);
            uVar5 = local_2068;
            if (iVar2 == 4) {
              uVar6 = FUN_00103e0f(0);
              if (uVar6 < 0x2000) {
                uVar5 = FUN_00103e0f(uVar5);
              }
              else {
LAB_001052f0:
                uVar5 = 0x2000;
                if (param_2 == 1) goto LAB_001052fb;
              }
LAB_00105338:
              uVar6 = local_2080;
              if (param_3 != 0) {
                uVar6 = FUN_00103e0f(0);
              }
              goto LAB_0010534d;
            }
          }
        }
      }
      else {
        if (param_2 == 1) {
          uVar1 = local_20a4;
          if (param_3 != 0) {
            uVar1 = entry(0);
          }
          if ((long)(ulong)uVar1 <= param_8) goto LAB_0010528e;
        }
        else {
          uVar5 = local_2080;
          if (param_3 != 0) {
            uVar5 = FUN_00103e0f(0);
          }
          if ((long)uVar5 <= param_8) goto LAB_001052ac;
        }
      }
      uVar8 = (ulong)((int)uVar8 - 1);
      lVar10 = lVar10 + param_7;
    }
  }
  else {
    iVar2 = FUN_00112ee0(param_1,", corrupted program header size");
    uVar8 = (ulong)-(uint)(iVar2 == -1);
  }
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar8;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



ulong FUN_001053f0(undefined8 param_1,uint param_2,uint param_3,uint param_4,long param_5,
                  uint param_6,long param_7,long param_8,int param_9,undefined8 param_10,
                  undefined8 param_11)

{
  char *pcVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  long lVar5;
  int *piVar6;
  long lVar7;
  undefined8 uVar8;
  ulong uVar9;
  ulong uVar10;
  ulong uVar11;
  ulong uVar12;
  char *pcVar13;
  long in_FS_OFFSET;
  char *local_40e8;
  long local_40e0;
  uint local_40cc;
  int local_40a8;
  uint local_40a4;
  uint local_4098;
  uint local_408c;
  int local_4088 [2];
  ulong local_4080;
  ulong local_4068;
  ulong local_4058;
  char acStack16457 [8193];
  undefined local_2048 [8200];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  lVar5 = 0x20;
  if (param_2 != 1) {
    lVar5 = 0x38;
  }
  if (lVar5 == param_7) {
    pcVar13 = "statically";
    piVar6 = local_4088;
    if (param_2 == 1) {
      piVar6 = &local_40a8;
    }
    local_40e8 = "";
    pcVar1 = acStack16457 + 1;
    local_40e0 = param_5;
    local_40cc = param_6;
    while (local_40cc != 0) {
      uVar8 = 0x1054e0;
      lVar7 = pread((ulong)param_4,piVar6,lVar5,local_40e0,0x38);
      if (param_2 == 1) {
        if (lVar7 < 0x20) goto LAB_001055b0;
        if (param_3 == 0) {
          if (local_40a8 == 3) {
LAB_001058b0:
            uVar12 = 4;
LAB_00105689:
            uVar3 = local_40a4;
            if (param_3 == 0) {
              uVar4 = local_4098;
              if (local_4098 < 0x2000) goto LAB_001056db;
              uVar11 = 0x2000;
            }
            else {
              uVar4 = entry(0);
              if (uVar4 < 0x2000) {
LAB_001056db:
                uVar11 = (ulong)uVar4;
                if (param_3 == 0) goto LAB_001056f3;
              }
              else {
                uVar11 = 0x2000;
              }
              uVar3 = entry(0);
            }
LAB_001056f3:
            uVar10 = (ulong)uVar3;
            goto LAB_0010570e;
          }
          iVar2 = local_40a8;
          if (local_40a8 == 4) goto LAB_00105524;
joined_r0x001057c7:
          if (iVar2 != 2) goto LAB_0010573c;
          pcVar13 = "dynamically";
          uVar12 = 4;
          uVar10 = 0;
          iVar2 = local_40a8;
          goto joined_r0x0010580f;
        }
        uVar8 = 0x105512;
        iVar2 = entry(0);
        if (iVar2 == 3) goto LAB_001058b0;
        if (iVar2 != 4) goto joined_r0x001057c7;
LAB_00105524:
        if (param_9 == 0) {
          if (param_2 == 1) {
            uVar12 = 4;
            if (local_408c != 0) {
              uVar3 = local_408c;
              if (param_3 != 0) {
                uVar3 = entry(0);
              }
              uVar12 = (ulong)uVar3;
            }
          }
          else {
            if (local_4058 == 0) {
              uVar12 = 4;
            }
            else {
              uVar12 = local_4058;
              if (param_3 != 0) {
                uVar12 = FUN_00103e0f(0);
              }
            }
          }
          if ((-1 < (int)uVar12) && (3 < uVar12)) goto LAB_00105683;
          iVar2 = FUN_00112ee0(param_1,", invalid note alignment 0x%lx",uVar12);
          if (iVar2 != -1) goto LAB_0010567d;
          goto LAB_0010555b;
        }
      }
      else {
        if (lVar7 < 0x38) {
LAB_001055b0:
          local_40cc = 0xffffffff;
          FUN_00113150(param_1);
          goto LAB_001058e3;
        }
        if (param_3 == 0) {
          if (local_4088[0] == 3) goto LAB_0010567d;
          if (local_4088[0] == 4) goto LAB_00105524;
          if (local_4088[0] == 2) goto LAB_001057f9;
LAB_0010573c:
          if (param_8 != -1) {
            if (param_2 == 1) {
              uVar3 = local_40a4;
              if (param_3 != 0) {
                uVar8 = 0x10575c;
                uVar3 = entry(0);
              }
              if ((long)(ulong)uVar3 <= param_8) {
                uVar12 = 4;
                uVar10 = 0;
                iVar2 = local_40a8;
                goto joined_r0x0010580f;
              }
            }
            else {
              uVar12 = local_4080;
              if (param_3 != 0) {
                uVar8 = 0x105788;
                uVar12 = FUN_00103e0f(0);
              }
              if ((long)uVar12 <= param_8) {
                uVar12 = 4;
                uVar10 = 0;
                goto LAB_00105809;
              }
            }
            goto LAB_00105532;
          }
          uVar12 = 4;
          uVar10 = 0;
LAB_001057aa:
          iVar2 = local_40a8;
          if (param_2 == 1) goto joined_r0x0010580f;
        }
        else {
          uVar8 = 0x1055e0;
          iVar2 = entry(0);
          if (iVar2 == 3) {
LAB_0010567d:
            uVar12 = 4;
LAB_00105683:
            uVar11 = local_4068;
            uVar10 = local_4080;
            if (param_2 == 1) goto LAB_00105689;
            if (param_3 == 0) {
              if (0x1fff < local_4068) goto LAB_001056f7;
LAB_001056fc:
              if (param_3 == 0) goto LAB_0010570e;
            }
            else {
              uVar9 = FUN_00103e0f(0);
              if (0x1fff < uVar9) {
LAB_001056f7:
                uVar11 = 0x2000;
                goto LAB_001056fc;
              }
              uVar11 = FUN_00103e0f(uVar11);
            }
            uVar10 = FUN_00103e0f(0);
LAB_0010570e:
            uVar8 = 0x105725;
            uVar10 = pread((ulong)param_4,pcVar1,uVar11,uVar10,0x2000);
            if (uVar10 == 0xffffffffffffffff) goto LAB_001055b0;
            goto LAB_001057aa;
          }
          if (iVar2 == 4) goto LAB_00105524;
          if (iVar2 != 2) goto LAB_0010573c;
LAB_001057f9:
          pcVar13 = "dynamically";
          uVar12 = 4;
          uVar10 = 0;
        }
LAB_00105809:
        iVar2 = local_4088[0];
joined_r0x0010580f:
        if (param_3 != 0) {
          uVar8 = 0x105818;
          iVar2 = entry(0);
        }
        if (iVar2 == 3) {
          local_40e8 = "*empty*";
          if ((uVar10 != 0) && (acStack16457[1] != '\0')) {
            acStack16457[uVar10] = '\0';
            local_40e8 = pcVar1;
          }
        }
        else {
          if (iVar2 == 4) {
            uVar11 = 0;
            do {
              if (uVar10 <= uVar11) break;
              uVar11 = FUN_001044e7(param_1,pcVar1,uVar11,uVar10,(ulong)param_2,(ulong)param_3,
                                    uVar12,param_10,param_11,(ulong)param_4,0,0,0);
            } while (uVar11 != 0);
          }
        }
      }
LAB_00105532:
      local_40e0 = local_40e0 + param_7;
      local_40cc = local_40cc - 1;
    }
    iVar2 = FUN_00112ee0(param_1,", %s linked",pcVar13);
    if (iVar2 == -1) {
LAB_0010555b:
      local_40cc = 0xffffffff;
    }
    else {
      if (*local_40e8 != '\0') {
        uVar8 = FUN_00113cf0(local_2048,0x2000,local_40e8);
        iVar2 = FUN_00112ee0(param_1,", interpreter %s",uVar8);
        local_40cc = -(uint)(iVar2 == -1);
      }
    }
  }
  else {
    iVar2 = FUN_00112ee0(param_1,", corrupted program header size");
    local_40cc = -(uint)(iVar2 == -1);
  }
LAB_001058e3:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return (ulong)local_40cc;
}



ulong FUN_0010590f(undefined8 param_1,uint param_2,ulong param_3,uint param_4,long param_5,
                  ulong param_6,long param_7,ulong param_8,int param_9,int param_10,
                  undefined8 param_11,undefined8 param_12)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  ulong uVar7;
  ulong *puVar8;
  ssize_t sVar9;
  long lVar10;
  void *__buf;
  uint *puVar11;
  ulong __size;
  ulong __offset;
  __off_t _Var12;
  ulong uVar13;
  long lVar14;
  undefined1 *puVar15;
  char *pcVar16;
  ulong *puVar17;
  int iVar18;
  long in_FS_OFFSET;
  byte bVar19;
  undefined8 uVar20;
  ulong local_1a0;
  ulong local_190;
  ulong local_188;
  long local_178;
  uint *local_170;
  undefined8 local_160;
  ulong local_158;
  long local_150;
  uint local_110;
  uint local_10c;
  ulong local_108;
  ulong local_100;
  uint local_f8;
  int local_f4;
  uint local_e8;
  uint local_e4;
  uint local_c8;
  int local_c4;
  ulong local_b0;
  ulong local_a8;
  char local_88 [16];
  char local_78 [56];
  long local_40;
  
  bVar19 = 0;
  param_6 = param_6 & 0xffffffff;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if (param_2 == 1) {
    if (param_7 != 0x28) goto LAB_00105981;
    local_170 = &local_f8;
    local_160 = 0x28;
    lVar14 = (long)param_10 * 0x28;
LAB_001059b6:
    lVar14 = pread((ulong)param_4,local_170,local_160,lVar14 + param_5,0x40);
    iVar2 = (int)(param_3 & 0xffffffff);
    if (param_2 == 1) {
      if (0x27 < lVar14) {
        uVar3 = local_e8;
        if (iVar2 != 0) {
          uVar3 = entry(0);
        }
        local_158 = (ulong)uVar3;
        local_150 = 0x28;
LAB_00105a04:
        local_190 = 0;
        local_1a0 = 0;
        iVar18 = 1;
        local_188 = 0;
        uVar7 = 1 << ((byte)param_9 & 0x3f);
        lVar14 = (ulong)(param_2 != 1) * 8 + 8;
        puVar8 = &local_108;
        if (param_2 == 1) {
          puVar8 = (ulong *)&local_110;
        }
        local_178 = param_5;
        while ((int)param_6 != 0) {
          uVar3 = local_c8;
          if (param_2 == 1) {
            uVar3 = local_f8;
          }
          if (iVar2 != 0) {
            uVar3 = entry(0);
          }
          sVar9 = pread(param_4,local_78,0x31,local_158 + uVar3);
          if (sVar9 == -1) goto LAB_00105c2a;
          local_78[sVar9] = '\0';
          iVar4 = strcmp(local_78,".debug_info");
          if (iVar4 != 0) {
            iVar4 = iVar18;
          }
          lVar10 = pread((ulong)param_4,local_170,local_160,local_178);
          if (lVar10 < local_150) goto LAB_00105c2a;
          local_178 = local_178 + param_7;
          iVar6 = local_c4;
          if (param_2 == 1) {
            iVar6 = local_f4;
          }
          if (iVar2 != 0) {
            iVar6 = entry(0);
          }
          if (iVar6 == 2) {
            iVar18 = 0;
          }
          else {
            iVar18 = iVar4;
            if (param_8 != 0xffffffffffffffff) {
              if (param_2 == 1) {
                __offset = (ulong)local_e8;
                if (iVar2 != 0) {
                  uVar3 = entry(0);
                  __offset = (ulong)uVar3;
                }
              }
              else {
                __offset = local_b0;
                if (iVar2 != 0) {
                  __offset = FUN_00103e0f(0);
                }
              }
              if ((long)param_8 < (long)__offset) goto LAB_001060bf;
            }
            if (iVar6 == 7) {
              if (param_2 == 1) {
                uVar3 = local_e4;
                if (iVar2 != 0) {
                  uVar3 = entry(0);
                }
                __offset = (ulong)local_e8;
                __size = (ulong)uVar3;
                if (iVar2 != 0) {
                  uVar5 = entry(0);
                  __offset = (ulong)uVar5;
                }
              }
              else {
                __offset = local_b0;
                __size = local_a8;
                if (iVar2 != 0) {
                  __size = FUN_00103e0f(local_a8);
                  __offset = FUN_00103e0f(0);
                }
              }
              if (param_8 < __offset + __size) {
                iVar2 = FUN_00112ee0(param_1,
                                     ", note offset/size 0x%jx+0x%jx exceeds file size 0x%jx",
                                     __offset,__size,param_8);
                goto LAB_00105bdf;
              }
              __buf = malloc(__size);
              if (__buf == (void *)0x0) {
                param_6 = 0xffffffff;
                puVar11 = (uint *)__errno_location();
                FUN_00112ce0(param_1,(ulong)*puVar11,"Cannot allocate memory for note");
                goto LAB_00106303;
              }
              if (param_2 == 1) {
                uVar3 = local_e8;
                if (iVar2 != 0) {
                  uVar3 = entry(0);
                }
                __offset = (ulong)uVar3;
              }
              else {
                __offset = local_b0;
                if (iVar2 != 0) {
                  __offset = FUN_00103e0f(0);
                }
              }
              uVar20 = 0x105d9f;
              sVar9 = pread(param_4,__buf,__size,__offset);
              if (param_2 == 1) {
                __offset = (ulong)local_e4;
                if (iVar2 != 0) {
                  uVar20 = 0x105db7;
                  uVar3 = entry(0);
                  __offset = (ulong)uVar3;
                }
              }
              else {
                __offset = local_a8;
                if (iVar2 != 0) {
                  uVar20 = 0x105dcc;
                  __offset = FUN_00103e0f(0);
                }
              }
              if (sVar9 < (long)__offset) {
                param_6 = 0xffffffff;
                FUN_00113150(param_1);
                free(__buf);
                goto LAB_00106303;
              }
              lVar10 = 0;
              do {
                __offset = local_a8;
                if (param_2 == 1) {
                  uVar3 = local_e4;
                  if (iVar2 != 0) {
                    uVar20 = 0x105e1d;
                    uVar3 = entry(0);
                  }
                  __offset = (ulong)uVar3;
                  if ((long)__offset <= lVar10) break;
                }
                else {
                  __size = local_a8;
                  if (iVar2 != 0) {
                    uVar20 = 0x105e54;
                    __size = FUN_00103e0f(local_a8);
                  }
                  if ((long)__size <= lVar10) break;
                  if (iVar2 != 0) {
                    uVar20 = 0x105e65;
                    __offset = FUN_00103e0f(__offset);
                  }
                }
                lVar10 = FUN_001044e7(param_1,__buf,lVar10,__offset,(ulong)param_2,
                                      param_3 & 0xffffffff,4,param_11,param_12,(ulong)param_4,0,0,0);

              } while (lVar10 != 0);
              free(__buf);
            }
            else {
              if ((((iVar6 == 0x6ffffff5) && (param_9 < 0x3f)) && (local_188 < 6)) &&
                 ((uVar7 & 0x400408000000000c) != 0)) {
                if (param_2 == 1) {
                  uVar3 = local_e8;
                  if (iVar2 != 0) {
                    uVar3 = entry(0);
                  }
                  __offset = (ulong)uVar3;
                }
                else {
                  __offset = local_b0;
                  if (iVar2 != 0) {
                    __offset = FUN_00103e0f(0);
                  }
                }
                _Var12 = lseek(param_4,__offset,0);
                if (_Var12 != -1) {
                  __offset = 0;
LAB_00105f41:
                  while( true ) {
                    __offset = __offset + lVar14;
                    if (param_2 == 1) {
                      __size = (ulong)local_e4;
                      if (iVar2 != 0) {
                        uVar3 = entry(0);
                        __size = (ulong)uVar3;
                      }
                    }
                    else {
                      __size = local_a8;
                      if (iVar2 != 0) {
                        __size = FUN_00103e0f(0);
                      }
                    }
                    if ((long)__size < (long)__offset) break;
                    lVar10 = __read_chk((ulong)param_4,local_88,lVar14,0x10);
                    if (lVar14 != lVar10) {
                      FUN_00113150(param_1);
                      goto LAB_001060fb;
                    }
                    if (local_88[0] == 'A') break;
                    lVar10 = lVar14;
                    pcVar16 = local_88;
                    puVar17 = puVar8;
                    while (lVar10 != 0) {
                      lVar10 = lVar10 + -1;
                      *(char *)puVar17 = *pcVar16;
                      pcVar16 = pcVar16 + (ulong)bVar19 * -2 + 1;
                      puVar17 = (ulong *)((long)puVar17 + (ulong)bVar19 * -2 + 1);
                    }
                    if (param_2 == 1) {
                      if (iVar2 == 0) {
                        if (local_110 == 1) goto LAB_00106033;
                        if (local_110 != 0) {
                          uVar5 = local_10c;
                          uVar3 = local_110;
                          if (local_110 != 2) goto LAB_001062ee;
                          goto LAB_0010607c;
                        }
                      }
                      else {
                        uVar3 = entry(0);
                        if (uVar3 == 1) {
LAB_00106033:
                          uVar3 = local_10c;
                          if (iVar2 != 0) {
                            uVar3 = entry(0);
                          }
                          uVar13 = (ulong)uVar3;
                          goto LAB_0010605d;
                        }
                        if (uVar3 != 0) {
                          if (uVar3 == 2) goto LAB_0010607c;
                          uVar5 = entry((ulong)local_10c);
LAB_001062ee:
                          __size = (ulong)uVar3;
                          uVar13 = (ulong)uVar5;
                          goto LAB_0010625a;
                        }
                      }
                    }
                    else {
                      __size = local_108;
                      uVar13 = local_100;
                      if (iVar2 != 0) {
                        __size = FUN_00103e0f(0);
                        uVar13 = local_100;
                      }
                      local_100 = uVar13;
                      if (__size != 1) goto LAB_00106067;
                      if (param_2 == 1) goto LAB_00106033;
                      if (iVar2 != 0) {
                        uVar13 = FUN_00103e0f(0);
                      }
LAB_0010605d:
                      local_1a0 = local_1a0 | uVar13;
                    }
                  }
                  goto LAB_001060bf;
                }
                param_6 = 0xffffffff;
                FUN_00113130(param_1);
                goto LAB_00106303;
              }
            }
          }
LAB_001060bf:
          param_6 = (ulong)((int)param_6 - 1);
        }
        puVar15 = &DAT_0011b239;
        if (iVar18 != 0) {
          puVar15 = &DAT_0011ad97;
        }
        iVar2 = FUN_00112ee0(param_1,", %sstripped",puVar15);
        if (iVar2 != -1) {
          if (local_1a0 == 0) {
LAB_0010610c:
            if (local_190 == 0) goto LAB_00106303;
            if ((local_190 & 2) != 0) {
              pcVar16 = ", not known to use frame pointer";
              if ((local_190 & 1) != 0) {
                pcVar16 = ", uses frame pointer";
              }
              iVar2 = FUN_00112ee0(param_1,pcVar16);
              if (iVar2 == -1) goto LAB_001060fb;
            }
            if ((local_190 & 0xfffffffffffffffc) == 0) goto LAB_00106303;
            iVar2 = FUN_00112ee0(param_1,", with unknown software capability 0x%llx");
            goto LAB_00105bdf;
          }
          puVar8 = (ulong *)0x0;
          if (param_9 < 0x3f) {
            puVar8 = (ulong *)&DAT_0031f860;
            if (((ulong *)(uVar7 & 0x80000040004) == (ulong *)0x0) &&
               (puVar8 = (ulong *)&DAT_0031f6c0, (uVar7 & 0x4004000000000008) == 0)) {
              puVar8 = (ulong *)(uVar7 & 0x80000040004);
            }
          }
          iVar2 = FUN_00112ee0(param_1,", uses");
          if (iVar2 != -1) {
            if (puVar8 == (ulong *)0x0) {
              pcVar16 = " hardware capability 0x%llx";
            }
            else {
              while (puVar8[1] != 0) {
                if ((*puVar8 & local_1a0) != 0) {
                  iVar2 = FUN_00112ee0(param_1,0x11ad2a);
                  if (iVar2 == -1) goto LAB_001060fb;
                  local_1a0 = local_1a0 & ~*puVar8;
                }
                puVar8 = puVar8 + 2;
              }
              pcVar16 = " unknown hardware capability 0x%llx";
              if (local_1a0 == 0) goto LAB_0010610c;
            }
            iVar2 = FUN_00112ee0(param_1,pcVar16,local_1a0);
            if (iVar2 != -1) goto LAB_0010610c;
          }
        }
LAB_001060fb:
        param_6 = 0xffffffff;
        goto LAB_00106303;
      }
    }
    else {
      if (0x3f < lVar14) {
        local_158 = local_b0;
        if (iVar2 != 0) {
          local_158 = FUN_00103e0f(0);
        }
        local_150 = 0x40;
        goto LAB_00105a04;
      }
    }
LAB_00105c2a:
    param_6 = 0xffffffff;
    FUN_00113150(param_1);
  }
  else {
    if (param_7 == 0x40) {
      lVar14 = (long)param_10 * 0x40;
      local_170 = &local_c8;
      local_160 = 0x40;
      goto LAB_001059b6;
    }
LAB_00105981:
    iVar2 = FUN_00112ee0(param_1,", corrupted section header size");
LAB_00105bdf:
    param_6 = (ulong)-(uint)(iVar2 == -1);
  }
LAB_00106303:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return param_6;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
LAB_00106067:
  if (__size != 0) {
    if (__size == 2) {
      if (param_2 == 1) {
LAB_0010607c:
        uVar3 = local_10c;
        if (iVar2 != 0) {
          uVar3 = entry(0);
        }
        uVar13 = (ulong)uVar3;
      }
      else {
        if (iVar2 != 0) {
          uVar13 = FUN_00103e0f(0);
        }
      }
      local_190 = local_190 | uVar13;
    }
    else {
      if (iVar2 != 0) {
        uVar13 = FUN_00103e0f(uVar13);
      }
LAB_0010625a:
      iVar4 = FUN_00112ee0(param_1,", with unknown capability 0x%llx = 0x%llx",__size,uVar13);
      if (iVar4 == -1) goto LAB_001060fb;
      __size = local_188 + 1;
      bVar1 = 2 < local_188;
      local_188 = __size;
      if (bVar1) {
        if (param_2 == 1) {
          uVar3 = local_e4;
          if (iVar2 != 0) {
            uVar3 = entry(0);
          }
          __offset = (ulong)uVar3;
        }
        else {
          __offset = local_a8;
          if (iVar2 != 0) {
            __offset = FUN_00103e0f(0);
          }
        }
      }
    }
  }
  goto LAB_00105f41;
}



void FUN_00106330(void)

{
                    // WARNING: Subroutine does not return
  __assert_fail("ss == sst->sst_ss","cdf.c",0x11d,"cdf_check_stream");
}



// WARNING: Removing unreachable block (ram,0x00106377)
// WARNING: Removing unreachable block (ram,0x00106383)

void FUN_00106360(void)

{
  return;
}



void _FINI_0(void)

{
  if (DAT_003204e0 != '\0') {
    return;
  }
  __cxa_finalize(PTR_LOOP_00320380);
  FUN_00106360();
  DAT_003204e0 = 1;
  return;
}



// WARNING: Removing unreachable block (ram,0x001063c8)
// WARNING: Removing unreachable block (ram,0x001063d4)

void _INIT_0(void)

{
  return;
}



ulong FUN_00106440(undefined8 param_1,undefined8 param_2,char *param_3)

{
  int iVar1;
  ulong uVar2;
  
  if (((param_3 == (char *)0x0) ||
      (((iVar1 = access(param_3,2), iVar1 != 0 ||
        (iVar1 = FUN_00112ee0(param_1,"writable, "), iVar1 != -1)) &&
       ((iVar1 = access(param_3,1), iVar1 != 0 ||
        (iVar1 = FUN_00112ee0(param_1,"executable, "), iVar1 != -1)))))) &&
     ((((uint)param_2 & 0xf000) != 0x8000 ||
      (iVar1 = FUN_00112ee0(param_1,"regular file, "), iVar1 != -1)))) {
    iVar1 = FUN_00112ee0(param_1,"no read permission");
    uVar2 = (ulong)-(uint)(iVar1 == -1);
  }
  else {
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



/*
char * magic_getpath(char *param_1,int param_2)

{
  int iVar1;
  char *pcVar2;
  long in_FS_OFFSET;
  char *local_c0;
  stat local_b8;
  long local_20;
  
  local_20 = *(long *)(in_FS_OFFSET + 0x28);
  if (((param_1 != (char *)0x0) || (param_1 = getenv("MAGIC"), param_1 != (char *)0x0)) ||
     (param_1 = "/usr/local/share/misc/magic", param_2 != 0)) goto LAB_00106a16;
  if (DAT_003204e8 != (char *)0x0) {
    free(DAT_003204e8);
    DAT_003204e8 = (char *)0x0;
  }
  pcVar2 = getenv("HOME");
  if (pcVar2 != (char *)0x0) {
    iVar1 = asprintf(&local_c0,1,"%s/.magic.mgc",pcVar2);
    if (-1 < iVar1) {
      iVar1 = __xstat(1,local_c0,&local_b8);
      if (iVar1 == -1) {
        free(local_c0);
        iVar1 = asprintf(&local_c0,1,"%s/.magic",pcVar2);
        if (iVar1 < 0) goto LAB_00106b20;
        iVar1 = __xstat(1,local_c0,&local_b8);
        if (iVar1 != -1) {
          if ((local_b8.st_mode & 0xf000) == 0x4000) {
            free(local_c0);
            iVar1 = asprintf(&local_c0,1,"%s/%s",pcVar2,"/.magic/magic.mgc");
            if (iVar1 < 0) goto LAB_00106b20;
            iVar1 = access(local_c0,4);
            if (iVar1 == -1) goto LAB_00106b04;
          }
          goto LAB_00106ad6;
        }
      }
      else {
LAB_00106ad6:
        iVar1 = asprintf(&DAT_003204e8,1,"%s:%s",local_c0,"/usr/local/share/misc/magic");
        if (-1 < iVar1) {
          free(local_c0);
          param_1 = DAT_003204e8;
          goto LAB_00106a16;
        }
      }
LAB_00106b04:
      DAT_003204e8 = (char *)0x0;
      free(local_c0);
    }
  }
LAB_00106b20:
  param_1 = "/usr/local/share/misc/magic";
LAB_00106a16:
  if (local_20 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return param_1;
}
*/



undefined8 * magic_open(uint param_1)

{
  int iVar1;
  undefined8 *__ptr;
  void *pvVar2;
  int *piVar3;
  
  __ptr = (undefined8 *)calloc(1,0xe8);
  if (__ptr == (undefined8 *)0x0) {
    return (undefined8 *)0;
  }
  iVar1 = magic_setflags(__ptr,(ulong)param_1);
  if (iVar1 == -1) {
    piVar3 = __errno_location();
    *piVar3 = 0x16;
  }
  else {
    __ptr[5] = 0;
    __ptr[4] = 0;
    __ptr[2] = 10;
    pvVar2 = malloc(0xa0);
    *(void **)(__ptr + 3) = pvVar2;
    if (pvVar2 != (void *)0x0) {
      *(undefined4 *)((long)__ptr + 0x3c) = 0;
      *(undefined4 *)((long)__ptr + 0x34) = 0xffffffff;
      *__ptr = 0;
      __ptr[1] = 0;
      __ptr[8] = 0x11c38e;
      __ptr[9] = 0;
      __ptr[0x1a] = 0x8008000001e0032;
      *(undefined4 *)(__ptr + 0x1b) = 0x20000100;
      __ptr[0x1c] = 0x100000;
      return __ptr;
    }
  }
  free(__ptr);
  return (undefined8 *)0;
}



void magic_close(undefined8 *param_1)

{
  if (param_1 == (undefined8 *)0x0) {
    return;
  }
  if (param_1 != (undefined8 *)0x0) {
    FUN_00107040(*param_1);
    FUN_00107040(param_1[1]);
    free((void *)param_1[5]);
    free((void *)param_1[4]);
    free((void *)param_1[3]);
    free(param_1);
    return;
  }
  return;
}



// WARNING: Removing unreachable block (ram,0x0010b270)
// WARNING: Removing unreachable block (ram,0x0010b2f0)
// WARNING: Removing unreachable block (ram,0x0010b309)
// WARNING: Removing unreachable block (ram,0x0010b562)

ulong magic_load(void **param_1,undefined8 param_2)

{
  byte bVar1;
  void *pvVar2;
  int __fildes;
  int iVar3;
  uint uVar4;
  char *__ptr;
  void *pvVar5;
  char *__file;
  uint *puVar6;
  size_t sVar7;
  char *pcVar8;
  char *__s;
  uint uVar9;
  void **ppvVar10;
  char *pcVar11;
  long in_FS_OFFSET;
  stat sStack216;
  long lStack64;
  
  if (param_1 == (void **)0x0) {
    return 0xffffffff;
  }
  lStack64 = *(long *)(in_FS_OFFSET + 0x28);
  if (*param_1 != (void *)0x0) {
    FUN_00113670(0);
  }
  __s = (char *)magic_getpath(param_2,0);
  if (__s == (char *)0x0) {
    uVar9 = 0xffffffff;
  }
  else {
    FUN_00107ea0();
    __ptr = strdup(__s);
    if (__ptr == (char *)0x0) {
      uVar9 = 0xffffffff;
      sVar7 = strlen(__s);
      FUN_00113100(param_1,sVar7);
    }
    else {
      FUN_00107040(*param_1);
      pvVar5 = calloc(1,0x28);
      if (pvVar5 == (void *)0x0) {
        *param_1 = (void *)0x0;
        FUN_00113100(param_1,0x28);
      }
      else {
        pvVar2 = param_1[1];
        *(void **)((long)pvVar5 + 0x20) = pvVar5;
        *(void **)((long)pvVar5 + 0x18) = pvVar5;
        *param_1 = pvVar5;
        FUN_00107040(pvVar2);
        pvVar5 = calloc(1,0x28);
        if (pvVar5 != (void *)0x0) {
          *(void **)((long)pvVar5 + 0x20) = pvVar5;
          *(void **)((long)pvVar5 + 0x18) = pvVar5;
          uVar9 = 0xffffffff;
          param_1[1] = pvVar5;
          __s = __ptr;
          do {
            pcVar11 = (char *)0x0;
            __file = strchr(__s,0x3a);
            if (__file != (char *)0x0) {
              pcVar11 = __file + 1;
              *__file = '\0';
            }
            if (*__s == '\0') break;
            ppvVar10 = (void **)calloc(1,0x30);
            if (ppvVar10 == (void **)0x0) {
              FUN_00113100(param_1,0x30);
              FUN_00106fb0(0);
LAB_0010b19f:
              bVar1 = *(byte *)(param_1 + 7);
joined_r0x0010b32c:
              if ((bVar1 & 0x40) != 0) {
                FUN_00111c10(param_1,"using regular magic file `%s\'",__s);
              }
              ppvVar10 = (void **)FUN_0010a770(param_1,__s,0);
              if (ppvVar10 == (void **)0x0) {
                uVar4 = 0xffffffff;
              }
              else {
LAB_0010b1cb:
                __fildes = FUN_00107090(*param_1,ppvVar10,0);
                if ((__fildes == -1) ||
                   (__fildes = FUN_00107090(param_1[1],ppvVar10,1), __fildes == -1)) {
                  FUN_00113100(param_1,0x28);
                  goto LAB_0010b37d;
                }
                uVar4 = 0;
              }
            }
            else {
              *(undefined4 *)(ppvVar10 + 2) = 0;
              __file = (char *)FUN_00107f60(param_1 + 7,__s,0);
              if (__file == (char *)0x0) {
                FUN_00106fb0(ppvVar10);
                bVar1 = *(byte *)(param_1 + 7);
                goto joined_r0x0010b32c;
              }
              __fildes = open(__file,0);
              if (__fildes == -1) {
LAB_0010b18f:
                FUN_00106fb0(ppvVar10);
                free(__file);
                goto LAB_0010b19f;
              }
              iVar3 = __fxstat(1,__fildes,&sStack216);
              if (iVar3 == -1) {
                puVar6 = (uint *)__errno_location();
                pcVar8 = "cannot stat `%s\'";
LAB_0010b42f:
                FUN_00112ce0(param_1,(ulong)*puVar6,pcVar8,__file);
LAB_0010b187:
                close(__fildes);
                goto LAB_0010b18f;
              }
              if ((long)sStack216.st_size < 8) {
                FUN_00112ce0(param_1,0,"file `%s\' is too %s",__file);
                goto LAB_0010b187;
              }
              ppvVar10[1] = sStack216.st_size;
              *(undefined4 *)(ppvVar10 + 2) = 2;
              pvVar5 = mmap((void *)0x0,(size_t)sStack216.st_size,3,2,__fildes,0);
              *ppvVar10 = pvVar5;
              if (pvVar5 == (void *)0xffffffffffffffff) {
                puVar6 = (uint *)__errno_location();
                pcVar8 = "cannot map `%s\'";
                goto LAB_0010b42f;
              }
              close(__fildes);
              __fildes = FUN_00107100(param_1,ppvVar10,__file);
              if (__fildes == 0) {
                __fildes = mprotect(*ppvVar10,(size_t)sStack216.st_size,1);
                if (__fildes == -1) {
                  puVar6 = (uint *)__errno_location();
                  FUN_00112ce0(param_1,(ulong)*puVar6,"cannot mprotect `%s\'",__file);
                  FUN_00106fb0(ppvVar10);
                  free(__file);
                  goto LAB_0010b19f;
                }
                free(__file);
                goto LAB_0010b1cb;
              }
              FUN_00106fb0(ppvVar10);
              free(__file);
LAB_0010b37d:
              FUN_00107040(*param_1);
              *param_1 = (void *)0x0;
              FUN_00107040(param_1[1]);
              param_1[1] = (void *)0x0;
              uVar4 = 0xffffffff;
            }
            if ((int)uVar9 < (int)uVar4) {
              uVar9 = uVar4;
            }
            __s = pcVar11;
          } while (pcVar11 != (char *)0x0);
          free(__ptr);
          if (uVar9 == 0xffffffff) {
            FUN_00107040(*param_1);
            *param_1 = (void *)0x0;
            FUN_00107040(param_1[1]);
            param_1[1] = (void *)0x0;
            FUN_00112ce0(param_1,0,"could not find any valid magic files!");
          }
          else {
            uVar9 = 0;
          }
          goto LAB_0010b23d;
        }
        param_1[1] = (void *)0x0;
        FUN_00113100(param_1,0x28);
        FUN_00107040(*param_1);
        *param_1 = (void *)0x0;
      }
      uVar9 = 0xffffffff;
      free(__ptr);
    }
  }
LAB_0010b23d:
  if (lStack64 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return (ulong)uVar9;
}



ulong magic_load_buffers(void **param_1,long param_2,long param_3,long param_4)

{
  void *pvVar1;
  undefined8 uVar2;
  undefined8 uVar3;
  uint uVar4;
  int iVar5;
  void *pvVar6;
  undefined8 *puVar7;
  long lVar8;
  
  if (param_1 == (void **)0x0) {
    return 0xffffffff;
  }
  if (param_4 == 0) {
    return 0xffffffff;
  }
  if (*param_1 != (void *)0x0) {
    FUN_00113670(0);
  }
  FUN_00107ea0();
  FUN_00107040(*param_1);
  pvVar6 = calloc(1,0x28);
  if (pvVar6 == (void *)0x0) {
    lVar8 = 0;
  }
  else {
    pvVar1 = param_1[1];
    *(void **)((long)pvVar6 + 0x20) = pvVar6;
    *(void **)((long)pvVar6 + 0x18) = pvVar6;
    *param_1 = pvVar6;
    FUN_00107040(pvVar1);
    pvVar6 = calloc(1,0x28);
    if (pvVar6 != (void *)0x0) {
      *(void **)((long)pvVar6 + 0x20) = pvVar6;
      *(void **)((long)pvVar6 + 0x18) = pvVar6;
      lVar8 = 0;
      param_1[1] = pvVar6;
      while( true ) {
        uVar2 = *(undefined8 *)(param_3 + lVar8 * 8);
        uVar3 = *(undefined8 *)(param_2 + lVar8 * 8);
        puVar7 = (undefined8 *)calloc(1,0x30);
        if (puVar7 == (undefined8 *)0x0) {
          FUN_00113100(param_1,0x30);
          goto LAB_001088de;
        }
        *puVar7 = uVar3;
        puVar7[1] = uVar2;
        *(undefined4 *)(puVar7 + 2) = 0;
        uVar4 = FUN_00107100(param_1,puVar7,"buffer");
        if (uVar4 != 0) break;
        iVar5 = FUN_00107090(*param_1,puVar7,0);
        if ((iVar5 == -1) || (iVar5 = FUN_00107090(param_1[1],puVar7,1), iVar5 == -1)) {
          FUN_00113100(param_1,0x28);
          goto LAB_001088de;
        }
        lVar8 = lVar8 + 1;
        if (param_4 == lVar8) {
          return (ulong)uVar4;
        }
      }
      FUN_00106fb0(puVar7);
      goto LAB_001088de;
    }
    lVar8 = 1;
  }
  param_1[lVar8] = (void *)0x0;
  FUN_00113100(param_1,0x28);
LAB_001088de:
  FUN_00107040(*param_1);
  *param_1 = (void *)0x0;
  FUN_00107040(param_1[1]);
  param_1[1] = (void *)0x0;
  return 0xffffffff;
}



// WARNING: Removing unreachable block (ram,0x0010b270)
// WARNING: Removing unreachable block (ram,0x0010b0e1)
// WARNING: Removing unreachable block (ram,0x0010b350)
// WARNING: Removing unreachable block (ram,0x0010b0fc)
// WARNING: Removing unreachable block (ram,0x0010b320)
// WARNING: Removing unreachable block (ram,0x0010b11d)
// WARNING: Removing unreachable block (ram,0x0010b12e)
// WARNING: Removing unreachable block (ram,0x0010b420)
// WARNING: Removing unreachable block (ram,0x0010b151)
// WARNING: Removing unreachable block (ram,0x0010b160)
// WARNING: Removing unreachable block (ram,0x0010b3b0)
// WARNING: Removing unreachable block (ram,0x0010b448)
// WARNING: Removing unreachable block (ram,0x0010b42f)
// WARNING: Removing unreachable block (ram,0x0010b187)
// WARNING: Removing unreachable block (ram,0x0010b18f)
// WARNING: Removing unreachable block (ram,0x0010b3e7)
// WARNING: Removing unreachable block (ram,0x0010b4c0)
// WARNING: Removing unreachable block (ram,0x0010b4e5)
// WARNING: Removing unreachable block (ram,0x0010b19f)
// WARNING: Removing unreachable block (ram,0x0010b332)
// WARNING: Removing unreachable block (ram,0x0010b1b0)
// WARNING: Removing unreachable block (ram,0x0010b4d8)
// WARNING: Removing unreachable block (ram,0x0010b1cb)
// WARNING: Removing unreachable block (ram,0x0010b1e1)
// WARNING: Removing unreachable block (ram,0x0010b1fb)
// WARNING: Removing unreachable block (ram,0x0010b202)
// WARNING: Removing unreachable block (ram,0x0010b370)
// WARNING: Removing unreachable block (ram,0x0010b405)
// WARNING: Removing unreachable block (ram,0x0010b37d)
// WARNING: Removing unreachable block (ram,0x0010b562)

ulong magic_compile(void **param_1,undefined8 param_2)

{
  long lVar1;
  void *pvVar2;
  uint uVar3;
  char *__ptr;
  void *pvVar4;
  char *pcVar5;
  long lVar6;
  size_t sVar7;
  char *__s;
  uint uVar8;
  char *pcVar9;
  long in_FS_OFFSET;
  
  if (param_1 == (void **)0x0) {
    return 0xffffffff;
  }
  lVar1 = *(long *)(in_FS_OFFSET + 0x28);
  if (*param_1 != (void *)0x0) {
    FUN_00113670(0);
  }
  __s = (char *)magic_getpath(param_2,2);
  if (__s == (char *)0x0) {
    uVar8 = 0xffffffff;
  }
  else {
    FUN_00107ea0();
    __ptr = strdup(__s);
    if (__ptr == (char *)0x0) {
      uVar8 = 0xffffffff;
      sVar7 = strlen(__s);
      FUN_00113100(param_1,sVar7);
    }
    else {
      FUN_00107040(*param_1);
      pvVar4 = calloc(1,0x28);
      if (pvVar4 == (void *)0x0) {
        *param_1 = (void *)0x0;
        FUN_00113100(param_1,0x28);
      }
      else {
        pvVar2 = param_1[1];
        *(void **)((long)pvVar4 + 0x20) = pvVar4;
        *(void **)((long)pvVar4 + 0x18) = pvVar4;
        *param_1 = pvVar4;
        FUN_00107040(pvVar2);
        pvVar4 = calloc(1,0x28);
        if (pvVar4 != (void *)0x0) {
          *(void **)((long)pvVar4 + 0x20) = pvVar4;
          *(void **)((long)pvVar4 + 0x18) = pvVar4;
          uVar8 = 0xffffffff;
          param_1[1] = pvVar4;
          __s = __ptr;
          do {
            pcVar9 = (char *)0x0;
            pcVar5 = strchr(__s,0x3a);
            if (pcVar5 != (char *)0x0) {
              pcVar9 = pcVar5 + 1;
              *pcVar5 = '\0';
            }
            if (*__s == '\0') break;
            lVar6 = FUN_0010a770(param_1,__s,2);
            if (lVar6 == 0) {
              uVar3 = 0xffffffff;
            }
            else {
              uVar3 = FUN_00108100(param_1,lVar6,__s);
            }
            if ((int)uVar8 < (int)uVar3) {
              uVar8 = uVar3;
            }
            __s = pcVar9;
          } while (pcVar9 != (char *)0x0);
          free(__ptr);
          if (uVar8 == 0xffffffff) {
            FUN_00107040(*param_1);
            *param_1 = (void *)0x0;
            FUN_00107040(param_1[1]);
            param_1[1] = (void *)0x0;
            FUN_00112ce0(param_1,0,"could not find any valid magic files!");
          }
          else {
            uVar8 = 0;
          }
          goto LAB_0010b23d;
        }
        param_1[1] = (void *)0x0;
        FUN_00113100(param_1,0x28);
        FUN_00107040(*param_1);
        *param_1 = (void *)0x0;
      }
      uVar8 = 0xffffffff;
      free(__ptr);
    }
  }
LAB_0010b23d:
  if (lVar1 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return (ulong)uVar8;
}



// WARNING: Removing unreachable block (ram,0x0010b270)
// WARNING: Removing unreachable block (ram,0x0010b2f0)
// WARNING: Removing unreachable block (ram,0x0010b309)
// WARNING: Removing unreachable block (ram,0x0010b562)

ulong magic_check(void **param_1,undefined8 param_2)

{
  byte bVar1;
  void *pvVar2;
  int __fildes;
  int iVar3;
  uint uVar4;
  char *__ptr;
  void *pvVar5;
  char *__file;
  uint *puVar6;
  size_t sVar7;
  char *pcVar8;
  char *__s;
  uint uVar9;
  void **ppvVar10;
  char *pcVar11;
  long in_FS_OFFSET;
  stat local_d8;
  long local_40;
  
  if (param_1 == (void **)0x0) {
    return 0xffffffff;
  }
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if (*param_1 != (void *)0x0) {
    FUN_00113670(0);
  }
  __s = (char *)magic_getpath(param_2,1);
  if (__s == (char *)0x0) {
    uVar9 = 0xffffffff;
  }
  else {
    FUN_00107ea0();
    __ptr = strdup(__s);
    if (__ptr == (char *)0x0) {
      uVar9 = 0xffffffff;
      sVar7 = strlen(__s);
      FUN_00113100(param_1,sVar7);
    }
    else {
      FUN_00107040(*param_1);
      pvVar5 = calloc(1,0x28);
      if (pvVar5 == (void *)0x0) {
        *param_1 = (void *)0x0;
        FUN_00113100(param_1,0x28);
      }
      else {
        pvVar2 = param_1[1];
        *(void **)((long)pvVar5 + 0x20) = pvVar5;
        *(void **)((long)pvVar5 + 0x18) = pvVar5;
        *param_1 = pvVar5;
        FUN_00107040(pvVar2);
        pvVar5 = calloc(1,0x28);
        if (pvVar5 != (void *)0x0) {
          *(void **)((long)pvVar5 + 0x20) = pvVar5;
          *(void **)((long)pvVar5 + 0x18) = pvVar5;
          uVar9 = 0xffffffff;
          param_1[1] = pvVar5;
          __s = __ptr;
          do {
            pcVar11 = (char *)0x0;
            __file = strchr(__s,0x3a);
            if (__file != (char *)0x0) {
              pcVar11 = __file + 1;
              *__file = '\0';
            }
            if (*__s == '\0') break;
            ppvVar10 = (void **)calloc(1,0x30);
            if (ppvVar10 == (void **)0x0) {
              FUN_00113100(param_1,0x30);
              FUN_00106fb0(0);
LAB_0010b19f:
              bVar1 = *(byte *)(param_1 + 7);
joined_r0x0010b32c:
              if ((bVar1 & 0x40) != 0) {
                FUN_00111c10(param_1,"using regular magic file `%s\'",__s);
              }
              ppvVar10 = (void **)FUN_0010a770(param_1,__s,1);
              if (ppvVar10 == (void **)0x0) {
                uVar4 = 0xffffffff;
              }
              else {
LAB_0010b1cb:
                __fildes = FUN_00107090(*param_1,ppvVar10,0);
                if ((__fildes == -1) ||
                   (__fildes = FUN_00107090(param_1[1],ppvVar10,1), __fildes == -1)) {
                  FUN_00113100(param_1,0x28);
                  goto LAB_0010b37d;
                }
                uVar4 = 0;
              }
            }
            else {
              *(undefined4 *)(ppvVar10 + 2) = 0;
              __file = (char *)FUN_00107f60(param_1 + 7,__s,0);
              if (__file == (char *)0x0) {
                FUN_00106fb0(ppvVar10);
                bVar1 = *(byte *)(param_1 + 7);
                goto joined_r0x0010b32c;
              }
              __fildes = open(__file,0);
              if (__fildes == -1) {
LAB_0010b18f:
                FUN_00106fb0(ppvVar10);
                free(__file);
                goto LAB_0010b19f;
              }
              iVar3 = __fxstat(1,__fildes,&local_d8);
              if (iVar3 == -1) {
                puVar6 = (uint *)__errno_location();
                pcVar8 = "cannot stat `%s\'";
LAB_0010b42f:
                FUN_00112ce0(param_1,(ulong)*puVar6,pcVar8,__file);
LAB_0010b187:
                close(__fildes);
                goto LAB_0010b18f;
              }
              if ((long)local_d8.st_size < 8) {
                FUN_00112ce0(param_1,0,"file `%s\' is too %s",__file);
                goto LAB_0010b187;
              }
              ppvVar10[1] = local_d8.st_size;
              *(undefined4 *)(ppvVar10 + 2) = 2;
              pvVar5 = mmap((void *)0x0,(size_t)local_d8.st_size,3,2,__fildes,0);
              *ppvVar10 = pvVar5;
              if (pvVar5 == (void *)0xffffffffffffffff) {
                puVar6 = (uint *)__errno_location();
                pcVar8 = "cannot map `%s\'";
                goto LAB_0010b42f;
              }
              close(__fildes);
              __fildes = FUN_00107100(param_1,ppvVar10,__file);
              if (__fildes == 0) {
                __fildes = mprotect(*ppvVar10,(size_t)local_d8.st_size,1);
                if (__fildes == -1) {
                  puVar6 = (uint *)__errno_location();
                  FUN_00112ce0(param_1,(ulong)*puVar6,"cannot mprotect `%s\'",__file);
                  FUN_00106fb0(ppvVar10);
                  free(__file);
                  goto LAB_0010b19f;
                }
                free(__file);
                goto LAB_0010b1cb;
              }
              FUN_00106fb0(ppvVar10);
              free(__file);
LAB_0010b37d:
              FUN_00107040(*param_1);
              *param_1 = (void *)0x0;
              FUN_00107040(param_1[1]);
              param_1[1] = (void *)0x0;
              uVar4 = 0xffffffff;
            }
            if ((int)uVar9 < (int)uVar4) {
              uVar9 = uVar4;
            }
            __s = pcVar11;
          } while (pcVar11 != (char *)0x0);
          free(__ptr);
          if (uVar9 == 0xffffffff) {
            FUN_00107040(*param_1);
            *param_1 = (void *)0x0;
            FUN_00107040(param_1[1]);
            param_1[1] = (void *)0x0;
            FUN_00112ce0(param_1,0,"could not find any valid magic files!");
          }
          else {
            uVar9 = 0;
          }
          goto LAB_0010b23d;
        }
        param_1[1] = (void *)0x0;
        FUN_00113100(param_1,0x28);
        FUN_00107040(*param_1);
        *param_1 = (void *)0x0;
      }
      uVar9 = 0xffffffff;
      free(__ptr);
    }
  }
LAB_0010b23d:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return (ulong)uVar9;
}



// WARNING: Removing unreachable block (ram,0x0010b2f0)
// WARNING: Removing unreachable block (ram,0x0010b309)
// WARNING: Removing unreachable block (ram,0x0010b562)

ulong magic_list(void **param_1,undefined8 param_2)

{
  byte bVar1;
  void *pvVar2;
  int __fildes;
  int iVar3;
  uint uVar4;
  char *__ptr;
  void *pvVar5;
  char *__file;
  uint *puVar6;
  size_t sVar7;
  char *pcVar8;
  char *__s;
  uint uVar9;
  void **ppvVar10;
  char *pcVar11;
  long in_FS_OFFSET;
  stat sStack216;
  long lStack64;
  
  if (param_1 == (void **)0x0) {
    return 0xffffffff;
  }
  lStack64 = *(long *)(in_FS_OFFSET + 0x28);
  if (*param_1 != (void *)0x0) {
    FUN_00113670(0);
  }
  __s = (char *)magic_getpath(param_2,3);
  if (__s == (char *)0x0) {
    uVar9 = 0xffffffff;
  }
  else {
    FUN_00107ea0();
    __ptr = strdup(__s);
    if (__ptr == (char *)0x0) {
      uVar9 = 0xffffffff;
      sVar7 = strlen(__s);
      FUN_00113100(param_1,sVar7);
    }
    else {
      FUN_00107040(*param_1);
      pvVar5 = calloc(1,0x28);
      if (pvVar5 == (void *)0x0) {
        *param_1 = (void *)0x0;
        FUN_00113100(param_1,0x28);
      }
      else {
        pvVar2 = param_1[1];
        *(void **)((long)pvVar5 + 0x20) = pvVar5;
        *(void **)((long)pvVar5 + 0x18) = pvVar5;
        *param_1 = pvVar5;
        FUN_00107040(pvVar2);
        pvVar5 = calloc(1,0x28);
        if (pvVar5 != (void *)0x0) {
          *(void **)((long)pvVar5 + 0x20) = pvVar5;
          *(void **)((long)pvVar5 + 0x18) = pvVar5;
          uVar9 = 0xffffffff;
          param_1[1] = pvVar5;
          __s = __ptr;
          do {
            pcVar11 = (char *)0x0;
            __file = strchr(__s,0x3a);
            if (__file != (char *)0x0) {
              pcVar11 = __file + 1;
              *__file = '\0';
            }
            if (*__s == '\0') break;
            ppvVar10 = (void **)calloc(1,0x30);
            if (ppvVar10 == (void **)0x0) {
              FUN_00113100(param_1,0x30);
              FUN_00106fb0(0);
LAB_0010b19f:
              bVar1 = *(byte *)(param_1 + 7);
joined_r0x0010b32c:
              if ((bVar1 & 0x40) != 0) {
                FUN_00111c10(param_1,"using regular magic file `%s\'",__s);
              }
              ppvVar10 = (void **)FUN_0010a770(param_1,__s,3);
              if (ppvVar10 == (void **)0x0) {
                uVar4 = 0xffffffff;
              }
              else {
LAB_0010b1cb:
                __fildes = FUN_00107090(*param_1,ppvVar10,0);
                if ((__fildes == -1) ||
                   (__fildes = FUN_00107090(param_1[1],ppvVar10,1), __fildes == -1)) {
                  FUN_00113100(param_1,0x28);
                  goto LAB_0010b37d;
                }
                __printf_chk(1,"Set %zu:\nBinary patterns:\n",0);
                FUN_00107d70(*param_1,0x20);
                puts("Text patterns:");
                FUN_00107d70(*param_1,0x40);
                __printf_chk(1,"Set %zu:\nBinary patterns:\n",1);
                FUN_00107d70(param_1[1],0x20);
                puts("Text patterns:");
                FUN_00107d70(param_1[1],0x40);
                uVar4 = 0;
              }
            }
            else {
              *(undefined4 *)(ppvVar10 + 2) = 0;
              __file = (char *)FUN_00107f60(param_1 + 7,__s,0);
              if (__file == (char *)0x0) {
                FUN_00106fb0(ppvVar10);
                bVar1 = *(byte *)(param_1 + 7);
                goto joined_r0x0010b32c;
              }
              __fildes = open(__file,0);
              if (__fildes == -1) {
LAB_0010b18f:
                FUN_00106fb0(ppvVar10);
                free(__file);
                goto LAB_0010b19f;
              }
              iVar3 = __fxstat(1,__fildes,&sStack216);
              if (iVar3 == -1) {
                puVar6 = (uint *)__errno_location();
                pcVar8 = "cannot stat `%s\'";
LAB_0010b42f:
                FUN_00112ce0(param_1,(ulong)*puVar6,pcVar8,__file);
LAB_0010b187:
                close(__fildes);
                goto LAB_0010b18f;
              }
              if ((long)sStack216.st_size < 8) {
                FUN_00112ce0(param_1,0,"file `%s\' is too %s",__file);
                goto LAB_0010b187;
              }
              ppvVar10[1] = sStack216.st_size;
              *(undefined4 *)(ppvVar10 + 2) = 2;
              pvVar5 = mmap((void *)0x0,(size_t)sStack216.st_size,3,2,__fildes,0);
              *ppvVar10 = pvVar5;
              if (pvVar5 == (void *)0xffffffffffffffff) {
                puVar6 = (uint *)__errno_location();
                pcVar8 = "cannot map `%s\'";
                goto LAB_0010b42f;
              }
              close(__fildes);
              __fildes = FUN_00107100(param_1,ppvVar10,__file);
              if (__fildes == 0) {
                __fildes = mprotect(*ppvVar10,(size_t)sStack216.st_size,1);
                if (__fildes == -1) {
                  puVar6 = (uint *)__errno_location();
                  FUN_00112ce0(param_1,(ulong)*puVar6,"cannot mprotect `%s\'",__file);
                  FUN_00106fb0(ppvVar10);
                  free(__file);
                  goto LAB_0010b19f;
                }
                free(__file);
                goto LAB_0010b1cb;
              }
              FUN_00106fb0(ppvVar10);
              free(__file);
LAB_0010b37d:
              FUN_00107040(*param_1);
              *param_1 = (void *)0x0;
              FUN_00107040(param_1[1]);
              param_1[1] = (void *)0x0;
              uVar4 = 0xffffffff;
            }
            if ((int)uVar9 < (int)uVar4) {
              uVar9 = uVar4;
            }
            __s = pcVar11;
          } while (pcVar11 != (char *)0x0);
          free(__ptr);
          if (uVar9 == 0xffffffff) {
            FUN_00107040(*param_1);
            *param_1 = (void *)0x0;
            FUN_00107040(param_1[1]);
            param_1[1] = (void *)0x0;
            FUN_00112ce0(param_1,0,"could not find any valid magic files!");
          }
          else {
            uVar9 = 0;
          }
          goto LAB_0010b23d;
        }
        param_1[1] = (void *)0x0;
        FUN_00113100(param_1,0x28);
        FUN_00107040(*param_1);
        *param_1 = (void *)0x0;
      }
      uVar9 = 0xffffffff;
      free(__ptr);
    }
  }
LAB_0010b23d:
  if (lStack64 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return (ulong)uVar9;
}



// WARNING: Removing unreachable block (ram,0x001066c0)
// WARNING: Removing unreachable block (ram,0x00106589)
// WARNING: Removing unreachable block (ram,0x00106810)
// WARNING: Removing unreachable block (ram,0x00106890)
// WARNING: Removing unreachable block (ram,0x001068a7)
// WARNING: Removing unreachable block (ram,0x00106940)
// WARNING: Removing unreachable block (ram,0x001065a1)
// WARNING: Removing unreachable block (ram,0x001065b4)
// WARNING: Removing unreachable block (ram,0x001065b8)
// WARNING: Removing unreachable block (ram,0x00106910)
// WARNING: Removing unreachable block (ram,0x0010692b)
// WARNING: Removing unreachable block (ram,0x00106939)
// WARNING: Removing unreachable block (ram,0x0010674d)
// WARNING: Removing unreachable block (ram,0x00106833)
// WARNING: Removing unreachable block (ram,0x001065e4)
// WARNING: Removing unreachable block (ram,0x001068aa)
// WARNING: Removing unreachable block (ram,0x001065fb)
// WARNING: Removing unreachable block (ram,0x00106947)
// WARNING: Removing unreachable block (ram,0x001069be)
// WARNING: Removing unreachable block (ram,0x0010695a)
// WARNING: Removing unreachable block (ram,0x00106985)
// WARNING: Removing unreachable block (ram,0x00106988)
// WARNING: Removing unreachable block (ram,0x00106998)
// WARNING: Removing unreachable block (ram,0x001069d2)
// WARNING: Removing unreachable block (ram,0x001068c8)
// WARNING: Removing unreachable block (ram,0x001068f5)
// WARNING: Removing unreachable block (ram,0x0010672d)
// WARNING: Removing unreachable block (ram,0x00106841)
// WARNING: Removing unreachable block (ram,0x00106855)

undefined8 magic_descriptor(long param_1,uint param_2)

{
  int iVar1;
  int iVar2;
  void *__ptr;
  long lVar3;
  undefined8 uVar4;
  uint *puVar5;
  ulong uVar6;
  ulong uVar7;
  undefined8 *puVar8;
  ssize_t sVar9;
  long in_FS_OFFSET;
  byte bVar10;
  __off_t local_100;
  stat local_d8;
  long local_40;
  
  bVar10 = 0;
  if (param_1 == 0) {
    return 0;
  }
  uVar7 = (ulong)param_2;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  iVar1 = FUN_00113670(0);
  if ((iVar1 != -1) && (__ptr = malloc(*(long *)(param_1 + 0xe0) + 0x61), __ptr != (void *)0x0)) {
    iVar1 = FUN_00112530(param_1,0,&local_d8);
    if (iVar1 != -1) {
      if (iVar1 == 0) {
        iVar2 = __fxstat(1,param_2,&local_d8);
        if ((iVar2 == 0) && ((local_d8.st_mode & 0xf000) == 0x1000)) {
          lVar3 = *(long *)(param_1 + 0xe0);
          sVar9 = 0;
          while ((lVar3 = FUN_00110380(uVar7,(long)__ptr + sVar9,lVar3 - sVar9,0), 0 < lVar3 &&
                 (sVar9 = sVar9 + lVar3, 0xfff < lVar3))) {
            lVar3 = *(long *)(param_1 + 0xe0);
          }
          local_100 = -1;
LAB_00106651:
          puVar8 = (undefined8 *)((long)__ptr + sVar9);
          *puVar8 = 0;
          *(undefined8 *)((long)puVar8 + 0x59) = 0;
          uVar6 = (ulong)(((int)puVar8 -
                          (int)(undefined8 *)((ulong)(puVar8 + 1) & 0xfffffffffffffff8)) + 0x61U >>
                         3);
          puVar8 = (undefined8 *)((ulong)(puVar8 + 1) & 0xfffffffffffffff8);
          while (uVar6 != 0) {
            uVar6 = uVar6 - 1;
            *puVar8 = 0;
            puVar8 = puVar8 + (ulong)bVar10 * 0x1ffffffffffffffe + 1;
          }
          iVar2 = FUN_00113170(param_1,uVar7,0,__ptr,sVar9);
          if (iVar2 == -1) goto LAB_001067ec;
          free(__ptr);
          if (param_2 == 0xffffffff) goto LAB_001066e1;
        }
        else {
          local_100 = lseek(param_2,0,1);
          sVar9 = read(param_2,__ptr,*(size_t *)(param_1 + 0xe0));
          if (sVar9 != -1) goto LAB_00106651;
          puVar5 = (uint *)__errno_location();
          if (param_2 == 0) {
            FUN_00112ce0(param_1,(ulong)*puVar5,"cannot read `%s\'","/dev/stdin");
          }
          else {
            FUN_00112ce0(param_1,(ulong)*puVar5,"cannot read fd %d",uVar7);
          }
LAB_001067ec:
          free(__ptr);
          if (param_2 == 0xffffffff) goto LAB_00106768;
          iVar1 = -1;
        }
        if (local_100 != -1) {
          lseek(param_2,local_100,0);
        }
        if (iVar1 != 0) goto LAB_00106768;
      }
      else {
        free(__ptr);
      }
LAB_001066e1:
      uVar4 = FUN_001136d0(param_1);
      goto LAB_001066e9;
    }
    free(__ptr);
  }
LAB_00106768:
  uVar4 = 0;
LAB_001066e9:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar4;
}



// WARNING: Removing unreachable block (ram,0x00106728)
// WARNING: Removing unreachable block (ram,0x0010672d)
// WARNING: Removing unreachable block (ram,0x001069a6)
// WARNING: Removing unreachable block (ram,0x00106748)
/*
undefined8 magic_file(long param_1,char *param_2)

{
  int iVar1;
  uint __fd;
  int iVar2;
  void *__ptr;
  long lVar3;
  undefined8 uVar4;
  uint *puVar5;
  ulong uVar6;
  char *pcVar7;
  size_t __nbytes;
  ulong uVar8;
  uint uVar9;
  int __fd_00;
  undefined8 *puVar10;
  ssize_t sVar11;
  long in_FS_OFFSET;
  bool bVar12;
  byte bVar13;
  uint *puStack256;
  __time_t _Stack248;
  undefined4 uStack240;
  undefined4 uStack236;
  __time_t _Stack232;
  undefined8 uStack224;
  stat sStack216;
  long lStack64;
  
  bVar13 = 0;
  if (param_1 == 0) {
    return 0;
  }
  uVar8 = 0;
  __fd_00 = 0;
  lStack64 = *(long *)(in_FS_OFFSET + 0x28);
  iVar1 = FUN_00113670(0);
  if ((iVar1 != -1) && (__ptr = malloc(*(long *)(param_1 + 0xe0) + 0x61), __ptr != (void *)0x0)) {
    iVar1 = FUN_00112530(param_1,param_2,&sStack216);
    if (iVar1 != -1) {
      if (iVar1 == 0) {
        if (param_2 == (char *)0x0) {
          iVar2 = __fxstat(1,0,&sStack216);
          if ((iVar2 != 0) || ((sStack216.st_mode & 0xf000) != 0x1000)) {
            puStack256 = (uint *)lseek(0,0,1);
            sVar11 = read(0,__ptr,*(size_t *)(param_1 + 0xe0));
            if (sVar11 != -1) goto LAB_00106651;
            puVar5 = (uint *)__errno_location();
            __fd = *puVar5;
            pcVar7 = "/dev/stdin";
LAB_001067db:
            FUN_00112ce0(param_1,(ulong)__fd,"cannot read `%s\'",pcVar7);
LAB_001067ec:
            free(__ptr);
            if (__fd_00 == -1) goto LAB_00106768;
            iVar2 = -1;
LAB_001066a3:
            if (puStack256 != (uint *)0xffffffffffffffff) {
              lseek(__fd_00,(__off_t)puStack256,0);
            }
            goto LAB_001066b7;
          }
          __nbytes = *(size_t *)(param_1 + 0xe0);
LAB_0010660b:
          __fd_00 = (int)uVar8;
          sVar11 = 0;
          while ((lVar3 = FUN_00110380(uVar8,(long)__ptr + sVar11,__nbytes - sVar11,0), 0 < lVar3 &&
                 (sVar11 = sVar11 + lVar3, 0xfff < lVar3))) {
            __nbytes = *(size_t *)(param_1 + 0xe0);
          }
          if ((sVar11 != 0) || (param_2 == (char *)0x0)) {
            puStack256 = (uint *)0xffffffffffffffff;
LAB_00106651:
            __fd_00 = (int)uVar8;
            puVar10 = (undefined8 *)((long)__ptr + sVar11);
            *puVar10 = 0;
            *(undefined8 *)((long)puVar10 + 0x59) = 0;
            uVar6 = (ulong)(((int)puVar10 -
                            (int)(undefined8 *)((ulong)(puVar10 + 1) & 0xfffffffffffffff8)) + 0x61U
                           >> 3);
            puVar10 = (undefined8 *)((ulong)(puVar10 + 1) & 0xfffffffffffffff8);
            while (uVar6 != 0) {
              uVar6 = uVar6 - 1;
              *puVar10 = 0;
              puVar10 = puVar10 + (ulong)bVar13 * 0x1ffffffffffffffe + 1;
            }
            iVar2 = FUN_00113170(param_1,uVar8,param_2,__ptr,sVar11);
            if (iVar2 != -1) goto LAB_00106696;
            goto LAB_001067ec;
          }
          iVar1 = FUN_00106440(param_1,(ulong)sStack216.st_mode,param_2);
          iVar2 = -(uint)(iVar1 == -1);
          free(__ptr);
          if (__fd_00 != -1) goto LAB_001066b7;
        }
        else {
          __fd = __xstat(1,param_2,&sStack216);
          if (__fd == 0) {
            bVar12 = (sStack216.st_mode & 0xf000) == 0x1000;
            uVar9 = 0x800;
            if (!bVar12) {
              uVar9 = __fd;
            }
            puStack256 = (uint *)__errno_location();
            *puStack256 = 0;
            __fd = __open_2(param_2,(ulong)uVar9);
            uVar8 = (ulong)__fd;
            if (-1 < (int)__fd) {
              __fd = fcntl(__fd,3);
              if (__fd != 0xffffffff) {
LAB_001068aa:
                fcntl((int)uVar8,4,(ulong)(__fd & 0xfffff7ff));
              }
              __nbytes = *(size_t *)(param_1 + 0xe0);
              if (bVar12) goto LAB_0010660b;
              goto LAB_00106947;
            }
            iVar1 = FUN_00106440(param_1,(ulong)sStack216.st_mode,param_2);
            if (iVar1 != -1) goto LAB_00106833;
            free(__ptr);
            if (__fd == 0xffffffff) {
              uVar4 = 0;
              goto LAB_001066e9;
            }
            iVar2 = -1;
            close(__fd);
            if ((*(byte *)(param_1 + 0x38) & 0x80) == 0) goto LAB_00106768;
          }
          else {
            puStack256 = (uint *)__errno_location();
            *puStack256 = 0;
            __fd = __open_2(param_2,0);
            uVar8 = (ulong)__fd;
            if ((int)__fd < 0) {
LAB_00106833:
              free(__ptr);
              if (__fd != 0xffffffff) {
                iVar2 = 0;
                close(__fd);
                if ((*(byte *)(param_1 + 0x38) & 0x80) != 0) goto LAB_00106855;
              }
              goto LAB_001066e1;
            }
            __fd = fcntl(__fd,3);
            if (__fd != 0xffffffff) {
              bVar12 = false;
              goto LAB_001068aa;
            }
            __nbytes = *(size_t *)(param_1 + 0xe0);
LAB_00106947:
            __fd_00 = (int)uVar8;
            sVar11 = read(__fd_00,__ptr,__nbytes);
            if (sVar11 == -1) {
              __fd = *puStack256;
              pcVar7 = param_2;
              puStack256 = (uint *)sVar11;
              goto LAB_001067db;
            }
            puVar10 = (undefined8 *)((long)__ptr + sVar11);
            *puVar10 = 0;
            *(undefined8 *)((long)puVar10 + 0x59) = 0;
            uVar6 = (ulong)(((int)puVar10 -
                            (int)(undefined8 *)((ulong)(puVar10 + 1) & 0xfffffffffffffff8)) + 0x61U
                           >> 3);
            puVar10 = (undefined8 *)((ulong)(puVar10 + 1) & 0xfffffffffffffff8);
            while (uVar6 != 0) {
              uVar6 = uVar6 - 1;
              *puVar10 = 0;
              puVar10 = puVar10 + (ulong)bVar13 * 0x1ffffffffffffffe + 1;
            }
            iVar2 = FUN_00113170(param_1,uVar8,param_2,__ptr,0);
            if (iVar2 != -1) {
              puStack256 = (uint *)0xffffffffffffffff;
LAB_00106696:
              free(__ptr);
              iVar2 = iVar1;
              if (__fd_00 == -1) goto LAB_001066e1;
              goto LAB_001066a3;
            }
            free(__ptr);
LAB_001066b7:
            if (((__fd_00 == 0) || (param_2 == (char *)0x0)) ||
               (close(__fd_00), (*(byte *)(param_1 + 0x38) & 0x80) == 0)) goto LAB_001066d8;
          }
LAB_00106855:
          _Stack248 = sStack216.st_atim.tv_sec;
          uStack240 = 0;
          uStack236 = 0;
          uStack224 = 0;
          _Stack232 = sStack216.st_mtim.tv_sec;
          utimes(param_2,(timeval *)&_Stack248);
        }
LAB_001066d8:
        if (iVar2 != 0) goto LAB_00106768;
      }
      else {
        free(__ptr);
      }
LAB_001066e1:
      uVar4 = FUN_001136d0(param_1);
      goto LAB_001066e9;
    }
    free(__ptr);
  }
LAB_00106768:
  uVar4 = 0;
LAB_001066e9:
  if (lStack64 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar4;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}
*/



undefined8 magic_buffer(long param_1,undefined8 param_2,undefined8 param_3)

{
  int iVar1;
  undefined8 uVar2;
  
  if (param_1 == 0) {
    return 0;
  }
  iVar1 = FUN_00113670(0);
  if (iVar1 != -1) {
    iVar1 = FUN_00113170(param_1,0xffffffff,0,param_2,param_3);
    if (iVar1 != -1) {
      uVar2 = FUN_001136d0(param_1);
      return uVar2;
    }
  }
  return 0;
}



char * magic_error(long param_1)

{
  char *pcVar1;
  
  pcVar1 = "Magic database is not open";
  if (param_1 != 0) {
    if ((*(byte *)(param_1 + 0x3c) & 1) != 0) {
      return (char *)*(undefined8 *)(param_1 + 0x20);
    }
    pcVar1 = (char *)0x0;
  }
  return pcVar1;
}



ulong magic_errno(long param_1)

{
  uint uVar1;
  ulong uVar2;
  
  if (param_1 == 0) {
    uVar2 = 0x16;
  }
  else {
    uVar1 = *(uint *)(param_1 + 0x3c) & 1;
    uVar2 = (ulong)uVar1;
    if (uVar1 != 0) {
      return (ulong)*(uint *)(param_1 + 0x34);
    }
  }
  return uVar2;
}


/*
undefined8 magic_setflags(long param_1,undefined4 param_2)

{
  if (param_1 != 0) {
    *(undefined4 *)(param_1 + 0x38) = param_2;
    return 0;
  }
  return 0xffffffff;
}
*/



undefined8 magic_version(void)

{
  return 0x210;
}



ulong magic_setparam(long param_1,uint param_2,undefined8 *param_3)

{
  int *piVar1;
  
  switch(param_2) {
  case 0:
    *(undefined2 *)(param_1 + 0xd0) = (short)*param_3;
    return (ulong)param_2;
  case 1:
    *(undefined2 *)(param_1 + 0xd2) = (short)*param_3;
    return 0;
  case 2:
    *(undefined2 *)(param_1 + 0xd6) = (short)*param_3;
    return 0;
  case 3:
    *(undefined2 *)(param_1 + 0xd4) = (short)*param_3;
    return 0;
  case 4:
  case 5:
    *(undefined2 *)(param_1 + 0xd8) = (short)*param_3;
    return 0;
  case 6:
    *(undefined8 *)(param_1 + 0xe0) = *param_3;
    return 0;
  default:
    piVar1 = __errno_location();
    *piVar1 = 0x16;
    return 0xffffffff;
  }
}



ulong magic_getparam(long param_1,uint param_2,ulong *param_3)

{
  int *piVar1;
  
  switch(param_2) {
  case 0:
    *param_3 = (ulong)*(ushort *)(param_1 + 0xd0);
    return (ulong)param_2;
  case 1:
    *param_3 = (ulong)*(ushort *)(param_1 + 0xd2);
    return 0;
  case 2:
    *param_3 = (ulong)*(ushort *)(param_1 + 0xd6);
    return 0;
  case 3:
    *param_3 = (ulong)*(ushort *)(param_1 + 0xd4);
    return 0;
  case 4:
    *param_3 = (ulong)*(ushort *)(param_1 + 0xd8);
    return 0;
  case 5:
    *param_3 = (ulong)*(ushort *)(param_1 + 0xda);
    return 0;
  case 6:
    *param_3 = *(ulong *)(param_1 + 0xe0);
    return 0;
  default:
    piVar1 = __errno_location();
    *piVar1 = 0x16;
    return 0xffffffff;
  }
}



undefined8 FUN_00106f30(char param_1)

{
  undefined8 uVar1;
  
  if (param_1 == '+') {
    return 3;
  }
  if (param_1 < ',') {
    uVar1 = 0;
    if ((param_1 != '&') && (uVar1 = 5, param_1 != '*')) {
      if (param_1 != '%') {
        return 0xffffffff;
      }
      return 7;
    }
  }
  else {
    uVar1 = 6;
    if (param_1 != '/') {
      if (param_1 < '0') {
        if (param_1 == '-') {
          return 4;
        }
      }
      else {
        if (param_1 == '^') {
          return 2;
        }
        if (param_1 == '|') {
          return 1;
        }
      }
      return 0xffffffff;
    }
  }
  return uVar1;
}



void FUN_00106fb0(void **param_1)

{
  int iVar1;
  void *__ptr;
  void *__ptr_00;
  
  if (param_1 == (void **)0x0) {
    return;
  }
  iVar1 = *(int *)(param_1 + 2);
  if (iVar1 == 1) {
    __ptr = param_1[3];
    __ptr_00 = *param_1;
    if ((__ptr < __ptr_00) || ((void *)((long)param_1[1] + (long)__ptr_00) < __ptr)) {
      free(__ptr);
      __ptr_00 = *param_1;
    }
    __ptr = param_1[4];
    if ((__ptr < __ptr_00) || ((void *)((long)param_1[1] + (long)__ptr_00) < __ptr)) {
      free(__ptr);
      __ptr_00 = *param_1;
    }
    free(__ptr_00);
  }
  else {
    if (iVar1 == 2) {
      if ((long)*param_1 - 1U < 0xfffffffffffffffe) {
        munmap(*param_1,(size_t)param_1[1]);
      }
    }
    else {
      if (iVar1 != 0) {
                    // WARNING: Subroutine does not return
        abort();
      }
    }
  }
  free(param_1);
  return;
}



void FUN_00107040(void *param_1)

{
  void *pvVar1;
  void *__ptr;
  bool bVar2;
  
  if (param_1 == (void *)0x0) {
    return;
  }
  __ptr = *(void **)((long)param_1 + 0x18);
  do {
    pvVar1 = *(void **)((long)__ptr + 0x18);
    if (pvVar1 == (void *)0x0) {
      return;
    }
    if (*(long *)((long)__ptr + 0x10) != 0) {
      FUN_00106fb0(0);
    }
    free(__ptr);
    bVar2 = __ptr != param_1;
    __ptr = pvVar1;
  } while (bVar2);
  return;
}



undefined8 FUN_00107090(long param_1,long param_2,long param_3)

{
  undefined8 *puVar1;
  undefined8 uVar2;
  long lVar3;
  
  *(undefined8 *)(param_1 + 0x10) = 0;
  puVar1 = (undefined8 *)malloc(0x28);
  if (puVar1 == (undefined8 *)0x0) {
    uVar2 = 0xffffffff;
  }
  else {
    lVar3 = 0;
    if (param_3 == 0) {
      lVar3 = param_2;
    }
    puVar1[2] = lVar3;
    *puVar1 = *(undefined8 *)(param_2 + 0x18 + param_3 * 8);
    *(undefined4 *)(puVar1 + 1) = *(undefined4 *)(param_2 + 0x28 + param_3 * 4);
    lVar3 = *(long *)(param_1 + 0x20);
    *(undefined8 **)(lVar3 + 0x18) = puVar1;
    puVar1[4] = lVar3;
    puVar1[3] = param_1;
    *(undefined8 **)(param_1 + 0x20) = puVar1;
    uVar2 = 0;
  }
  return uVar2;
}



undefined8 FUN_00107100(undefined8 param_1,uint **param_2,undefined8 param_3)

{
  uint uVar1;
  uint uVar2;
  long lVar3;
  int iVar4;
  bool bVar5;
  uint *puVar6;
  uint *puVar7;
  uint *puVar8;
  undefined8 uVar9;
  ulong uVar10;
  ulong uVar11;
  long lVar12;
  long lVar13;
  long in_FS_OFFSET;
  
  puVar8 = *param_2;
  lVar3 = *(long *)(in_FS_OFFSET + 0x28);
  uVar1 = *puVar8;
  if (uVar1 == 0xf11e041c) {
    uVar1 = puVar8[1];
    bVar5 = false;
  }
  else {
    if (CONCAT13((char)uVar1,
                 CONCAT12((char)((ulong)uVar1 >> 8),
                          CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18)))) != -0xee1fbe4) {
      FUN_00112ce0(param_1,0,"bad magic in `%s\'",param_3);
      uVar9 = 0xffffffff;
      goto LAB_00107467;
    }
    uVar1 = puVar8[1];
    bVar5 = true;
    uVar1 = CONCAT13((char)uVar1,
                     CONCAT12((char)((ulong)uVar1 >> 8),
                              CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18))));
  }
  if (uVar1 == 0xe) {
    puVar6 = param_2[1];
    uVar10 = (ulong)puVar6 / 0x158;
    if (puVar6 == (uint *)((uVar10 & 0xffffffff) * 0x158)) {
      puVar6 = puVar8 + 0x56;
      uVar1 = puVar8[2];
      param_2[3] = puVar6;
      if (bVar5) {
        uVar2 = CONCAT13((char)uVar1,
                         CONCAT12((char)((ulong)uVar1 >> 8),
                                  CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18))));
        uVar11 = (ulong)uVar2;
        *(uint *)(param_2 + 5) = uVar2;
        uVar1 = puVar8[3];
        param_2[4] = puVar6 + uVar11 * 0x56;
        iVar4 = CONCAT13((char)uVar1,
                         CONCAT12((char)((ulong)uVar1 >> 8),
                                  CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18))));
        *(int *)((long)param_2 + 0x2c) = iVar4;
        if (uVar2 + 1 + iVar4 == (int)uVar10) {
          lVar12 = 0;
          do {
            if ((int)uVar11 != 0) {
              puVar8 = puVar6;
              do {
                while( true ) {
                  *(ushort *)puVar8 =
                       CONCAT11((char)*(ushort *)puVar8,(char)((ulong)*(ushort *)puVar8 >> 8));
                  uVar1 = puVar8[3];
                  puVar8[3] = CONCAT13((char)uVar1,
                                       CONCAT12((char)((ulong)uVar1 >> 8),
                                                CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18)
                                                        )));
                  uVar1 = puVar8[4];
                  puVar8[4] = CONCAT13((char)uVar1,
                                       CONCAT12((char)((ulong)uVar1 >> 8),
                                                CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18)
                                                        )));
                  uVar1 = puVar8[5];
                  puVar8[5] = CONCAT13((char)uVar1,
                                       CONCAT12((char)((ulong)uVar1 >> 8),
                                                CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18)
                                                        )));
                  if ((*(byte *)((long)puVar8 + 6) < 0x2f) &&
                     (((ulong)puVar8 >> ((ulong)*(byte *)((long)puVar8 + 6) & 0x1f) & 1) != 0))
                  break;
                  uVar9 = *(undefined8 *)(puVar8 + 8);
                  puVar7 = puVar8 + 0x56;
                  *(ulong *)(puVar8 + 8) =
                       CONCAT17((char)uVar9,
                                CONCAT16((char)((ulong)uVar9 >> 8),
                                         CONCAT15((char)((ulong)uVar9 >> 0x10),
                                                  CONCAT14((char)((ulong)uVar9 >> 0x18),
                                                           CONCAT13((char)((ulong)uVar9 >> 0x20),
                                                                    CONCAT12((char)((ulong)uVar9 >>
                                                                                   0x28),
                                                                             CONCAT11((char)((ulong)
                                                  uVar9 >> 0x30),(char)((ulong)uVar9 >> 0x38))))))))
                  ;
                  uVar9 = *(undefined8 *)(puVar8 + 6);
                  *(ulong *)(puVar8 + 6) =
                       CONCAT17((char)uVar9,
                                CONCAT16((char)((ulong)uVar9 >> 8),
                                         CONCAT15((char)((ulong)uVar9 >> 0x10),
                                                  CONCAT14((char)((ulong)uVar9 >> 0x18),
                                                           CONCAT13((char)((ulong)uVar9 >> 0x20),
                                                                    CONCAT12((char)((ulong)uVar9 >>
                                                                                   0x28),
                                                                             CONCAT11((char)((ulong)
                                                  uVar9 >> 0x30),(char)((ulong)uVar9 >> 0x38))))))))
                  ;
                  puVar8 = puVar7;
                  if (puVar6 + (ulong)((int)uVar11 - 1) * 0x56 + 0x56 == puVar7) goto LAB_0010741d;
                }
                uVar1 = puVar8[6];
                puVar7 = puVar8 + 0x56;
                puVar8[6] = CONCAT13((char)uVar1,
                                     CONCAT12((char)((ulong)uVar1 >> 8),
                                              CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18)))
                                    );
                uVar1 = puVar8[7];
                puVar8[7] = CONCAT13((char)uVar1,
                                     CONCAT12((char)((ulong)uVar1 >> 8),
                                              CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18)))
                                    );
                puVar8 = puVar7;
              } while (puVar6 + (ulong)((int)uVar11 - 1) * 0x56 + 0x56 != puVar7);
            }
LAB_0010741d:
            lVar13 = lVar12 + 4;
            if (lVar13 == 8) goto LAB_00107465;
            uVar11 = (ulong)*(uint *)((long)param_2 + lVar12 + 0x2c);
            puVar6 = *(uint **)((long)param_2 + lVar13 * 2 + 0x18);
            lVar12 = lVar13;
          } while( true );
        }
      }
      else {
        *(uint *)(param_2 + 5) = uVar1;
        param_2[4] = puVar6 + (ulong)uVar1 * 0x56;
        uVar2 = puVar8[3];
        *(uint *)((long)param_2 + 0x2c) = uVar2;
        if (uVar2 + 1 + uVar1 == (int)uVar10) {
LAB_00107465:
          uVar9 = 0;
          goto LAB_00107467;
        }
      }
      FUN_00112ce0(param_1,0,"Inconsistent entries in `%s\' %u != %u",param_3,uVar10 & 0xffffffff);
      uVar9 = 0xffffffff;
    }
    else {
      FUN_00112ce0(param_1,0,"Size of `%s\' %zu is not a multiple of %zu",param_3,puVar6,0x158);
      uVar9 = 0xffffffff;
    }
  }
  else {
    FUN_00112ce0(param_1,0,"File %s supports only version %d magic files. `%s\' is version %d",
                 &DAT_001183af,0xe,param_3,(ulong)uVar1);
    uVar9 = 0xffffffff;
  }
LAB_00107467:
  if (lVar3 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar9;
}



undefined8 FUN_00107530(undefined8 param_1,long *param_2,long param_3)

{
  undefined auVar1 [16];
  uint uVar2;
  void *__ptr;
  void **ppvVar3;
  long lVar4;
  undefined8 *puVar5;
  byte bVar6;
  
  bVar6 = 0;
  ppvVar3 = (void **)((ulong)(*(char *)(*param_2 + 6) == '-') * 0x10 + param_3);
  uVar2 = *(uint *)(ppvVar3 + 1);
  __ptr = *ppvVar3;
  if (uVar2 == *(uint *)((long)ppvVar3 + 0xc)) {
    *(uint *)((long)ppvVar3 + 0xc) = uVar2 + 200;
    __ptr = realloc(__ptr,(ulong)(uVar2 + 200) << 4);
    if (__ptr == (void *)0x0) {
      FUN_00113100(param_1,(ulong)*(uint *)((long)ppvVar3 + 0xc) << 4);
      return 0xffffffff;
    }
    lVar4 = 400;
    puVar5 = (undefined8 *)((ulong)*(uint *)(ppvVar3 + 1) * 0x10 + (long)__ptr);
    while (lVar4 != 0) {
      lVar4 = lVar4 + -1;
      *puVar5 = 0;
      puVar5 = puVar5 + (ulong)bVar6 * 0x1ffffffffffffffe + 1;
    }
    *ppvVar3 = __ptr;
    uVar2 = *(uint *)(ppvVar3 + 1);
  }
                    // WARNING: Load size is inaccurate
  auVar1[0] = *(undefined *)param_2;
  lVar4 = (ulong)uVar2 * 0x10;
  *(uint *)(ppvVar3 + 1) = uVar2 + 1;
  *(undefined4 *)((long)__ptr + lVar4) = SUB164(auVar1[0],0);
  *(undefined4 *)((long)__ptr + lVar4 + 4) = SUB164(auVar1[0] >> 0x20,0);
  *(undefined4 *)((long)__ptr + lVar4 + 8) = SUB164(auVar1[0] >> 0x40,0);
  *(undefined4 *)((long)__ptr + lVar4 + 0xc) = SUB164(auVar1[0] >> 0x60,0);
  *(undefined4 *)param_2 = 0;
  *(undefined4 *)((long)param_2 + 4) = 0;
  *(undefined4 *)(param_2 + 1) = 0;
  *(undefined4 *)((long)param_2 + 0xc) = 0;
  return 0;
}



long FUN_001075f0(long param_1)

{
  byte bVar1;
  char cVar2;
  int iVar3;
  long lVar4;
  ulong uVar5;
  char *pcVar6;
  
  bVar1 = *(byte *)(param_1 + 6);
  switch(bVar1) {
  default:
    pcVar6 = "Bad type %d\n";
    goto LAB_00107651;
  case 2:
  case 7:
  case 10:
    lVar4 = 0x28;
    break;
  case 3:
    if (*(char *)(param_1 + 0xb) == '\0') {
      return 0;
    }
    goto switchD_00107867_caseD_1;
  case 4:
  case 6:
  case 8:
  case 9:
  case 0xb:
  case 0xc:
  case 0xe:
  case 0xf:
  case 0x10:
  case 0x15:
  case 0x16:
  case 0x17:
  case 0x21:
  case 0x22:
  case 0x23:
    bVar1 = *(byte *)(param_1 + 4);
    lVar4 = 0x3c;
    goto joined_r0x0010767c;
  case 5:
  case 0xd:
    lVar4 = (long)(int)(((uint)*(byte *)(param_1 + 5) + (uint)*(byte *)(param_1 + 5) * 4) * 2) +
            0x14;
    break;
  case 0x11:
    cVar2 = *(char *)(param_1 + 0x20);
    pcVar6 = (char *)(param_1 + 0x20);
    if (cVar2 != '\0') {
      uVar5 = 0;
LAB_001076c0:
      switch(cVar2) {
      default:
        uVar5 = uVar5 + 1;
        goto switchD_001076d1_caseD_24;
      case '[':
        cVar2 = *pcVar6;
        if ((cVar2 != ']') && (cVar2 != '\0')) {
          do {
            pcVar6 = pcVar6 + 1;
            cVar2 = *pcVar6;
            if (cVar2 == '\0') break;
          } while (cVar2 != ']');
        }
        break;
      case '\\':
        if (pcVar6[1] == '\0') {
          uVar5 = uVar5 + 1;
          goto LAB_001076e8;
        }
        cVar2 = pcVar6[2];
        uVar5 = uVar5 + 1;
        pcVar6 = pcVar6 + 2;
        break;
      case '{':
        cVar2 = *pcVar6;
        if ((cVar2 != '}') && (cVar2 != '\0')) {
          do {
            pcVar6 = pcVar6 + 1;
            cVar2 = *pcVar6;
            if (cVar2 == '\0') break;
          } while (cVar2 != '}');
        }
        if (cVar2 != '\0') goto switchD_001076d1_caseD_24;
        cVar2 = *pcVar6;
        break;
      case '$':
      case '*':
      case '+':
      case '.':
      case '?':
      case '^':
        goto switchD_001076d1_caseD_24;
      }
      goto LAB_001076e4;
    }
  case 1:
  case 0x30:
    lVar4 = 0x1e;
    break;
  case 0x12:
  case 0x13:
    lVar4 = (long)(int)((uint)*(byte *)(param_1 + 5) + (uint)*(byte *)(param_1 + 5) * 4) + 0x14;
    break;
  case 0x14:
    iVar3 = 10 / (int)(uint)*(byte *)(param_1 + 5);
    if (iVar3 < 1) {
      iVar3 = 1;
    }
    lVar4 = (long)(int)(iVar3 * (uint)*(byte *)(param_1 + 5)) + 0x14;
    break;
  case 0x18:
  case 0x19:
  case 0x1a:
  case 0x1b:
  case 0x1c:
  case 0x1d:
  case 0x1e:
  case 0x1f:
  case 0x20:
  case 0x24:
  case 0x25:
  case 0x26:
  case 0x2a:
  case 0x2b:
  case 0x2c:
    lVar4 = 100;
    break;
  case 0x29:
  case 0x2d:
  case 0x2e:
    lVar4 = 0x14;
  }
LAB_0010761d:
  bVar1 = *(byte *)(param_1 + 4);
joined_r0x0010767c:
  if (bVar1 == 0x3d) {
    uVar5 = lVar4 + 10;
LAB_0010783f:
    if (uVar5 == 0) {
      uVar5 = 1;
    }
  }
  else {
    if (bVar1 < 0x3e) {
      if (bVar1 == 0x26) {
LAB_001078e0:
        uVar5 = lVar4 - 10;
        goto LAB_0010783f;
      }
      if (bVar1 == 0x3c) {
LAB_0010783b:
        uVar5 = lVar4 - 0x14;
        goto LAB_0010783f;
      }
      if (bVar1 != 0x21) {
LAB_00107647:
        pcVar6 = "Bad relation %c\n";
LAB_00107651:
        fprintf(stderr,1,pcVar6,(ulong)bVar1);
        goto switchD_00107867_caseD_1;
      }
    }
    else {
      if (bVar1 == 0x5e) goto LAB_001078e0;
      if (bVar1 != 0x78) {
        if (bVar1 != 0x3e) goto LAB_00107647;
        goto LAB_0010783b;
      }
    }
    uVar5 = 1;
  }
  switch(*(undefined *)(param_1 + 0xb)) {
  default:
switchD_00107867_caseD_1:
                    // WARNING: Subroutine does not return
    abort();
  case 0x2a:
    uVar5 = uVar5 * *(byte *)(param_1 + 3);
  case 0:
    lVar4 = uVar5 + (*(char *)(param_1 + 0x80) == '\0');
    break;
  case 0x2b:
    lVar4 = uVar5 + *(byte *)(param_1 + 3) + (ulong)(*(char *)(param_1 + 0x80) == '\0');
    break;
  case 0x2d:
    lVar4 = (uVar5 - *(byte *)(param_1 + 3)) + (ulong)(*(char *)(param_1 + 0x80) == '\0');
    break;
  case 0x2f:
    lVar4 = uVar5 / *(byte *)(param_1 + 3) + (ulong)(*(char *)(param_1 + 0x80) == '\0');
  }
  return lVar4;
switchD_001076d1_caseD_24:
  cVar2 = pcVar6[1];
  pcVar6 = pcVar6 + 1;
LAB_001076e4:
  if (cVar2 == '\0') goto LAB_001076e8;
  goto LAB_001076c0;
LAB_001076e8:
  lVar4 = 0x1e;
  if (uVar5 != 0) {
    lVar4 = SUB168((ZEXT816(0) << 0x40 | ZEXT816(10)) / ZEXT816(uVar5),0);
    if (lVar4 == 0) {
      lVar4 = 1;
    }
    lVar4 = lVar4 * uVar5 + 0x14;
  }
  goto LAB_0010761d;
}



ulong FUN_00107960(ulong param_1,char *param_2)

{
  ushort **ppuVar1;
  char *pcVar2;
  
  if (((param_1 & 0x80) == 0) &&
     (ppuVar1 = __ctype_b_loc(), (*(byte *)(*ppuVar1 + (param_1 & 0xff)) & 8) != 0)) {
    return 1;
  }
  pcVar2 = strchr(param_2,(uint)param_1 & 0xff);
  return (ulong)(pcVar2 != (char *)0x0);
}



undefined8 FUN_001079a0(long param_1,long *param_2)

{
  byte bVar1;
  ushort uVar2;
  ushort **ppuVar3;
  undefined8 uVar4;
  
  ppuVar3 = __ctype_b_loc();
  bVar1 = *(byte *)(param_1 + 1);
  uVar2 = (*ppuVar3)[bVar1];
  if ((uVar2 & 0x400) == 0) {
    if ((uVar2 & 0x800) == 0) {
      param_1 = param_1 + 1;
      uVar4 = 4;
      goto LAB_001079ee;
    }
    if ((*(byte *)((long)*ppuVar3 + (ulong)*(byte *)(param_1 + 2) * 2 + 1) & 8) != 0) {
      return 0;
    }
    if (bVar1 == 0x32) goto switchD_001079dd_caseD_53;
    if ((char)bVar1 < '3') {
      uVar4 = 1;
      if (bVar1 != 0x31) {
        return 0;
      }
    }
    else {
      if (bVar1 == 0x34) goto switchD_001079dd_caseD_49;
      uVar4 = 0x18;
      if (bVar1 != 0x38) {
        return 0;
      }
    }
  }
  else {
    switch(bVar1) {
    case 0x43:
      uVar4 = 1;
      break;
    default:
      return 0;
    case 0x49:
    case 0x4c:
switchD_001079dd_caseD_49:
      uVar4 = 4;
      break;
    case 0x51:
      uVar4 = 0x18;
      break;
    case 0x53:
switchD_001079dd_caseD_53:
      uVar4 = 2;
    }
  }
  param_1 = param_1 + 2;
LAB_001079ee:
  *param_2 = param_1;
  return uVar4;
}



ulong FUN_00107c70(char *param_1,char *param_2,char **param_3)

{
  size_t __n;
  int iVar1;
  
  __n = *(size_t *)(param_1 + 0x10);
  do {
    if (__n == 0) {
LAB_00107cb6:
      return (ulong)*(uint *)(param_1 + 0x18);
    }
    iVar1 = strncmp(param_2,param_1,__n);
    if (iVar1 == 0) {
      *param_3 = param_2 + __n;
      goto LAB_00107cb6;
    }
    __n = *(size_t *)(param_1 + 0x30);
    param_1 = param_1 + 0x20;
  } while( true );
}



void FUN_00107cd0(byte **param_1)

{
  ushort *puVar1;
  ushort **ppuVar2;
  __int32_t **pp_Var3;
  byte bVar4;
  ulong uVar5;
  byte *pbVar6;
  
  pbVar6 = *param_1;
  ppuVar2 = __ctype_b_loc();
  bVar4 = *pbVar6;
  uVar5 = (ulong)bVar4;
  puVar1 = *ppuVar2;
  if ((*(byte *)((long)puVar1 + uVar5 * 2 + 1) & 1) == 0) {
    if (bVar4 == 0x75) goto LAB_00107d00;
LAB_00107d58:
    _bVar4 = (__int32_t)(char)bVar4;
  }
  else {
    pp_Var3 = __ctype_tolower_loc();
    if ((*pp_Var3)[uVar5] == 0x75) {
LAB_00107d00:
      bVar4 = pbVar6[1];
      uVar5 = (ulong)bVar4;
      pbVar6 = pbVar6 + 1;
      if ((*(byte *)((long)puVar1 + uVar5 * 2 + 1) & 1) == 0) goto LAB_00107d58;
    }
    pp_Var3 = __ctype_tolower_loc();
    _bVar4 = (*pp_Var3)[uVar5];
  }
  if (_bVar4 - 0x62U < 0x12) {
    pbVar6 = pbVar6 + ((1 << ((byte)(_bVar4 - 0x62U) & 0x3f) & 0x20443U) != 0);
  }
  *param_1 = pbVar6;
  return;
}



void FUN_00107d70(long *param_1,uint param_2)

{
  long lVar1;
  long *plVar2;
  ulong uVar3;
  short *psVar4;
  undefined8 uVar5;
  uint uVar6;
  uint uVar7;
  ulong uVar8;
  long lVar9;
  ulong uVar10;
  
  plVar2 = (long *)param_1[3];
  do {
    if (param_1 == plVar2) {
      return;
    }
    uVar6 = *(uint *)(plVar2 + 1);
    uVar10 = 0;
    if (uVar6 != 0) {
      do {
        while( true ) {
          lVar1 = *plVar2;
          uVar3 = (ulong)((int)uVar10 + 1);
          if ((*(byte *)(uVar10 * 0x158 + lVar1 + 2) & param_2) == param_2) break;
          psVar4 = (short *)(uVar3 * 0x158 + lVar1);
          while ((uVar7 = (uint)uVar3, uVar7 < uVar6 && (*psVar4 != 0))) {
            uVar3 = (ulong)(uVar7 + 1);
            psVar4 = psVar4 + 0xac;
          }
          uVar10 = uVar3;
          if (uVar6 <= uVar7) goto LAB_00107dfd;
        }
        psVar4 = (short *)(uVar3 * 0x158 + lVar1);
        uVar8 = uVar10;
        while( true ) {
          uVar10 = uVar3;
          lVar9 = uVar8 * 0x158 + lVar1;
          uVar7 = (uint)uVar10;
          if ((((uVar6 <= uVar7) || (*psVar4 == 0)) || (*(char *)(lVar9 + 0x80) != '\0')) ||
             (psVar4 = psVar4 + 0xac, *(char *)(lVar9 + 0xc0) != '\0')) break;
          uVar3 = (ulong)(uVar7 + 1);
          uVar8 = uVar10;
        }
        uVar6 = *(uint *)(lVar9 + 0x14);
        uVar5 = FUN_001075f0(0);
        __printf_chk(1,"Strength = %3zu@%u: %s [%s]\n",uVar5,(ulong)uVar6,lVar9 + 0x80,lVar9 + 0xc0)
        ;
        uVar6 = *(uint *)(plVar2 + 1);
      } while (uVar7 < uVar6);
    }
LAB_00107dfd:
    plVar2 = (long *)plVar2[3];
  } while( true );
}



void FUN_00107ea0(void)

{
  long lVar1;
  long lVar2;
  char *pcVar3;
  undefined4 uVar4;
  
  lVar1 = (long)DAT_003204f4;
  if (DAT_003204f4 != 0) {
    return;
  }
  uVar4 = 0;
  DAT_003204f4 = 1;
  lVar2 = 4;
  pcVar3 = "invalid";
  while( true ) {
    *(char **)(&DAT_003205e0 + lVar1 * 8) = pcVar3;
    *(undefined4 *)(&DAT_00320500 + lVar1 * 4) = uVar4;
    if (lVar2 == 0) break;
    lVar1 = (long)*(int *)(pcVar3 + 0x38);
    if (0x30 < *(int *)(pcVar3 + 0x38)) {
                    // WARNING: Subroutine does not return
      __assert_fail("p->type < FILE_NAMES_SIZE","apprentice.c",399,"init_file_tables");
    }
    uVar4 = *(undefined4 *)(pcVar3 + 0x3c);
    lVar2 = *(long *)(pcVar3 + 0x50);
    pcVar3 = pcVar3 + 0x20;
  }
  if (pcVar3 + 0x20 == "") {
    return;
  }
                    // WARNING: Subroutine does not return
  __assert_fail("p - type_tbl == FILE_NAMES_SIZE","apprentice.c",0x193,"init_file_tables");
}



char * FUN_00107f60(uint *param_1,char *param_2,int param_3)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  char *pcVar4;
  long in_FS_OFFSET;
  char *local_38;
  long local_30;
  
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  if (param_3 != 0) {
    pcVar3 = strrchr(param_2,0x2f);
    if (pcVar3 != (char *)0x0) {
      param_2 = pcVar3 + 1;
    }
  }
  pcVar3 = param_2;
  if (*param_2 != '\0') {
    do {
      pcVar3 = pcVar3 + 1;
    } while (*pcVar3 != '\0');
    if (pcVar3 < param_2) goto LAB_00107fd9;
  }
  pcVar4 = "c";
  pcVar3 = pcVar3 + -1;
  do {
    cVar1 = *pcVar3;
    if (pcVar3 < param_2) goto joined_r0x001080d2;
    if (*pcVar4 != cVar1) {
      if ("" < pcVar4) goto joined_r0x001080d2;
      break;
    }
    pcVar4 = pcVar4 + -1;
    pcVar3 = pcVar3 + -1;
  } while ("" < pcVar4);
LAB_00107fd9:
  if ((*param_1 & 0x410) == 0) {
LAB_00108068:
    iVar2 = asprintf(&local_38,1,"%.*s%s",(ulong)(pcVar3 + (1 - (long)param_2)) & 0xffffffff,
                           param_2,&DAT_00119671);
    if (iVar2 < 0) {
LAB_001080f0:
      local_38 = (char *)0x0;
      goto LAB_00108033;
    }
    pcVar3 = strstr(param_2,".mime");
    if (pcVar3 == (char *)0x0) goto LAB_00108033;
  }
  else {
    iVar2 = asprintf(&local_38,1,"%.*s.mime%s",
                           (ulong)(pcVar3 + (1 - (long)param_2)) & 0xffffffff,param_2,&DAT_00119671)
    ;
    if (iVar2 < 0) goto LAB_001080f0;
    iVar2 = access(local_38,4);
    if (iVar2 == -1) {
      free(local_38);
      goto LAB_00108068;
    }
  }
  *param_1 = *param_1 & 0x10;
LAB_00108033:
  if (local_30 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return local_38;
joined_r0x001080d2:
  while (cVar1 != '\0') {
    pcVar3 = pcVar3 + 1;
    cVar1 = *pcVar3;
  }
  goto LAB_00107fd9;
}



ulong FUN_00108100(long param_1,long param_2,undefined8 param_3)

{
  uint __fd;
  char *__file;
  ssize_t sVar1;
  size_t sVar2;
  uint *puVar3;
  long lVar4;
  undefined8 *puVar5;
  size_t __n;
  long in_FS_OFFSET;
  byte bVar6;
  undefined8 local_188;
  undefined8 local_180;
  long local_30;
  
  bVar6 = 0;
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  __file = (char *)FUN_00107f60(param_1 + 0x38,param_3,1);
  if (__file == (char *)0x0) {
    __fd = 0xffffffff;
  }
  else {
    __fd = open(__file,0x241,0x1a4);
    if (__fd == 0xffffffff) {
      puVar3 = (uint *)__errno_location();
      FUN_00112ce0(param_1,(ulong)*puVar3,"cannot open `%s\'",__file);
    }
    else {
      lVar4 = 0x2b;
      puVar5 = &local_188;
      while (lVar4 != 0) {
        lVar4 = lVar4 + -1;
        *puVar5 = 0;
        puVar5 = puVar5 + (ulong)bVar6 * 0x1ffffffffffffffe + 1;
      }
      local_188 = 0xef11e041c;
      local_180 = *(undefined8 *)(param_2 + 0x28);
      sVar1 = write(__fd,&local_188,0x158);
      if (sVar1 == 0x158) {
        __n = (ulong)*(uint *)(param_2 + 0x28) * 0x158;
        sVar2 = write(__fd,*(void **)(param_2 + 0x18),__n);
        if (sVar2 == __n) {
          __n = (ulong)*(uint *)(param_2 + 0x2c) * 0x158;
          sVar2 = write(__fd,*(void **)(param_2 + 0x20),__n);
          if (sVar2 == __n) {
            close(__fd);
            __fd = 0;
            goto LAB_001081e8;
          }
        }
      }
      puVar3 = (uint *)__errno_location();
      __fd = 0xffffffff;
      FUN_00112ce0(param_1,(ulong)*puVar3,"error writing `%s\'",__file);
    }
  }
LAB_001081e8:
  FUN_00106fb0(param_2);
  free(__file);
  if (local_30 == *(long *)(in_FS_OFFSET + 0x28)) {
    return (ulong)__fd;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



ulong FUN_00108280(uint param_1)

{
  ushort **ppuVar1;
  ulong uVar2;
  
  if ((param_1 & 0x80) != 0) {
    return 0xffffffff;
  }
  ppuVar1 = __ctype_b_loc();
  if ((*(byte *)((long)*ppuVar1 + (ulong)(param_1 & 0xff) * 2 + 1) & 8) == 0) {
    if (5 < param_1 - 0x61) {
      if (param_1 - 0x41 < 6) {
        uVar2 = (ulong)(param_1 - 0x37);
      }
      else {
        uVar2 = 0xffffffff;
      }
      return uVar2;
    }
    return (ulong)(param_1 - 0x57);
  }
  return (ulong)(param_1 - 0x30);
}



undefined8
FUN_001082f0(long param_1,long param_2,int param_3,byte *param_4,long param_5,size_t param_6,
            undefined8 param_7,undefined8 param_8,int param_9)

{
  char *__s;
  int iVar1;
  ushort **ppuVar2;
  ulong uVar3;
  ulong uVar4;
  ulong uVar5;
  long lVar6;
  byte *pbVar7;
  ulong uVar8;
  byte bVar9;
  
  if (param_3 != 0) {
    param_2 = param_2 + (ulong)(param_3 - 1) * 0x158;
  }
  __s = (char *)(param_2 + param_5);
  if (*__s != '\0') {
    if (param_9 != 0) {
      param_6 = strlen(__s);
    }
    FUN_00111c10(param_1,"Current entry already has a %s type `%.*s\', new type `%s\'",param_7,
                 param_6 & 0xffffffff,__s,param_4);
    return 0xffffffff;
  }
  if (*(char *)(param_2 + 0x80) == '\0') {
    FUN_00111c10(param_1,"Current entry does not yet have a description for adding a %s type",
                 param_7);
    return 0xffffffff;
  }
  bVar9 = *param_4;
  uVar5 = (ulong)bVar9;
  uVar8 = (ulong)bVar9;
  pbVar7 = param_4;
  if ((bVar9 & 0x80) == 0) {
    ppuVar2 = __ctype_b_loc();
    do {
      if ((*(byte *)((long)*ppuVar2 + (ulong)bVar9 * 2 + 1) & 0x20) == 0) {
        bVar9 = *pbVar7;
        uVar5 = (ulong)bVar9;
        uVar8 = (ulong)bVar9;
        if (bVar9 == 0) {
          lVar6 = 0;
          uVar8 = 0;
          uVar4 = 0;
          goto LAB_001083a7;
        }
        break;
      }
      pbVar7 = pbVar7 + 1;
      bVar9 = *pbVar7;
      uVar5 = (ulong)bVar9;
      uVar8 = (ulong)bVar9;
    } while ((bVar9 & 0x80) == 0);
  }
  uVar3 = 0;
  do {
    iVar1 = FUN_00107960(uVar5,param_8);
    bVar9 = (byte)uVar8;
    if (iVar1 == 0) {
      uVar4 = uVar3;
      if (param_6 != uVar3) {
        lVar6 = uVar8 * 2;
LAB_001083a7:
        ppuVar2 = __ctype_b_loc();
        if (((*(ushort *)((long)*ppuVar2 + lVar6) & 0x2000) == 0) &&
           (iVar1 = FUN_00107960(uVar8,param_8), iVar1 == 0)) {
          FUN_00111c10(param_1,"%s type `%s\' has bad char \'%c\'",param_7,param_4,
                       (ulong)(uint)(int)(char)bVar9);
        }
        if (param_9 != 0) {
          __s[uVar4] = '\0';
        }
        if (uVar4 != 0) {
          return 0;
        }
        FUN_00112fc0(param_1,"Bad magic entry \'%s\'",param_4);
        return 0xffffffff;
      }
      break;
    }
    uVar4 = uVar3 + 1;
    __s[uVar3] = bVar9;
    bVar9 = pbVar7[uVar4];
    uVar5 = (ulong)bVar9;
    if (bVar9 == 0) {
      lVar6 = 0;
      uVar8 = 0;
      goto LAB_001083a7;
    }
    uVar3 = uVar4;
    uVar8 = uVar5;
  } while (uVar4 != param_6);
  if (param_9 != 0) {
    __s[uVar4 - 1] = '\0';
  }
  if ((*(byte *)(param_1 + 0x38) & 0x40) == 0) {
    return 0;
  }
  FUN_00111c10(param_1,"%s type `%s\' truncated %zu",param_7,param_4,uVar4);
  return 0;
}



void FUN_001085b0(undefined8 param_1,undefined8 *param_2,undefined8 param_3)

{
  FUN_001082f0(param_1,*param_2,(ulong)*(uint *)(param_2 + 1),param_3,0xc0,0x50,&DAT_001184e3,
               &DAT_001184de,1);
  return;
}



long FUN_001085f0(long param_1,long param_2,undefined8 param_3)

{
  switch(*(byte *)(param_2 + 6)) {
  default:
    param_3 = 0xffffffff;
    if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
      FUN_00111c10(param_1,"cannot happen: m->type=%d\n",(ulong)*(byte *)(param_2 + 6));
    }
    break;
  case 1:
    return (long)(char)param_3;
  case 2:
  case 7:
  case 10:
    return (long)(short)param_3;
  case 3:
  case 5:
  case 0xd:
  case 0x11:
  case 0x12:
  case 0x13:
  case 0x14:
  case 0x18:
  case 0x19:
  case 0x1a:
  case 0x1b:
  case 0x1c:
  case 0x1d:
  case 0x1e:
  case 0x1f:
  case 0x20:
  case 0x24:
  case 0x25:
  case 0x26:
  case 0x29:
  case 0x2a:
  case 0x2b:
  case 0x2c:
  case 0x2d:
  case 0x2e:
  case 0x2f:
  case 0x30:
    break;
  case 4:
  case 6:
  case 8:
  case 9:
  case 0xb:
  case 0xc:
  case 0xe:
  case 0xf:
  case 0x10:
  case 0x15:
  case 0x16:
  case 0x17:
  case 0x21:
  case 0x22:
  case 0x23:
    return (long)(int)param_3;
  }
  return param_3;
}



undefined8 * FUN_001086c0(uint param_1)

{
  int iVar1;
  undefined8 *__ptr;
  void *pvVar2;
  int *piVar3;
  
  __ptr = (undefined8 *)calloc(1,0xe8);
  if (__ptr == (undefined8 *)0x0) {
    return (undefined8 *)0;
  }
  iVar1 = magic_setflags(__ptr,(ulong)param_1);
  if (iVar1 == -1) {
    piVar3 = __errno_location();
    *piVar3 = 0x16;
  }
  else {
    __ptr[5] = 0;
    __ptr[4] = 0;
    __ptr[2] = 10;
    pvVar2 = malloc(0xa0);
    *(void **)(__ptr + 3) = pvVar2;
    if (pvVar2 != (void *)0x0) {
      *(undefined4 *)((long)__ptr + 0x3c) = 0;
      *(undefined4 *)((long)__ptr + 0x34) = 0xffffffff;
      *__ptr = 0;
      __ptr[1] = 0;
      __ptr[8] = 0x11c38e;
      __ptr[9] = 0;
      __ptr[0x1a] = 0x8008000001e0032;
      *(undefined4 *)(__ptr + 0x1b) = 0x20000100;
      __ptr[0x1c] = 0x100000;
      return __ptr;
    }
  }
  free(__ptr);
  return (undefined8 *)0;
}



undefined8 FUN_00108980(undefined8 param_1,long param_2,undefined8 param_3)

{
  undefined8 uVar1;
  
  if ((*(byte *)(param_2 + 2) & 8) == 0) {
    uVar1 = FUN_001085f0(param_1, param_2, param_3);
    return uVar1;
  }
  return param_3;
}



void FUN_001089a0(FILE *param_1,long param_2,long param_3)

{
  char cVar1;
  bool bVar2;
  
  param_2 = param_2 + 1;
  do {
    if (param_3 == 0xffffffff) {
      cVar1 = *(char *)(param_2 + -1);
      if (cVar1 == '\0') {
        return;
      }
    }
    else {
      bVar2 = param_3 == 0;
      param_3 = param_3 + -1;
      if (bVar2) {
        return;
      }
      cVar1 = *(char *)(param_2 + -1);
    }
    if ((byte)(cVar1 - 0x20U) < 0x5f) {
      fputc((int)cVar1,param_1);
    }
    else {
      fputc(0x5c,param_1);
      switch(cVar1) {
      case '\a':
        fputc(0x61,param_1);
        break;
      case '\b':
        fputc(0x62,param_1);
        break;
      case '\t':
        fputc(0x74,param_1);
        break;
      case '\n':
        fputc(0x6e,param_1);
        break;
      case '\v':
        fputc(0x76,param_1);
        break;
      case '\f':
        fputc(0x66,param_1);
        break;
      case '\r':
        fputc(0x72,param_1);
        break;
      default:
        fprintf(param_1,1,&DAT_0011850a,(ulong)(uint)(int)cVar1 & 0xff);
      }
    }
    param_2 = param_2 + 1;
  } while( true );
}



undefined8 FUN_00108ae0(long param_1)

{
  uint uVar1;
  
  uVar1 = *(uint *)(param_1 + 0x1c) & 0xf80;
  if (uVar1 == 0x200) {
    return 2;
  }
  if (uVar1 < 0x201) {
    if (uVar1 == 0x80) {
      return 1;
    }
    if (uVar1 == 0x100) {
      return 2;
    }
  }
  else {
    if ((uVar1 == 0x400) || (uVar1 == 0x800)) {
      return 4;
    }
  }
                    // WARNING: Subroutine does not return
  abort();
}



// WARNING: Could not reconcile some variable overlaps
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_00108b40(long param_1,int param_2,char *param_3,int *param_4,undefined8 param_5)

{
  byte bVar1;
  uint uVar2;
  int iVar3;
  char cVar4;
  ushort uVar5;
  int iVar6;
  int iVar7;
  FILE *__stream;
  __ssize_t _Var8;
  ushort **ppuVar9;
  uint *puVar10;
  ulonglong uVar11;
  int *piVar12;
  byte bVar13;
  short sVar14;
  ulong uVar15;
  long lVar16;
  long lVar17;
  ulong uVar18;
  char *__s2;
  size_t __size;
  byte bVar19;
  undefined8 *puVar20;
  byte *__s1;
  byte *pbVar21;
  undefined8 *puVar22;
  ushort *puVar23;
  ulong uVar24;
  byte **ppbVar25;
  char *pcVar26;
  uint __c;
  byte *__s1_00;
  char cVar27;
  ulong uVar28;
  byte *__s2_00;
  undefined8 *puVar29;
  byte *__n;
  long in_FS_OFFSET;
  bool bVar30;
  byte bVar31;
  float fVar32;
  double dVar33;
  size_t local_e0;
  byte *local_d8;
  byte *local_d0;
  byte *local_c8;
  byte *local_c0;
  undefined8 *local_b8;
  undefined8 local_b0;
  byte *local_a8 [13];
  long local_40;
  
  bVar31 = 0;
  *(char **)(param_1 + 0x40) = param_3;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_e0 = 0;
  local_d8 = (byte *)0x0;
  __stream = fopen(param_3,"r");
  if (__stream == (FILE *)0x0) {
    puVar10 = (uint *)__errno_location();
    if (*puVar10 != 2) {
      FUN_00112ce0(param_1,(ulong)*puVar10,"cannot read magic file `%s\'",param_3);
    }
    *param_4 = *param_4 + 1;
  }
  else {
    *(undefined8 *)(param_1 + 0x48) = 1;
    iVar3 = 0;
    local_b8 = (undefined8 *)0x0;
    local_b0 = 0;
LAB_00108be0:
    _Var8 = __getdelim((char **)&local_d8,&local_e0,10,__stream);
    __s1_00 = local_d8;
    if (_Var8 != -1) {
      if (_Var8 != 0) {
        if (local_d8[_Var8 + -1] == 10) {
          iVar3 = iVar3 + 1;
          local_d8[_Var8 + -1] = 0;
        }
        bVar19 = *local_d8;
        if (bVar19 != 0x21) {
          if ((bVar19 != 0x23) && (bVar19 != 0)) goto LAB_00108c46;
          goto LAB_00108d90;
        }
        if (local_d8[1] == 0x3a) goto code_r0x00108e4b;
LAB_00108c46:
LAB_00108c4e:
        local_d0 = local_d8;
        if (*local_d8 == 0x3e) {
          do {
            local_d0 = local_d0 + 1;
            __c = (int)local_d0 - (int)local_d8;
            uVar28 = (ulong)__c;
          } while (*local_d0 == 0x3e);
          if (__c == 0) goto LAB_00108ef0;
          if ((_DAT_003204f0 < __c) && (iVar6 = FUN_00113920(param_1,0), iVar6 == -1))
          goto LAB_00108d85;
          _DAT_003204f0 = __c;
          if (local_b8 == (undefined8 *)0x0) {
            FUN_00112fc0(param_1,"No current entry for continuation");
            goto LAB_00108d85;
          }
          if ((int)local_b0 == 0) {
            FUN_00112fc0(param_1,"Continuations present with 0 count");
            goto LAB_00108d85;
          }
          if ((int)(__c - *(ushort *)(local_b8 + (ulong)((int)local_b0 - 1) * 0x2b)) < 2) {
            uVar15 = local_b0 & 0xffffffff;
            iVar6 = (int)local_b0;
            if (local_b0 == (int)local_b0) {
LAB_00108fd5:
              __size = (uVar15 + 10) * 0x158;
              puVar20 = (undefined8 *)realloc(local_b8,__size);
              if (puVar20 == (undefined8 *)0x0) {
                FUN_00113100(param_1,__size);
                goto LAB_00108d85;
              }
              uVar15 = local_b0 & 0xffffffff;
              local_b0 = iVar6 + 10;
              local_b8 = puVar20;
            }
          }
          else {
            FUN_00111c10(param_1,
                         "New continuation level %u is more than one larger than current level %u",
                         (ulong)__c);
            uVar15 = local_b0 & 0xffffffff;
            iVar6 = (int)local_b0;
            if (local_b0 == (int)local_b0) goto LAB_00108fd5;
          }
          local_b0 = CONCAT44(local_b0,(int)local_b0 + 1);
          puVar20 = local_b8 + uVar15 * 0x2b;
          *puVar20 = 0;
          puVar20[0x2a] = 0;
          uVar15 = (ulong)(((int)puVar20 -
                           (int)(undefined8 *)((ulong)(puVar20 + 1) & 0xfffffffffffffff8)) + 0x158U
                          >> 3);
          puVar22 = (undefined8 *)((ulong)(puVar20 + 1) & 0xfffffffffffffff8);
          while (uVar15 != 0) {
            uVar15 = uVar15 - 1;
            *puVar22 = 0;
            puVar22 = puVar22 + (ulong)bVar31 * 0x1ffffffffffffffe + 1;
          }
          sVar14 = (short)__c;
          *(short *)puVar20 = sVar14;
          goto LAB_00108d3e;
        }
LAB_00108ef0:
        iVar6 = FUN_00113920(param_1,0);
        if (iVar6 == -1) goto LAB_00108d85;
        _DAT_003204f0 = 0;
        if (local_b8 != (undefined8 *)0x0) goto code_r0x00108f1c;
        puVar20 = (undefined8 *)malloc(0xd70);
        if (puVar20 != (undefined8 *)0x0) {
          lVar16 = 0x2b;
          uVar28 = 0;
          puVar22 = puVar20;
          while (sVar14 = (short)lVar16, lVar16 != 0) {
            lVar16 = lVar16 + -1;
            *puVar22 = 0;
            puVar22 = puVar22 + (ulong)bVar31 * 0x1ffffffffffffffe + 1;
          }
          local_b0 = 0xa00000001;
          local_b8 = puVar20;
LAB_00108d3e:
          *(int *)((long)puVar20 + 0x14) = iVar3;
          bVar19 = *local_d0;
          if (bVar19 == 0x26) {
            *(byte *)((long)puVar20 + 2) = *(byte *)((long)puVar20 + 2) | 2;
            bVar19 = local_d0[1];
            local_d0 = local_d0 + 1;
          }
          __s1_00 = local_d0;
          if (bVar19 == 0x28) {
            bVar19 = *(byte *)((long)puVar20 + 2);
            bVar13 = bVar19 | 1;
            if ((bVar19 & 2) != 0) {
              bVar13 = bVar19 & 0xf9 | 5;
            }
            *(byte *)((long)puVar20 + 2) = bVar13;
            __s1_00 = local_d0 + 1;
            if (local_d0[1] == 0x26) {
              *(byte *)((long)puVar20 + 2) = *(byte *)((long)puVar20 + 2) | 2;
              __s1_00 = local_d0 + 2;
            }
          }
          local_d0 = __s1_00;
          if ((sVar14 == 0) && ((*(byte *)((long)puVar20 + 2) & 6) != 0)) {
            if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
              FUN_00111c10(param_1,"relative offset at level 0");
              *param_4 = *param_4 + 1;
              goto LAB_00108d90;
            }
            goto LAB_00108d85;
          }
          uVar15 = strtoul((char *)local_d0,(char **)&local_c8,0);
          *(undefined4 *)((long)puVar20 + 0xc) = (int)uVar15;
          if (local_d0 == local_c8) {
            if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
              FUN_00111c10(param_1,0x118566);
            }
            goto LAB_00108d85;
          }
          local_d0 = local_c8;
          if ((*(byte *)((long)puVar20 + 2) & 1) != 0) {
            *(undefined4 *)(puVar20 + 2) = 0;
            *(undefined2 *)((long)puVar20 + 7) = 4;
            bVar19 = *local_c8;
            __s1_00 = local_c8;
            if ((bVar19 & 0xfd) == 0x2c) {
              if (bVar19 == 0x2c) {
                *(undefined *)(puVar20 + 1) = 0x20;
              }
              local_d0 = local_c8 + 1;
              switch(local_c8[1]) {
              case 0x42:
              case 0x43:
              case 0x62:
              case 99:
                *(undefined *)((long)puVar20 + 7) = 1;
                break;
              default:
                if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                  FUN_00111c10(param_1,"indirect offset type `%c\' invalid");
                }
                goto LAB_00108d85;
              case 0x45:
              case 0x46:
              case 0x47:
                *(undefined *)((long)puVar20 + 7) = 0x25;
                break;
              case 0x48:
              case 0x53:
                *(undefined *)((long)puVar20 + 7) = 7;
                break;
              case 0x49:
                *(undefined *)((long)puVar20 + 7) = 0x27;
                break;
              case 0x4c:
                *(undefined *)((long)puVar20 + 7) = 8;
                break;
              case 0x65:
              case 0x66:
              case 0x67:
                *(undefined *)((long)puVar20 + 7) = 0x26;
                break;
              case 0x68:
              case 0x73:
                *(undefined *)((long)puVar20 + 7) = 10;
                break;
              case 0x69:
                *(undefined *)((long)puVar20 + 7) = 0x28;
                break;
              case 0x6c:
                *(undefined *)((long)puVar20 + 7) = 0xb;
                break;
              case 0x6d:
                *(undefined *)((long)puVar20 + 7) = 0x17;
              }
              __s1_00 = local_c8 + 2;
              bVar19 = local_c8[2];
            }
            local_d0 = __s1_00;
            if (bVar19 == 0x7e) {
              local_d0 = __s1_00 + 1;
              *(byte *)(puVar20 + 1) = *(byte *)(puVar20 + 1) | 0x40;
              bVar19 = __s1_00[1];
            }
            __s2_00 = local_d0;
            iVar6 = FUN_00106f30((ulong)(uint)(int)(char)bVar19);
            __s1_00 = __s2_00;
            if (iVar6 != -1) {
              *(byte *)(puVar20 + 1) = *(byte *)(puVar20 + 1) | (byte)iVar6;
              __s1_00 = __s2_00 + 1;
              bVar19 = __s2_00[1];
              local_d0 = __s1_00;
            }
            __s2_00 = __s1_00;
            if (bVar19 == 0x28) {
              __s2_00 = __s1_00 + 1;
              *(byte *)(puVar20 + 1) = *(byte *)(puVar20 + 1) | 0x80;
              bVar19 = __s1_00[1];
              local_d0 = __s2_00;
            }
            ppuVar9 = __ctype_b_loc();
            if (((*(byte *)((long)*ppuVar9 + (ulong)bVar19 * 2 + 1) & 8) != 0) || (bVar19 == 0x2d))
            {
              lVar16 = strtol((char *)__s2_00,(char **)&local_c8,0);
              *(int *)(puVar20 + 2) = (int)lVar16;
              __s2_00 = local_c8;
              if (local_d0 == local_c8) {
                if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                  FUN_00111c10(param_1,"in_offset `%s\' invalid",local_c8);
                }
                goto LAB_00108d85;
              }
            }
            local_d0 = __s2_00 + 1;
            if ((*__s2_00 != 0x29) ||
               ((*(char *)(puVar20 + 1) < '\0' && (local_d0 = __s2_00 + 2, __s2_00[1] != 0x29)))) {
              if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                FUN_00111c10(param_1,"missing \')\' in indirect offset");
              }
              goto LAB_00108d85;
            }
          }
          __s1_00 = local_d0;
          bVar19 = *local_d0;
          if ((bVar19 & 0x80) == 0) {
            ppuVar9 = __ctype_b_loc();
            do {
              if ((*(byte *)((long)*ppuVar9 + (ulong)bVar19 * 2 + 1) & 0x20) == 0) break;
              __s1_00 = __s1_00 + 1;
              bVar19 = *__s1_00;
              local_d0 = __s1_00;
            } while ((bVar19 & 0x80) == 0);
          }
          __size = 2;
          __s2 = "if";
          do {
            iVar6 = strncmp((char *)__s1_00,__s2,__size);
            if (iVar6 == 0) {
              ppuVar9 = __ctype_b_loc();
              __s2_00 = __s1_00 + __size;
              if ((*(byte *)((long)*ppuVar9 + (ulong)__s1_00[__size] * 2 + 1) & 0x20) != 0) break;
            }
            pcVar26 = __s2 + 0x18;
            __size = *(size_t *)(__s2 + 0x20);
            __s2 = pcVar26;
            __s2_00 = local_d0;
          } while (__size != 0);
          local_d0 = __s2_00;
          __s1_00 = local_d0;
          __c = *(uint *)(__s2 + 0x10);
          *(undefined *)((long)puVar20 + 10) = (char)__c;
          __c = __c & 0xff;
          lVar16 = *(long *)(param_1 + 0x18) + uVar28 * 0x10;
          uVar2 = *(uint *)(lVar16 + 0xc);
          if (__c == 1) {
            if ((uVar2 & 0xfffffffd) == 0) goto LAB_001092c6;
            if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
              FUN_00111c10(param_1,"syntax error: `if\'");
            }
            goto LAB_00108d85;
          }
          if (1 < __c) {
            if (__c == 2) {
              if (uVar2 - 1 < 2) goto LAB_001092c6;
              if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                FUN_00111c10(param_1,"syntax error: `elif\'");
              }
            }
            else {
              if (__c != 3) goto LAB_00109734;
              if (uVar2 - 1 < 2) {
                __c = 0;
                goto LAB_001092c6;
              }
              if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                FUN_00111c10(param_1,"syntax error: `else\'");
              }
            }
            goto LAB_00108d85;
          }
          if (__c != 0) {
LAB_00109734:
            __c = uVar2;
          }
LAB_001092c6:
          *(uint *)(lVar16 + 0xc) = __c;
          bVar19 = *local_d0;
          if ((bVar19 & 0x80) == 0) {
            ppuVar9 = __ctype_b_loc();
            do {
              if ((*(byte *)((long)*ppuVar9 + (ulong)bVar19 * 2 + 1) & 0x20) == 0) break;
              __s1_00 = __s1_00 + 1;
              bVar19 = *__s1_00;
              local_d0 = __s1_00;
            } while ((bVar19 & 0x80) == 0);
          }
          if (bVar19 == 0x75) {
            __c = FUN_00107c70("invalid",__s1_00 + 1,&local_d0);
            *(char *)((long)puVar20 + 6) = (char)__c;
            if ((char)__c == '\0') {
              __c = FUN_001079a0(local_d0,&local_d0);
              *(char *)((long)puVar20 + 6) = (char)__c;
              __s1_00 = local_d0;
              if ((char)__c == '\0') goto LAB_0010934c;
            }
            uVar28 = (ulong)__c;
            *(byte *)((long)puVar20 + 2) = *(byte *)((long)puVar20 + 2) | 8;
LAB_00109479:
            *(undefined *)((long)puVar20 + 9) = 0;
            if (*local_d0 == 0x7e) {
              if (((byte)uVar28 < 0x2f) && ((0x6200001e2020U >> (uVar28 & 0x1f) & 1) != 0)) {
LAB_001097e1:
                if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                  FUN_00111c10(param_1,"\'~\' invalid for string types");
                }
              }
              else {
                *(undefined *)((long)puVar20 + 9) = 0x40;
              }
              local_d0 = local_d0 + 1;
            }
          }
          else {
            __c = FUN_00107c70("invalid",__s1_00,&local_d0);
            __s1_00 = local_d0;
            uVar28 = (ulong)__c;
            *(char *)((long)puVar20 + 6) = (char)__c;
            if ((char)__c != '\0') goto LAB_00109479;
            if (*local_d0 == 100) {
              __c = FUN_001079a0(local_d0,&local_d0);
              uVar28 = (ulong)__c;
              *(char *)((long)puVar20 + 6) = (char)__c;
              __s1_00 = local_d0;
              if ((char)__c == '\0') goto LAB_0010934c;
              goto LAB_00109479;
            }
            if ((*local_d0 != 0x73) ||
               (ppuVar9 = __ctype_b_loc(),
               (*(byte *)((long)*ppuVar9 + (ulong)__s1_00[1] * 2 + 1) & 4) != 0)) {
LAB_0010934c:
              __c = FUN_00107c70(&DAT_00119680,__s1_00,&local_d0);
              uVar28 = (ulong)__c;
              *(char *)((long)puVar20 + 6) = (char)__c;
              if ((char)__c == '\0') {
                if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                  FUN_00111c10(param_1,"type `%s\' invalid",local_d0);
                }
                goto LAB_00108d85;
              }
              goto LAB_00109479;
            }
            local_d0 = __s1_00 + 1;
            *(undefined *)((long)puVar20 + 6) = 5;
            *(undefined *)((long)puVar20 + 9) = 0;
            if (__s1_00[1] == 0x7e) goto LAB_001097e1;
          }
          __s1_00 = local_d0;
          bVar19 = *(byte *)((long)puVar20 + 6);
          *(undefined4 *)(puVar20 + 3) = 0;
          if (bVar19 == 0xd) {
            *(undefined4 *)((long)puVar20 + 0x1c) = 0x80;
            uVar28 = (ulong)(uint)(int)(char)*local_d0;
            iVar6 = FUN_00106f30(0);
            if (iVar6 != -1) {
              if (iVar6 == 6) {
                ppuVar9 = __ctype_b_loc();
                puVar23 = *ppuVar9;
LAB_0010982e:
                uVar28 = (ulong)(uint)(int)(char)__s1_00[1];
                bVar30 = false;
                uVar5 = puVar23[uVar28 & 0xff];
                while (__s2_00 = __s1_00 + 1, (uVar5 & 0x2000) == 0) {
                  __s1_00 = __s2_00;
                  switch((char)uVar28) {
                  case '0':
                  case '1':
                  case '2':
                  case '3':
                  case '4':
                  case '5':
                  case '6':
                  case '7':
                  case '8':
                  case '9':
                    if ((bVar30) && ((*(byte *)(param_1 + 0x38) & 0x40) != 0)) {
                      FUN_00111c10(param_1,"multiple ranges");
                    }
                    uVar28 = strtoul((char *)__s2_00,(char **)local_a8,0);
                    *(int *)(puVar20 + 3) = (int)uVar28;
                    if ((int)uVar28 == 0) {
                      FUN_00111c10(param_1,"zero range");
                    }
                    puVar23 = *ppuVar9;
                    bVar30 = true;
                    __s1_00 = local_a8[0] + -1;
                    break;
                  default:
                    goto switchD_00109871_caseD_3a;
                  case 'B':
                    if (*(char *)((long)puVar20 + 6) == '\r') {
                      *(uint *)((long)puVar20 + 0x1c) =
                           *(uint *)((long)puVar20 + 0x1c) & 0xfffff07f | 0x80;
                      break;
                    }
                    uVar28 = 0x42;
                    goto switchD_00109871_caseD_3a;
                  case 'C':
                    *(uint *)((long)puVar20 + 0x1c) = *(uint *)((long)puVar20 + 0x1c) | 8;
                    break;
                  case 'H':
                    if (*(char *)((long)puVar20 + 6) == '\r') {
                      __c = *(uint *)((long)puVar20 + 0x1c) & 0xfffff07f;
                      *(uint *)((long)puVar20 + 0x1c) =
                           *(uint *)((long)puVar20 + 0x1c) & 0xffff0000 |
                           (uint)CONCAT11((char)((ulong)__c >> 8),(char)__c) | 0x100;
                      break;
                    }
                    uVar28 = 0x48;
                    goto switchD_00109871_caseD_3a;
                  case 'J':
                    if (*(char *)((long)puVar20 + 6) == '\r') {
                      *(uint *)((long)puVar20 + 0x1c) = *(uint *)((long)puVar20 + 0x1c) | 0x1000;
                      break;
                    }
                    uVar28 = 0x4a;
                    goto switchD_00109871_caseD_3a;
                  case 'L':
                    if (*(char *)((long)puVar20 + 6) == '\r') {
                      __c = *(uint *)((long)puVar20 + 0x1c) & 0xfffff07f;
                      *(uint *)((long)puVar20 + 0x1c) =
                           *(uint *)((long)puVar20 + 0x1c) & 0xffff0000 |
                           (uint)CONCAT11((char)((ulong)__c >> 8),(char)__c) | 0x400;
                      break;
                    }
                    uVar28 = 0x4c;
                    goto switchD_00109871_caseD_3a;
                  case 'T':
                    *(uint *)((long)puVar20 + 0x1c) = *(uint *)((long)puVar20 + 0x1c) | 0x2000;
                    break;
                  case 'W':
                    *(uint *)((long)puVar20 + 0x1c) = *(uint *)((long)puVar20 + 0x1c) | 1;
                    break;
                  case 'b':
                    *(uint *)((long)puVar20 + 0x1c) = *(uint *)((long)puVar20 + 0x1c) | 0x40;
                    break;
                  case 'c':
                    *(uint *)((long)puVar20 + 0x1c) = *(uint *)((long)puVar20 + 0x1c) | 4;
                    break;
                  case 'h':
                    if (*(char *)((long)puVar20 + 6) == '\r') {
                      __c = *(uint *)((long)puVar20 + 0x1c) & 0xfffff07f;
                      *(uint *)((long)puVar20 + 0x1c) =
                           *(uint *)((long)puVar20 + 0x1c) & 0xffff0000 |
                           (uint)CONCAT11((char)((ulong)__c >> 8),(char)__c) | 0x200;
                      break;
                    }
                    uVar28 = 0x68;
                    goto switchD_00109871_caseD_3a;
                  case 'l':
                    if ((*(char *)((long)puVar20 + 6) == '\r') ||
                       (*(char *)((long)puVar20 + 6) == '\x11')) {
                      __c = *(uint *)((long)puVar20 + 0x1c) & 0xfffff07f;
                      *(uint *)((long)puVar20 + 0x1c) =
                           *(uint *)((long)puVar20 + 0x1c) & 0xffff0000 |
                           (uint)CONCAT11((char)((ulong)__c >> 8),(char)__c) | 0x800;
                      break;
                    }
                    uVar28 = 0x6c;
                    goto switchD_00109871_caseD_3a;
                  case 's':
                    *(uint *)((long)puVar20 + 0x1c) = *(uint *)((long)puVar20 + 0x1c) | 0x10;
                    break;
                  case 't':
                    *(uint *)((long)puVar20 + 0x1c) = *(uint *)((long)puVar20 + 0x1c) | 0x20;
                    break;
                  case 'w':
                    *(uint *)((long)puVar20 + 0x1c) = *(uint *)((long)puVar20 + 0x1c) | 2;
                  }
                  bVar19 = __s1_00[1];
                  uVar28 = (ulong)(uint)(int)(char)bVar19;
                  if (bVar19 == 0x2f) {
                    __s2_00 = __s1_00 + 2;
                    uVar5 = puVar23[*__s2_00];
                    if ((uVar5 & 0x2000) != 0) {
                      __s2_00 = __s1_00 + 1;
                      if ((*(byte *)((long)puVar23 + 0x5f) & 0x20) == 0) {
switchD_00109871_caseD_3a:
                        if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                          FUN_00111c10(param_1,"string modifier `%c\' invalid",uVar28);
                        }
                        goto LAB_00108d85;
                      }
                      break;
                    }
                    __s1_00 = __s1_00 + 1;
                    uVar28 = (ulong)(uint)(int)(char)*__s2_00;
                  }
                  else {
                    uVar5 = puVar23[(int)(char)bVar19 & 0xff];
                  }
                }
                if ((*(byte *)(param_1 + 0x38) & 0x40) == 0) goto LAB_0010a3ab;
                cVar27 = *(char *)((long)puVar20 + 6);
                __c = *(uint *)((long)puVar20 + 0x1c);
                if (cVar27 == '\x11') {
                  if (((__c & 0x800) == 0) && ((__c & 0xf80) != 0)) {
LAB_0010a538:
                    FUN_00111c10(param_1,
                                 "\'/BHhLl\' modifiers are only allowed for pascal strings\n");
                  }
                  else {
switchD_00109b22_caseD_11:
                    if ((__c & 1) == 0) {
                      if ((__c & 2) == 0) goto LAB_0010a3ab;
                      FUN_00111c10(param_1,"\'/%c\' not allowed on regex\n",0x77);
                    }
                    else {
                      FUN_00111c10(param_1,"\'/%c\' not allowed on regex\n",0x57);
                    }
                  }
                }
                else {
                  if (cVar27 == '\r') {
switchD_00109b22_caseD_5:
                    if ((__c & 0x10) == 0) {
LAB_0010a3ab:
                      uVar28 = (ulong)__s1_00[1];
                      __s1_00 = __s2_00;
                      local_d0 = __s2_00;
                      goto LAB_00109530;
                    }
                    FUN_00111c10(param_1,"\'/%c\' only allowed on regex and search\n",0x73);
                  }
                  else {
                    if ((__c & 0xf80) != 0) goto LAB_0010a538;
                    switch(cVar27) {
                    case '\x05':
                      goto switchD_00109b22_caseD_5;
                    default:
                      FUN_00111c10(param_1,"coding error: m->type=%d\n");
                      break;
                    case '\x11':
                      goto switchD_00109b22_caseD_11;
                    case '\x12':
                    case '\x13':
                      if (__c == 0) goto LAB_0010a3ab;
                      FUN_00111c10(param_1,"no modifiers allowed for 16-bit strings\n");
                      break;
                    case '\x14':
                      if (*(int *)(puVar20 + 3) != 0) goto LAB_0010a3ab;
                      FUN_00111c10(param_1,"missing range; defaulting to %d\n",100);
                      *(undefined4 *)(puVar20 + 3) = 100;
                    }
                  }
                }
              }
              else {
LAB_001096d4:
                if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                  FUN_00111c10(param_1,"invalid string/indirect op: `%c\'",
                               (ulong)(uint)(int)(char)*local_c8);
                }
              }
              goto LAB_00108d85;
            }
          }
          else {
            *(undefined4 *)((long)puVar20 + 0x1c) = 0;
            uVar28 = (ulong)(uint)(int)(char)*local_d0;
            iVar6 = FUN_00106f30(0);
            if (iVar6 != -1) {
              if ((bVar19 < 0x2f) && ((0x6200001e0020U >> ((ulong)bVar19 & 0x1f) & 1) != 0)) {
                if (iVar6 != 6) goto LAB_001096d4;
                ppuVar9 = __ctype_b_loc();
                puVar23 = *ppuVar9;
                __s2_00 = __s1_00;
                if (bVar19 != 0x29) goto LAB_0010982e;
                while( true ) {
                  bVar19 = __s2_00[1];
                  __s1_00 = __s2_00 + 1;
                  if ((*(byte *)((long)puVar23 + (ulong)bVar19 * 2 + 1) & 0x20) != 0) break;
                  if (bVar19 != 0x72) {
                    if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                      FUN_00111c10(param_1,"indirect modifier `%c\' invalid",
                                   (ulong)(uint)(int)(char)bVar19);
                    }
                    goto LAB_00108d85;
                  }
                  *(uint *)((long)puVar20 + 0x1c) = *(uint *)((long)puVar20 + 0x1c) | 1;
                  __s2_00 = __s1_00;
                }
                uVar28 = (ulong)__s2_00[1];
                local_d0 = __s1_00;
              }
              else {
                *(byte *)((long)puVar20 + 9) = *(byte *)((long)puVar20 + 9) | (byte)iVar6;
                local_c0 = __s1_00 + 1;
                uVar11 = strtoull((char *)local_c0,(char **)local_a8,0);
                local_c0 = local_a8[0];
                if ((*(byte *)((long)puVar20 + 2) & 8) == 0) {
                  uVar11 = FUN_001085f0(param_1,puVar20,uVar11);
                }
                puVar20[3] = uVar11;
                FUN_00107cd0(0);
                local_d0 = local_c0;
                uVar28 = (ulong)*local_c0;
                __s1_00 = local_c0;
              }
            }
          }
LAB_00109530:
          bVar19 = (byte)uVar28;
          uVar15 = uVar28 & 0xff;
          if ((uVar28 & 0x80) == 0) {
            ppuVar9 = __ctype_b_loc();
            do {
              bVar19 = (byte)uVar28;
              if ((*(byte *)((long)*ppuVar9 + (uVar28 & 0xff) * 2 + 1) & 0x20) == 0) break;
              __s1_00 = __s1_00 + 1;
              bVar19 = *__s1_00;
              uVar28 = (ulong)bVar19;
              uVar15 = uVar28;
              local_d0 = __s1_00;
            } while ((bVar19 & 0x80) == 0);
          }
          bVar13 = bVar19 - 0x21;
          if (bVar13 < 0x3e) {
            uVar28 = 1 << (bVar13 & 0x3f);
            if ((uVar28 & 0x2000000010000020) == 0) {
              if ((uVar28 & 0x28000000) == 0) {
                if (bVar13 != 0) goto LAB_0010957e;
                local_d0 = __s1_00 + 1;
                *(undefined *)((long)puVar20 + 4) = 0x21;
              }
              else {
                local_d0 = __s1_00 + 1;
                *(byte *)((long)puVar20 + 4) = bVar19;
                if (__s1_00[1] == 0x3d) {
                  if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
                    FUN_00111c10(param_1,"%c= not supported",uVar15);
                    goto LAB_00108d85;
                  }
                  goto LAB_00109f78;
                }
              }
            }
            else {
              local_d0 = __s1_00 + 1;
              *(byte *)((long)puVar20 + 4) = bVar19;
              if (__s1_00[1] == 0x3d) {
LAB_00109f78:
                local_d0 = __s1_00 + 2;
              }
            }
LAB_00109595:
            __s1_00 = local_d0;
            if (*(byte *)((long)puVar20 + 6) < 0x31) {
              uVar28 = 1 << (*(byte *)((long)puVar20 + 6) & 0x3f);
              if ((uVar28 & 0x16000001e2020) != 0) {
                bVar30 = param_2 == 2;
                puVar22 = puVar20 + 4;
                __s2_00 = local_d0;
                puVar29 = puVar22;
LAB_0010a12f:
                bVar19 = *__s2_00;
                __n = __s2_00 + 1;
                if (bVar19 == 0) goto LAB_0010a236;
                ppuVar9 = __ctype_b_loc();
                if ((*(byte *)((long)*ppuVar9 + (ulong)bVar19 * 2 + 1) & 0x20) != 0)
                goto LAB_0010a236;
                if ((undefined8 *)((long)puVar20 + 0x7f) <= puVar29) {
                  FUN_00112ce0(param_1,0,"string too long: `%s\'",__s1_00);
                  local_d0 = (byte *)0x0;
                  goto LAB_0010a491;
                }
                if (bVar19 != 0x5c) {
                  *(byte *)puVar29 = bVar19;
                  __s1 = __n;
                  goto LAB_0010a12b;
                }
                bVar19 = __s2_00[1];
                __c = SEXT14((char)bVar19);
                __s1 = __s2_00 + 2;
                switch(bVar19) {
                case 0:
                  __s2_00 = __n;
                  if (bVar30) {
                    FUN_00111c10(param_1,"incomplete escape");
                  }
                  goto LAB_0010a236;
                default:
                  if (bVar30) {
                    if ((*(byte *)((long)*ppuVar9 + ((ulong)__c & 0xff) * 2 + 1) & 0x40) == 0) {
                      FUN_00111c10(0,0);
                    }
                    else {
                      __s2 = strchr("<>&^=!",__c);
                      if ((__s2 == (char *)0x0) &&
                         ((*(char *)((long)puVar20 + 6) != '\x11' ||
                          (__s2 = strchr("[]().*?^$|{}",__c), __s2 == (char *)0x0)))) {
                        FUN_00111c10(1, __s2);
                      }
                    }
                  }
                  goto switchD_0010a18a_caseD_20;
                case 9:
                  if (bVar30) {
                    FUN_00111c10(0,0);
                    bVar30 = false;
                  }
                case 0x20:
                case 0x21:
                case 0x26:
                case 0x3c:
                case 0x3d:
                case 0x3e:
                case 0x5c:
                case 0x5e:
                  goto switchD_0010a18a_caseD_20;
                case 0x30:
                case 0x31:
                case 0x32:
                case 0x33:
                case 0x34:
                case 0x35:
                case 0x36:
                case 0x37:
                  bVar19 = (byte)(__c - 0x30);
                  if ((int)(char)__s2_00[2] - 0x30U < 8) {
                    __s1 = __s2_00 + 4;
                    __c = (__c - 0x30) * 8 | (int)(char)__s2_00[2] - 0x30U;
                    bVar19 = (byte)__c;
                    if ((int)(char)__s2_00[3] - 0x30U < 8) {
                      bVar19 = (byte)(__c << 3) | (byte)((int)(char)__s2_00[3] - 0x30U);
                    }
                    else {
                      __s1 = __s2_00 + 3;
                    }
                  }
                  *(byte *)puVar29 = bVar19;
                  break;
                case 0x61:
                  *(undefined *)puVar29 = 7;
                  break;
                case 0x62:
                  *(undefined *)puVar29 = 8;
                  break;
                case 0x66:
                  *(undefined *)puVar29 = 0xc;
                  break;
                case 0x6e:
                  *(undefined *)puVar29 = 10;
                  break;
                case 0x72:
                  *(undefined *)puVar29 = 0xd;
                  break;
                case 0x74:
                  *(undefined *)puVar29 = 9;
                  break;
                case 0x76:
                  *(undefined *)puVar29 = 0xb;
                  break;
                case 0x78:
                  iVar6 = FUN_00108280(0);
                  bVar19 = (byte)iVar6;
                  if (iVar6 < 0) {
                    bVar19 = 0x78;
                  }
                  else {
                    __s1 = __s2_00 + 3;
                    iVar7 = FUN_00108280(0);
                    if (-1 < iVar7) {
                      __s1 = __s2_00 + 4;
                      bVar19 = (char)(iVar6 << 4) + (char)iVar7;
                    }
                  }
                  goto switchD_0010a18a_caseD_20;
                }
                goto LAB_0010a12b;
              }
              piVar12 = __errno_location();
              if ((uVar28 & 0x7000000000) == 0) {
                if ((uVar28 & 0xe00000000) == 0) goto LAB_00109f93;
                *piVar12 = 0;
                fVar32 = strtof((char *)__s1_00,(char **)local_a8);
                *(float *)(puVar20 + 4) = fVar32;
                iVar6 = *piVar12;
              }
              else {
                *piVar12 = 0;
                dVar33 = strtod((char *)__s1_00,(char **)local_a8);
                *(double *)(puVar20 + 4) = dVar33;
                iVar6 = *piVar12;
              }
              if (iVar6 == 0) {
                local_d0 = local_a8[0];
              }
            }
            else {
              piVar12 = __errno_location();
LAB_00109f93:
              *piVar12 = 0;
              uVar11 = strtoull((char *)__s1_00,(char **)local_a8,0);
              if ((*(byte *)((long)puVar20 + 2) & 8) == 0) {
                uVar11 = FUN_001085f0(param_1,puVar20,uVar11);
              }
              puVar20[4] = uVar11;
              if (*piVar12 == 0) {
                local_d0 = local_a8[0];
                FUN_00107cd0(&local_d0);
              }
            }
          }
          else {
LAB_0010957e:
            *(undefined *)((long)puVar20 + 4) = 0x3d;
            if (((*__s1_00 != 0x78) || (bVar19 = __s1_00[1], (bVar19 & 0x80) != 0)) ||
               ((ppuVar9 = __ctype_b_loc(),
                (*(byte *)((long)*ppuVar9 + (ulong)bVar19 * 2 + 1) & 0x20) == 0 && (bVar19 != 0))))
            goto LAB_00109595;
            local_d0 = __s1_00 + 1;
            *(undefined *)((long)puVar20 + 4) = 0x78;
          }
          goto LAB_00109611;
        }
        FUN_00113100(param_1,0xd70);
        goto LAB_00108d85;
      }
      goto LAB_00108d90;
    }
    if (local_b8 != (undefined8 *)0x0) {
      FUN_00107530(param_1,&local_b8,param_5);
    }
    free(local_d8);
    fclose(__stream);
  }
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return;
code_r0x00108e4b:
  __s2_00 = local_d8 + 2;
  lVar16 = 0;
  __n = (byte *)0x4;
  __s1 = &DAT_00118468;
  ppbVar25 = &PTR_DAT_0031f4a0;
  while( true ) {
    if ((__n < (byte *)(_Var8 + -2)) && (iVar6 = memcmp(__s1,__s2_00,(size_t)__n), iVar6 == 0)) {
      if (local_b8 == (undefined8 *)0x0) {
        __s2 = "No current entry for :!%s type";
        goto LAB_00108ecd;
      }
      iVar6 = (*(void*(*)())(&PTR_FUN_0031f4b0)[lVar16 * 3])(param_1,&local_b8,__s1_00 + 2 + (long)__n);
      if (iVar6 != 0) {
        *param_4 = *param_4 + 1;
      }
      goto LAB_00108d90;
    }
    __s1 = ppbVar25[3];
    lVar16 = lVar16 + 1;
    if (__s1 == (byte *)0x0) break;
    __n = ppbVar25[4];
    ppbVar25 = ppbVar25 + 3;
  }
  __s2 = "Unknown !: entry `%s\'";
  __s1 = __s1_00;
LAB_00108ecd:
  FUN_00112ce0(param_1,0,__s2,__s1);
  *param_4 = *param_4 + 1;
  *(long *)(param_1 + 0x48) = *(long *)(param_1 + 0x48) + 1;
  goto LAB_00108be0;
code_r0x00108f1c:
  FUN_00107530(param_1,&local_b8,param_5);
  goto LAB_00108c4e;
switchD_0010a18a_caseD_20:
  *(byte *)puVar29 = bVar19;
LAB_0010a12b:
  puVar29 = (undefined8 *)((long)puVar29 + 1);
  __s2_00 = __s1;
  goto LAB_0010a12f;
LAB_0010a236:
  *(undefined *)puVar29 = 0;
  cVar27 = (char)puVar29 - (char)puVar22;
  *(char *)((long)puVar20 + 5) = cVar27;
  if (*(char *)((long)puVar20 + 6) == '\r') {
    cVar4 = FUN_00108ae0(puVar20);
    *(char *)((long)puVar20 + 5) = cVar27 + cVar4;
    local_d0 = __s2_00;
    if (__s2_00 != (byte *)0x0) goto LAB_00109611;
LAB_0010a491:
    if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
      FUN_00111c10(param_1,"cannot get string from `%s\'",puVar22);
    }
  }
  else {
    local_d0 = __s2_00;
    if (__s2_00 == (byte *)0x0) goto LAB_0010a491;
    if (*(char *)((long)puVar20 + 6) != '\x11') {
LAB_00109611:
      __s1_00 = local_d0;
      bVar19 = *local_d0;
      if ((bVar19 & 0x80) == 0) {
        ppuVar9 = __ctype_b_loc();
        do {
          if ((*(byte *)((long)*ppuVar9 + (ulong)bVar19 * 2 + 1) & 0x20) == 0) break;
          __s1_00 = __s1_00 + 1;
          bVar19 = *__s1_00;
          local_d0 = __s1_00;
        } while ((bVar19 & 0x80) == 0);
      }
      if (bVar19 == 8) {
        local_d0 = __s1_00 + 1;
        *(byte *)((long)puVar20 + 2) = *(byte *)((long)puVar20 + 2) | 0x10;
      }
      else {
        if ((bVar19 == 0x5c) && (__s1_00[1] == 0x62)) {
          local_d0 = __s1_00 + 2;
          *(byte *)((long)puVar20 + 2) = *(byte *)((long)puVar20 + 2) | 0x10;
        }
      }
      lVar16 = 0;
      __s1_00 = local_d0;
      do {
        local_d0 = __s1_00 + 1;
        bVar19 = *__s1_00;
        lVar17 = lVar16 + 1;
        *(byte *)((long)puVar20 + lVar16 + 0x80) = bVar19;
        if (bVar19 == 0) {
          if (lVar17 != 0x40) goto LAB_00109695;
          break;
        }
        lVar16 = lVar17;
        __s1_00 = local_d0;
      } while (lVar17 != 0x40);
      *(undefined *)((long)puVar20 + 0xbf) = 0;
      if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
        FUN_00111c10(param_1,"description `%s\' truncated",puVar20 + 0x10);
LAB_00109695:
        if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
          cVar27 = *(char *)(puVar20 + 0x10);
          puVar22 = puVar20 + 0x10;
          puVar29 = puVar22;
          if (cVar27 != '\0') {
joined_r0x00109c0b:
            if (cVar27 != '%') goto LAB_00109c10;
            bVar19 = *(byte *)((long)puVar20 + 6);
            if (bVar19 < 0x31) {
              uVar28 = (ulong)bVar19;
              iVar6 = *(int *)(&DAT_00320500 + uVar28 * 4);
              if (iVar6 == 0) {
                FUN_00111c10(param_1,"No format string for `%s\' with description `%s\'",puVar22,
                             *(undefined8 *)(&DAT_003205e0 + uVar28 * 8));
              }
              else {
                bVar13 = *(byte *)((long)puVar29 + 1);
                __s1_00 = (byte *)((long)puVar29 + 1);
                if (bVar13 == 0) {
                  __s2 = "missing format spec";
                }
                else {
                  __c = (uint)bVar13;
                  switch(iVar6) {
                  default:
switchD_00109c7a_caseD_0:
                    // WARNING: Subroutine does not return
                    abort();
                  case 1:
                    if (0x29 < bVar19) goto switchD_00109c7a_caseD_0;
                    uVar15 = 1 << (bVar19 & 0x3f);
                    if ((uVar15 & 0x38000800910) == 0) {
                      if ((uVar15 & 0x484) == 0) {
                        if ((uVar15 & 2) == 0) goto switchD_00109c7a_caseD_0;
                        bVar30 = false;
                        iVar6 = 2;
                      }
                      else {
                        bVar30 = false;
                      }
                    }
                    else {
                      bVar30 = false;
                      iVar6 = 0;
                    }
                    break;
                  case 2:
                    uVar15 = (ulong)__c;
                    __s2_00 = __s1_00;
                    if (bVar13 == 0x2d) {
                      uVar15 = (ulong)*(byte *)((long)puVar29 + 2);
                      __s2_00 = (byte *)((long)puVar29 + 2);
                    }
                    ppuVar9 = __ctype_b_loc();
                    puVar23 = *ppuVar9;
                    while (bVar19 = (byte)uVar15,
                          (*(byte *)((long)puVar23 + uVar15 * 2 + 1) & 8) != 0) {
                      __s2_00 = __s2_00 + 1;
                      uVar15 = (ulong)*__s2_00;
                    }
                    if (bVar19 == 0x2e) {
                      bVar19 = __s2_00[1];
                      __s2_00 = __s2_00 + 1;
                      bVar1 = *(byte *)((long)puVar23 + (ulong)bVar19 * 2 + 1);
                      while ((bVar1 & 8) != 0) {
                        __s2_00 = __s2_00 + 1;
                        bVar19 = *__s2_00;
                        bVar1 = *(byte *)((long)puVar23 + (ulong)bVar19 * 2 + 1);
                      }
                    }
                    if (bVar19 != 0x73) goto LAB_00109e4d;
                    goto joined_r0x00109d25;
                  case 3:
                    bVar30 = true;
                    iVar6 = 0;
                    break;
                  case 4:
                  case 5:
                    uVar15 = (ulong)__c;
                    __s2_00 = __s1_00;
                    if (bVar13 == 0x2d) {
                      uVar15 = (ulong)*(byte *)((long)puVar29 + 2);
                      __s2_00 = (byte *)((long)puVar29 + 2);
                    }
                    if ((char)uVar15 == '.') {
                      uVar15 = (ulong)__s2_00[1];
                      __s2_00 = __s2_00 + 1;
                    }
                    ppuVar9 = __ctype_b_loc();
                    puVar23 = *ppuVar9;
                    uVar18 = 0;
                    __n = __s2_00;
                    while( true ) {
                      cVar27 = (char)uVar15;
                      __c = (uint)uVar15;
                      if ((*(byte *)((long)puVar23 + uVar15 * 2 + 1) & 8) == 0) break;
                      __n = __n + 1;
                      uVar15 = (ulong)*__n;
                      uVar18 = (long)((int)cVar27 + -0x30) + uVar18 * 10;
                    }
                    if ((__n + -(long)__s2_00 < (byte *)0x6) && (uVar18 < 0x401)) {
                      if (cVar27 == '.') {
                        uVar15 = (ulong)__n[1];
                        __c = (uint)__n[1];
                        if ((*(byte *)((long)puVar23 + uVar15 * 2 + 1) & 8) != 0) {
                          uVar18 = 0;
                          uVar24 = 0;
                          do {
                            uVar24 = uVar24 + 1;
                            cVar27 = (char)uVar15;
                            uVar15 = (ulong)__n[uVar24 + 2];
                            uVar18 = (long)((int)cVar27 + -0x30) + uVar18 * 10;
                            __c = (uint)__n[uVar24 + 2];
                            uVar24 = uVar24;
                          } while ((*(byte *)((long)puVar23 + uVar15 * 2 + 1) & 8) != 0);
                          if ((5 < uVar24) || (0x400 < uVar18)) goto LAB_00109e4d;
                        }
                      }
                      if (((byte)(__c - 0x45) < 0x23) &&
                         ((0x700000007U >> ((ulong)(__c - 0x45) & 0x1f) & 1) != 0))
                      goto joined_r0x00109d25;
                    }
                    goto LAB_00109e4d;
                  }
                  uVar15 = (ulong)__c;
                  __s2_00 = __s1_00;
                  if (bVar13 == 0x2d) {
                    uVar15 = (ulong)*(byte *)((long)puVar29 + 2);
                    __s2_00 = (byte *)((long)puVar29 + 2);
                  }
                  if ((char)uVar15 == '.') {
                    uVar15 = (ulong)__s2_00[1];
                    __s2_00 = __s2_00 + 1;
                  }
                  ppuVar9 = __ctype_b_loc();
                  uVar18 = 0;
                  puVar23 = *ppuVar9;
                  __n = __s2_00;
                  while( true ) {
                    bVar19 = (byte)uVar15;
                    if ((*(byte *)((long)puVar23 + uVar15 * 2 + 1) & 8) == 0) break;
                    __n = __n + 1;
                    uVar15 = (ulong)*__n;
                    uVar18 = (long)((int)(char)bVar19 + -0x30) + uVar18 * 10;
                  }
                  if ((__n + -(long)__s2_00 < (byte *)0x6) && (uVar18 < 0x401)) {
                    __s2_00 = __n;
                    if (bVar19 == 0x2e) {
                      __s2_00 = __n + 1;
                      bVar19 = __n[1];
                      uVar15 = (ulong)bVar19;
                      if ((*(byte *)((long)puVar23 + uVar15 * 2 + 1) & 8) != 0) {
                        uVar18 = 0;
                        __s1 = __s2_00;
                        do {
                          __s2_00 = __s1 + 1;
                          cVar27 = (char)uVar15;
                          bVar19 = *__s2_00;
                          uVar15 = (ulong)bVar19;
                          uVar18 = (long)((int)cVar27 + -0x30) + uVar18 * 10;
                          pbVar21 = __s1 + -(long)__n;
                          __s1 = __s2_00;
                        } while ((*(byte *)((long)puVar23 + uVar15 * 2 + 1) & 8) != 0);
                        if (((byte *)0x5 < pbVar21) || (0x400 < uVar18)) goto LAB_00109e4d;
                      }
                    }
                    if ((((bVar30) &&
                         ((bVar19 != 0x6c ||
                          (__n = __s2_00 + 1, __s2_00 = __s2_00 + 2, *__n != 0x6c)))) ||
                        (0x20 < (byte)(*__s2_00 + 0xa8))) ||
                       ((uVar15 = 1 << (*__s2_00 + 0xa8 & 0x3f), (uVar15 & 0x120821001) == 0 &&
                        (((uVar15 & 0x800) == 0 || (iVar6 != 2)))))) goto LAB_00109e4d;
joined_r0x00109d25:
                    do {
                      if (bVar13 == 0x25) {
                        FUN_00111c10(param_1,
                                     "Too many format strings (should have at most one) for `%s\' with description `%s\'"
                                     ,*(undefined8 *)(&DAT_003205e0 + uVar28 * 8),puVar22);
                        goto LAB_00108d85;
                      }
                      __s1_00 = __s1_00 + 1;
                      bVar13 = *__s1_00;
                    } while (bVar13 != 0);
                    goto LAB_001096a0;
                  }
LAB_00109e4d:
                  __s2 = "too long";
                }
                FUN_00111c10(param_1,"Printf format is %s for type `%s\' in description `%s\'",__s2,
                             *(undefined8 *)(&DAT_003205e0 + uVar28 * 8));
              }
            }
            else {
              FUN_00111c10(param_1,"Internal error inconsistency between m->type and format strings"
                          );
            }
            goto LAB_00108d85;
          }
        }
      }
LAB_001096a0:
      if (param_2 == 1) {
        FUN_00111e30(puVar20);
      }
      *(undefined *)(puVar20 + 0x18) = 0;
      goto LAB_00108d90;
    }
    FUN_001139c0(local_a8,puVar22,1);
    if (__c == 0) {
      FUN_00113a80(local_a8);
      goto LAB_00109611;
    }
    if ((*(byte *)(param_1 + 0x38) & 0x40) != 0) {
      FUN_00113ab0(local_a8,(ulong)__c,param_1);
    }
    FUN_00113a80(local_a8);
  }
LAB_00108d85:
  *param_4 = *param_4 + 1;
LAB_00108d90:
  *(long *)(param_1 + 0x48) = *(long *)(param_1 + 0x48) + 1;
  goto LAB_00108be0;
LAB_00109c10:
  puVar29 = (undefined8 *)((long)puVar29 + 1);
  cVar27 = *(char *)puVar29;
  if (cVar27 == '\0') goto LAB_001096a0;
  goto joined_r0x00109c0b;
}



// WARNING: Type propagation algorithm not settling

void * FUN_0010a770(long param_1,char *param_2,uint param_3)

{
  void **__ptr;
  byte bVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  char *pcVar5;
  ushort **ppuVar6;
  ulong uVar7;
  void *__ptr_00;
  DIR *__dirp;
  dirent *pdVar8;
  ulong uVar9;
  size_t sVar10;
  ulong *puVar11;
  ulong **ppuVar12;
  long lVar13;
  size_t __size;
  void **ppvVar14;
  ulong **__base;
  ulong *__haystack;
  undefined *puVar15;
  char *pcVar16;
  ulong __nmemb;
  uint uVar17;
  long in_FS_OFFSET;
  undefined8 uVar18;
  long local_128;
  undefined4 *local_120;
  void *local_110;
  int local_104;
  char *local_100;
  undefined4 local_f8;
  undefined4 uStack244;
  uint auStack240 [4];
  undefined4 uStack224;
  undefined4 uStack220;
  stat local_d8;
  long local_40;
  
  *(uint *)(param_1 + 0x38) = *(uint *)(param_1 + 0x38) | 0x40;
  local_104 = 0;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_f8 = 0;
  uStack244 = 0;
  auStack240[0] = 0;
  auStack240[1] = 0;
  auStack240[2] = 0;
  auStack240[3] = 0;
  uStack224 = 0;
  uStack220 = 0;
  local_110 = calloc(1,0x30);
  if (local_110 == (void *)0x0) {
    FUN_00113100(param_1,0x30);
  }
  else {
    *(undefined4 *)((long)local_110 + 0x10) = 1;
    if (param_3 == 1) {
      fprintf(stderr,1,0x118722,"cont\toffset\ttype\topcode\tmask\tvalue\tdesc");
    }
    iVar2 = __xstat(1,param_2,&local_d8);
    if ((iVar2 == 0) && ((local_d8.st_mode & 0xf000) == 0x4000)) {
      __dirp = opendir(param_2);
      if (__dirp != (DIR *)0x0) {
        __ptr_00 = (void *)0x0;
        local_120 = (undefined4 *)0x0;
        __nmemb = 0;
        do {
          pdVar8 = readdir(__dirp);
          while( true ) {
            if (pdVar8 == (dirent *)0x0) {
              closedir(__dirp);
              qsort(__ptr_00,__nmemb,8,(__compar_fn_t)&LAB_001075e0);
              if (__nmemb != 0) {
                uVar9 = 0;
                do {
                  local_120 = (undefined4 *)&local_f8;
                  __ptr = (void **)((long)__ptr_00 + uVar9 * 8);
                  FUN_00108b40(param_1,(ulong)param_3,*__ptr,&local_104,local_120);
                  free(*__ptr);
                  uVar9 = (ulong)((int)uVar9 + 1);
                } while (uVar9 < __nmemb);
              }
              uVar18 = 0x10af18;
              free(__ptr_00);
              goto LAB_0010a839;
            }
            iVar2 = asprintf(&local_100,1,"%s/%s",param_2,pdVar8->d_name);
            if (iVar2 < 0) {
              __size = strlen(param_2);
              sVar10 = strlen(pdVar8->d_name);
              FUN_00113100(param_1,__size + 2 + sVar10);
              local_104 = local_104 + 1;
              closedir(__dirp);
              goto LAB_0010aac0;
            }
            iVar2 = __xstat(1,local_100,&local_d8);
            if ((iVar2 == -1) || ((local_d8.st_mode & 0xf000) != 0x8000)) break;
            if (local_120 <= __nmemb) {
              lVar13 = (long)local_120 + 1;
              local_120 = (undefined4 *)(lVar13 * 2);
              __size = lVar13 * 0x10;
              __ptr_00 = realloc(__ptr_00,__size);
              if (__ptr_00 == (void *)0x0) {
                FUN_00113100(param_1,__size);
                free(local_100);
                closedir(__dirp);
                goto LAB_0010aaae;
              }
            }
            *(char **)((long)__ptr_00 + __nmemb * 8) = local_100;
            __nmemb = __nmemb + 1;
            pdVar8 = readdir(__dirp);
          }
          free(local_100);
        } while( true );
      }
LAB_0010aaae:
      local_104 = local_104 + 1;
    }
    else {
      uVar18 = 0x10a839;
      FUN_00108b40(param_1,(ulong)param_3,param_2,&local_104,&local_f8);
LAB_0010a839:
      local_120 = (undefined4 *)&local_f8;
      if (local_104 == 0) {
        local_128 = 0;
        do {
          uVar17 = auStack240[local_128];
          __base = *(ulong ***)(local_120 + local_128);
          uVar4 = 0;
          while (uVar4 < uVar17) {
LAB_0010a86c:
            __nmemb = (ulong)uVar4;
            ppuVar12 = __base + __nmemb * 2;
            puVar11 = *ppuVar12;
            if (*(short *)puVar11 == 0) {
              uVar3 = uVar4 + 1;
              uVar9 = (ulong)uVar3;
              __haystack = puVar11;
              __base = ppuVar12;
              do {
                if (*(byte *)((long)__haystack + 6) < 0x31) {
                  uVar7 = 1 << (*(byte *)((long)__haystack + 6) & 0x3f);
                  if ((uVar7 & 0x11c7fffe1dfd6) == 0) {
                    if ((uVar7 & 0xc2020) == 0) {
                      if ((uVar7 & 0x120000) != 0) {
                        bVar1 = *(byte *)((long)puVar11 + 2);
                        if ((*(uint *)((long)puVar11 + 0x1c) & 0x40) != 0) {
                          bVar1 = bVar1 | 0x20;
                          *(byte *)((long)puVar11 + 2) = bVar1;
                        }
                        if ((*(uint *)((long)puVar11 + 0x1c) & 0x20) != 0) {
                          bVar1 = bVar1 | 0x40;
                          *(byte *)((long)puVar11 + 2) = bVar1;
                        }
                        if ((bVar1 & 0x60) == 0) {
                          uVar18 = 0x10acf1;
                          iVar2 = FUN_0010f8a0(__haystack + 4,(ulong)*(byte *)((long)__haystack + 5)
                                               ,0,0);
                          if (iVar2 < 1) goto LAB_0010aa55;
                          *(byte *)(short *)((long)puVar11 + 2) =
                               *(byte *)(short *)((long)puVar11 + 2) | 0x40;
                        }
                      }
                    }
                    else {
                      bVar1 = *(byte *)((long)puVar11 + 2) | 0x40;
                      if ((*(byte *)((long)puVar11 + 0x1c) & 0x20) == 0) {
                        bVar1 = *(byte *)((long)puVar11 + 2) | 0x20;
                      }
                      *(byte *)((long)puVar11 + 2) = bVar1;
                    }
                  }
                  else {
LAB_0010aa55:
                    *(byte *)(short *)((long)puVar11 + 2) =
                         *(byte *)(short *)((long)puVar11 + 2) | 0x20;
                  }
                }
                if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
                  puVar11 = *__base;
                  pcVar5 = "binary";
                  pcVar16 = "(no description)";
                  if ((*(byte *)((long)puVar11 + 2) & 0x20) == 0) {
                    pcVar5 = "text";
                  }
                  if (*(char *)(puVar11 + 0x10) != '\0') {
                    pcVar16 = (char *)(puVar11 + 0x10);
                  }
                  puVar15 = &DAT_00118717;
                  if (*(char *)(puVar11 + 0x18) == '\0') {
                    puVar15 = &DAT_0011ad97;
                  }
                  fprintf(stderr,1,"%s%s%s: %s\n",puVar11 + 0x18,puVar15,pcVar16,pcVar5,uVar18
                               );
                  if ((*(byte *)((long)*__base + 2) & 0x20) != 0) {
                    __haystack = *__base + 0x10;
                    uVar18 = 0x10a994;
                    puVar11 = (ulong *)strstr((char *)__haystack,"text");
                    if (puVar11 != (ulong *)0x0) {
                      if (__haystack != puVar11) {
                        uVar18 = 0x10a9ab;
                        ppuVar6 = __ctype_b_loc();
                        if ((*(byte *)((long)*ppuVar6 + (ulong)*(byte *)((long)puVar11 + -1) * 2 + 1
                                      ) & 0x20) == 0) goto LAB_0010aa00;
                      }
                      if (((ulong *)((long)puVar11 + -0x5b) != __haystack) &&
                         (bVar1 = *(byte *)((long)puVar11 + 5), bVar1 != 0)) {
                        uVar18 = 0x10a9d5;
                        ppuVar6 = __ctype_b_loc();
                        if ((*(byte *)((long)*ppuVar6 + (ulong)bVar1 * 2 + 1) & 0x20) == 0)
                        goto LAB_0010aa00;
                      }
                      uVar18 = 0x10a9ff;
                      fwrite("*** Possible binary test for text type\n",1,0x27,stderr);
                    }
                  }
                }
LAB_0010aa00:
                uVar4 = (uint)uVar9;
                if (uVar4 == uVar17) goto LAB_0010ab70;
                __haystack = __base[__nmemb * 0x1ffffffffffffffe + (ulong)uVar3 * 2];
                if (*(short *)__haystack == 0) goto LAB_0010ab70;
                puVar11 = *ppuVar12;
                uVar9 = (ulong)(uVar4 + 1);
                __base = __base + 2;
              } while( true );
            }
            uVar4 = uVar4 + 1;
          }
LAB_0010ab8c:
          if (__base != (ulong **)0x0) {
            qsort(__base,(ulong)uVar17,0x10,(__compar_fn_t)&LAB_00107920);
            uVar17 = auStack240[local_128];
            __base = *(ulong ***)(local_120 + local_128);
          }
          if (uVar17 == 0) {
LAB_0010ad80:
            uVar18 = 0x10ad87;
            __ptr_00 = malloc(0);
            *(void **)((long)local_110 + local_128 * 2 + 0x18) = __ptr_00;
            if (__ptr_00 == (void *)0x0) {
              __size = 0;
              goto LAB_0010afaa;
            }
            uVar4 = 0;
          }
          else {
            if ((**__base & 0xff00000000ffff) == 0x3000000000000) {
              uVar4 = 0;
            }
            else {
              uVar4 = 0;
              ppuVar12 = __base;
              do {
                ppuVar12 = ppuVar12 + 2;
                uVar4 = uVar4 + 1;
                if (uVar17 == uVar4) goto LAB_0010ac16;
              } while ((**ppuVar12 & 0xff00000000ffff) != 0x3000000000000);
            }
            __nmemb = (ulong)(uVar4 + 1);
            ppuVar12 = __base + __nmemb * 2;
            while( true ) {
              uVar4 = (uint)__nmemb;
              if (uVar17 <= uVar4) break;
              puVar11 = *ppuVar12;
              ppuVar12 = ppuVar12 + 2;
              if (*(short *)puVar11 == 0) goto LAB_0010ad48;
              __nmemb = (ulong)(uVar4 + 1);
            }
            if (uVar17 != uVar4) {
              puVar11 = __base[__nmemb * 2];
LAB_0010ad48:
              *(ulong *)(param_1 + 0x48) = (ulong)*(uint *)((long)puVar11 + 0x14);
              FUN_00111c10(param_1,"level 0 \"default\" did not sort last");
              uVar17 = auStack240[local_128];
              __base = *(ulong ***)(local_120 + local_128);
              if (uVar17 == 0) goto LAB_0010ad80;
            }
LAB_0010ac16:
            __nmemb = 0;
            uVar4 = 0;
            ppuVar12 = __base + 1;
            do {
              uVar4 = uVar4 + 1;
              __nmemb = (ulong)((int)__nmemb + *(uint *)ppuVar12);
              ppuVar12 = ppuVar12 + 2;
            } while (uVar4 < uVar17);
            __size = __nmemb * 0x158;
            __ptr_00 = malloc(__size);
            *(void **)((long)local_110 + local_128 * 2 + 0x18) = __ptr_00;
            if (__ptr_00 == (void *)0x0) {
LAB_0010afaa:
              FUN_00113100(param_1,__size);
              local_104 = local_104 + 1;
              break;
            }
            uVar4 = 0;
            ppuVar12 = __base + 1;
            while( true ) {
              uVar18 = 0x10ac9a;
              memcpy((void *)((ulong)uVar4 * 0x158 + (long)__ptr_00),ppuVar12[-1],
                     (ulong)*(uint *)ppuVar12 * 0x158);
              uVar4 = uVar4 + *(uint *)ppuVar12;
              if (__base + (ulong)(uVar17 - 1) * 2 + 3 == ppuVar12 + 2) break;
              __ptr_00 = *(void **)((long)local_110 + local_128 * 2 + 0x18);
              ppuVar12 = ppuVar12 + 2;
            }
          }
          *(uint *)((long)local_110 + local_128 + 0x28) = uVar4;
          local_128 = local_128 + 4;
        } while (local_128 != 8);
      }
    }
LAB_0010aac0:
    lVar13 = 0;
    do {
      __ptr = *(void ***)((long)&local_f8 + lVar13);
      if (__ptr != (void **)0x0) {
        iVar2 = *(int *)((long)auStack240 + lVar13);
        if (iVar2 != 0) {
          ppvVar14 = __ptr;
          do {
            __ptr_00 = *ppvVar14;
            ppvVar14 = ppvVar14 + 2;
            free(__ptr_00);
          } while (__ptr + (ulong)(iVar2 - 1) * 2 + 2 != ppvVar14);
        }
        free(__ptr);
      }
      lVar13 = lVar13 + 0x10;
    } while (lVar13 != 0x20);
    if (local_104 != 0) {
      FUN_00106fb0(local_110);
      local_110 = (void *)0x0;
    }
  }
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return local_110;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
LAB_0010ab70:
  uVar17 = auStack240[local_128];
  __base = *(ulong ***)(local_120 + local_128);
  if (uVar17 <= uVar4) goto LAB_0010ab8c;
  goto LAB_0010a86c;
}



ulong FUN_0010b5b0(long param_1,uint *param_2)

{
  uint uVar1;
  long lVar2;
  ulong uVar3;
  
  uVar1 = *(uint *)(param_1 + 0x1c) & 0xf80;
  if (uVar1 == 0x200) {
    uVar3 = (ulong)*(ushort *)param_2;
  }
  else {
    if (uVar1 < 0x201) {
      if (uVar1 == 0x80) {
        uVar3 = (ulong)*(byte *)param_2;
      }
      else {
        if (uVar1 != 0x100) goto LAB_0010b62d;
        uVar3 = (ulong)(ushort)(*(ushort *)param_2 << 8 | *(ushort *)param_2 >> 8);
      }
    }
    else {
      if (uVar1 == 0x400) {
        uVar1 = *param_2;
        uVar3 = SEXT48((int)(uVar1 >> 0x18 | (uVar1 & 0xff0000) >> 8 | (uVar1 & 0xff00) << 8 |
                            uVar1 << 0x18));
      }
      else {
        if (uVar1 != 0x800) {
LAB_0010b62d:
                    // WARNING: Subroutine does not return
          abort();
        }
        uVar3 = SEXT48((int)*param_2);
      }
    }
  }
  if ((*(uint *)(param_1 + 0x1c) & 0x1000) != 0) {
    lVar2 = FUN_00108ae0(0);
    uVar3 = uVar3 - lVar2;
  }
  return uVar3;
}



undefined8 FUN_0010b640(long param_1,char *param_2,long *param_3)

{
  short sVar1;
  uint uVar2;
  long *plVar3;
  long lVar4;
  long *plVar5;
  int iVar6;
  undefined4 extraout_var;
  long lVar7;
  short *psVar8;
  uint uVar9;
  int iVar10;
  uint uVar11;
  
  plVar3 = *(long **)(param_1 + 8);
  plVar5 = (long *)plVar3[3];
  do {
    if (plVar3 == plVar5) {
      return 0xffffffff;
    }
    uVar2 = *(uint *)(plVar5 + 1);
    lVar4 = *plVar5;
    if (uVar2 != 0) {
      uVar11 = 0;
      lVar7 = lVar4;
      do {
        if (*(char *)(lVar7 + 6) == '-') {
          iVar6 = strcmp((char *)(lVar7 + 0x20),param_2);
          if (iVar6 == 0) {
            uVar9 = uVar11 + 1;
            *param_3 = lVar7;
            if ((uVar9 < uVar2) && (*(short *)(lVar4 + (ulong)uVar9 * 0x158) != 0)) {
              psVar8 = (short *)(lVar4 + (ulong)(uVar11 + 2) * 0x158);
              goto LAB_0010b711;
            }
            iVar10 = 1;
            goto LAB_0010b71c;
          }
        }
        uVar11 = uVar11 + 1;
        lVar7 = lVar7 + 0x158;
      } while (uVar2 != uVar11);
    }
    plVar5 = (long *)plVar5[3];
  } while( true );
  while (sVar1 = *psVar8, psVar8 = psVar8 + 0xac, sVar1 != 0) {
LAB_0010b711:
    uVar9 = uVar9 + 1;
    if (uVar2 <= uVar9) break;
  }
  iVar10 = uVar9 - uVar11;
LAB_0010b71c:
  *(int *)(param_3 + 1) = iVar10;
  return CONCAT44(extraout_var,iVar6);
}



ulong FUN_0010b740(long param_1,long param_2,int param_3)

{
  uint uVar1;
  int iVar2;
  undefined *puVar3;
  
  uVar1 = *(uint *)(param_1 + 0x38);
  if (((uVar1 & 0x800) == 0) || (*(char *)(param_2 + 0x110) == '\0')) {
    if (((uVar1 & 0x1000000) == 0) || (*(char *)(param_2 + 0x118) == '\0')) {
      if ((uVar1 & 0x10) == 0) {
        return (ulong)(uVar1 & 0x10);
      }
      if (*(char *)(param_2 + 0xc0) == '\0') {
        return 0;
      }
      if ((param_3 == 0) && (iVar2 = FUN_00112ee0(param_1,&DAT_00119dc8), iVar2 == -1)) {
        return 0xffffffff;
      }
      param_2 = param_2 + 0xc0;
    }
    else {
      if ((param_3 == 0) && (iVar2 = FUN_00112ee0(param_1,&DAT_00119dc8), iVar2 == -1)) {
        return 0xffffffff;
      }
      param_2 = param_2 + 0x118;
    }
    puVar3 = (undefined *)0x11ad2b;
  }
  else {
    if ((param_3 == 0) && (iVar2 = FUN_00112ee0(param_1,&DAT_00119dc8), iVar2 == -1)) {
      return 0xffffffff;
    }
    param_2 = param_2 + 0x110;
    puVar3 = &DAT_00119dc3;
  }
  iVar2 = FUN_00112ee0(param_1,puVar3,param_2);
  if (iVar2 == -1) {
    return 0xffffffff;
  }
  return 1;
}



ulong FUN_0010b840(undefined8 param_1,long param_2)

{
  uint uVar1;
  int iVar2;
  char *pcVar3;
  ulong uVar4;
  long in_FS_OFFSET;
  undefined auStack152 [104];
  long local_30;
  
  uVar4 = 0;
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  pcVar3 = strchr((char *)(param_2 + 0x80),0x25);
  if (pcVar3 != (char *)0x0) {
    FUN_001139c0(auStack152,"%[-0-9\\.]*s",9);
    if (uVar1 == 0) {
      FUN_00113a60(auStack152,(char *)(param_2 + 0x80),0,0,0);
      uVar4 = (ulong)(iVar2 == 0);
    }
    else {
      FUN_00113ab0(auStack152,(ulong)uVar1,param_1);
      uVar4 = 0xffffffff;
    }
    FUN_00113a80(auStack152);
  }
  if (local_30 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar4;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 FUN_0010b900(long param_1,long param_2,ulong param_3,int *param_4)

{
  int iVar1;
  undefined8 uVar2;
  ulong uVar3;
  size_t sVar4;
  int iVar5;
  
  switch(*(undefined *)(param_2 + 6)) {
  default:
    iVar5 = 0;
    goto LAB_0010b952;
  case 1:
    iVar5 = *(int *)(param_1 + 0x30) + 1;
    uVar3 = SEXT48(iVar5);
    break;
  case 2:
  case 7:
  case 10:
    iVar5 = *(int *)(param_1 + 0x30) + 2;
    uVar3 = SEXT48(iVar5);
    break;
  case 3:
  case 0x29:
  case 0x2f:
    iVar5 = *(int *)(param_1 + 0x30);
    uVar3 = SEXT48(iVar5);
    break;
  case 4:
  case 6:
  case 8:
  case 9:
  case 0xb:
  case 0xc:
  case 0xe:
  case 0xf:
  case 0x10:
  case 0x15:
  case 0x16:
  case 0x17:
  case 0x21:
  case 0x22:
  case 0x23:
    iVar5 = *(int *)(param_1 + 0x30) + 4;
    uVar3 = SEXT48(iVar5);
    break;
  case 5:
  case 0xd:
  case 0x12:
  case 0x13:
    iVar5 = *(int *)(param_1 + 0x30);
    if ((*(char *)(param_2 + 4) == '=') || (*(char *)(param_2 + 4) == '!')) {
      iVar5 = (uint)*(byte *)(param_2 + 5) + iVar5;
      uVar3 = SEXT48(iVar5);
    }
    else {
      if (*(char *)(param_2 + 0x20) == '\0') {
        sVar4 = strcspn((char *)(param_1 + 0x70),"\r\n");
        *(undefined *)(param_1 + 0x70 + sVar4) = 0;
      }
      sVar4 = strlen((char *)(param_1 + 0x70));
      iVar5 = iVar5 + (int)sVar4;
      if (*(char *)(param_2 + 6) == '\r') {
        iVar1 = FUN_00108ae0(param_2);
        iVar5 = iVar5 + iVar1;
      }
      uVar3 = SEXT48(iVar5);
    }
    break;
  case 0x11:
    iVar5 = (int)*(undefined8 *)(param_1 + 0x60);
    if ((*(byte *)(param_2 + 0x1c) & 0x10) == 0) {
      iVar5 = iVar5 + *(int *)(param_1 + 0x68);
      uVar3 = SEXT48(iVar5);
    }
    else {
      uVar3 = SEXT48(iVar5);
    }
    break;
  case 0x14:
    iVar5 = (int)*(undefined8 *)(param_1 + 0x60);
    if ((*(byte *)(param_2 + 0x1c) & 0x10) == 0) {
      iVar5 = (uint)*(byte *)(param_2 + 5) + iVar5;
      uVar3 = SEXT48(iVar5);
    }
    else {
      uVar3 = SEXT48(iVar5);
    }
    break;
  case 0x18:
  case 0x19:
  case 0x1a:
  case 0x1b:
  case 0x1c:
  case 0x1d:
  case 0x1e:
  case 0x1f:
  case 0x20:
  case 0x24:
  case 0x25:
  case 0x26:
    iVar5 = *(int *)(param_1 + 0x30) + 8;
    uVar3 = SEXT48(iVar5);
    break;
  case 0x30:
    uVar3 = FUN_00113ea0(param_1,param_2,param_3);
    iVar5 = (int)(uVar3 & 0xffffffff);
    if (((int)uVar3 == -1) || (param_3 < (ulong)(long)(int)uVar3)) {
      if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
        fprintf(stderr,1,"Bad DER offset %d nbytes=%zu",uVar3 & 0xffffffff,param_3);
      }
      *param_4 = 0;
      return 0;
    }
    goto LAB_0010b952;
  }
  if (param_3 < uVar3) {
    uVar2 = 0xffffffff;
  }
  else {
LAB_0010b952:
    *param_4 = iVar5;
    uVar2 = 1;
  }
  return uVar2;
}



ulong FUN_0010baf0(ulong param_1,uint param_2)

{
  uint uVar1;
  
  uVar1 = param_2 >> 1 & 0x3f80 | param_2 >> 2 & 0x1fc000 | param_2 & 0x7f |
          param_2 >> 3 & 0xfe00000;
  if ((param_1 & 1) != 0) {
    fprintf(stderr,1,"id3 offs=%u\n",(ulong)uVar1);
  }
  return (ulong)uVar1;
}



ulong FUN_0010bb50(uint param_1)

{
  switch(param_1) {
  case 7:
    return 10;
  case 8:
    return 0xb;
  case 9:
    return 0xc;
  case 10:
    return 7;
  case 0xb:
    return 8;
  case 0xc:
    return 9;
  default:
    return (ulong)param_1;
  case 0xf:
    return 0x10;
  case 0x10:
    return 0xf;
  case 0x19:
    return 0x1a;
  case 0x1a:
    return 0x19;
  case 0x1c:
    return 0x1d;
  case 0x1d:
    return 0x1c;
  case 0x1f:
    return 0x20;
  case 0x20:
    return 0x1f;
  case 0x22:
    return 0x23;
  case 0x23:
    return 0x22;
  case 0x25:
    return 0x26;
  case 0x26:
    return 0x25;
  case 0x2b:
    return 0x2c;
  case 0x2c:
    return 0x2b;
  }
}



undefined8 FUN_0010bcc0(ushort *param_1,byte *param_2,long param_3)

{
  ushort uVar1;
  byte bVar2;
  
  bVar2 = *param_2;
  if (param_3 != 0) {
    uVar1 = (ushort)param_3;
    switch((uint)bVar2 & 7) {
    case 0:
      *param_1 = *param_1 & uVar1;
      bVar2 = *param_2;
      break;
    case 1:
      *param_1 = *param_1 | uVar1;
      bVar2 = *param_2;
      break;
    case 2:
      *param_1 = *param_1 ^ uVar1;
      bVar2 = *param_2;
      break;
    case 3:
      *param_1 = *param_1 + uVar1;
      bVar2 = *param_2;
      break;
    case 4:
      *param_1 = *param_1 - uVar1;
      bVar2 = *param_2;
      break;
    case 5:
      *param_1 = uVar1 * *param_1;
      bVar2 = *param_2;
      break;
    case 6:
      if (uVar1 == 0) {
        return 0xffffffff;
      }
      *param_1 = *param_1 / uVar1;
      bVar2 = *param_2;
      break;
    case 7:
      if (uVar1 == 0) {
        return 0xffffffff;
      }
      *param_1 = *param_1 % uVar1;
      bVar2 = *param_2;
    }
  }
  if ((bVar2 & 0x40) != 0) {
    *param_1 = ~*param_1;
    return 0;
  }
  return 0;
}



undefined8 FUN_0010bd90(uint *param_1,byte *param_2,ulong param_3)

{
  byte bVar1;
  uint uVar2;
  
  bVar1 = *param_2;
  if (param_3 != 0) {
    uVar2 = (uint)param_3;
    switch((uint)bVar1 & 7) {
    case 0:
      *param_1 = *param_1 & uVar2;
      bVar1 = *param_2;
      break;
    case 1:
      *param_1 = *param_1 | uVar2;
      bVar1 = *param_2;
      break;
    case 2:
      *param_1 = *param_1 ^ uVar2;
      bVar1 = *param_2;
      break;
    case 3:
      *param_1 = *param_1 + uVar2;
      bVar1 = *param_2;
      break;
    case 4:
      *param_1 = *param_1 - uVar2;
      bVar1 = *param_2;
      break;
    case 5:
      *param_1 = uVar2 * *param_1;
      bVar1 = *param_2;
      break;
    case 6:
      if (uVar2 == 0) {
        return 0xffffffff;
      }
      *param_1 = (uint)((ulong)*param_1 / (param_3 & 0xffffffff));
      bVar1 = *param_2;
      break;
    case 7:
      if (uVar2 == 0) {
        return 0xffffffff;
      }
      *param_1 = (uint)((ulong)*param_1 % (param_3 & 0xffffffff));
      bVar1 = *param_2;
    }
  }
  if ((bVar1 & 0x40) != 0) {
    *param_1 = ~*param_1;
    return 0;
  }
  return 0;
}



undefined8 FUN_0010be50(ulong *param_1,byte *param_2,ulong param_3)

{
  ulong uVar1;
  byte bVar2;
  
  bVar2 = *param_2;
  if (param_3 != 0) {
    uVar1 = *param_1;
    switch((uint)bVar2 & 7) {
    case 0:
      *param_1 = param_3 & uVar1;
      bVar2 = *param_2;
      break;
    case 1:
      *param_1 = param_3 | uVar1;
      bVar2 = *param_2;
      break;
    case 2:
      *param_1 = param_3 ^ uVar1;
      bVar2 = *param_2;
      break;
    case 3:
      *param_1 = param_3 + uVar1;
      bVar2 = *param_2;
      break;
    case 4:
      *param_1 = uVar1 - param_3;
      bVar2 = *param_2;
      break;
    case 5:
      *param_1 = param_3 * uVar1;
      bVar2 = *param_2;
      break;
    case 6:
      *param_1 = uVar1 / param_3;
      bVar2 = *param_2;
      break;
    case 7:
      *param_1 = uVar1 % param_3;
      bVar2 = *param_2;
    }
  }
  if ((bVar2 & 0x40) != 0) {
    *param_1 = ~*param_1;
  }
  return 0;
}



undefined8 FUN_0010bf10(float *param_1,byte param_2,ulong param_3)

{
  uint uVar1;
  float fVar2;
  
  if (param_3 == 0) {
    return 0;
  }
  param_2 = param_2 & 7;
  uVar1 = (uint)param_3;
  if (param_2 == 4) {
    if ((long)param_3 < 0) {
      fVar2 = (float)(param_3 >> 1 | (ulong)(uVar1 & 1));
      fVar2 = fVar2 + fVar2;
    }
    else {
      fVar2 = (float)param_3;
    }
    *param_1 = *param_1 - fVar2;
    return 0;
  }
  if (param_2 < 5) {
    if (param_2 == 3) {
      if ((long)param_3 < 0) {
        fVar2 = (float)(param_3 >> 1 | (ulong)(uVar1 & 1));
        fVar2 = fVar2 + fVar2;
      }
      else {
        fVar2 = (float)param_3;
      }
      *param_1 = fVar2 + *param_1;
      return 0;
    }
  }
  else {
    if (param_2 == 5) {
      if ((long)param_3 < 0) {
        fVar2 = (float)(param_3 >> 1 | (ulong)(uVar1 & 1));
        fVar2 = fVar2 + fVar2;
      }
      else {
        fVar2 = (float)param_3;
      }
      *param_1 = fVar2 * *param_1;
      return 0;
    }
    if (param_2 == 6) {
      if ((long)param_3 < 0) {
        fVar2 = (float)(param_3 >> 1 | (ulong)(uVar1 & 1));
        fVar2 = fVar2 + fVar2;
      }
      else {
        fVar2 = (float)param_3;
      }
      if (fVar2 == 0.00000000) {
        return 0xffffffff;
      }
      *param_1 = *param_1 / fVar2;
      return 0;
    }
  }
  return 0;
}



undefined8 FUN_0010c070(double *param_1,byte param_2,ulong param_3)

{
  uint uVar1;
  double dVar2;
  
  if (param_3 == 0) {
    return 0;
  }
  param_2 = param_2 & 7;
  uVar1 = (uint)param_3;
  if (param_2 == 4) {
    if ((long)param_3 < 0) {
      dVar2 = (double)(param_3 >> 1 | (ulong)(uVar1 & 1));
      dVar2 = dVar2 + dVar2;
    }
    else {
      dVar2 = (double)param_3;
    }
    *param_1 = *param_1 - dVar2;
    return 0;
  }
  if (param_2 < 5) {
    if (param_2 == 3) {
      if ((long)param_3 < 0) {
        dVar2 = (double)(param_3 >> 1 | (ulong)(uVar1 & 1));
        dVar2 = dVar2 + dVar2;
      }
      else {
        dVar2 = (double)param_3;
      }
      *param_1 = dVar2 + *param_1;
      return 0;
    }
  }
  else {
    if (param_2 == 5) {
      if ((long)param_3 < 0) {
        dVar2 = (double)(param_3 >> 1 | (ulong)(uVar1 & 1));
        dVar2 = dVar2 + dVar2;
      }
      else {
        dVar2 = (double)param_3;
      }
      *param_1 = dVar2 * *param_1;
      return 0;
    }
    if (param_2 == 6) {
      if ((long)param_3 < 0) {
        dVar2 = (double)(param_3 >> 1 | (ulong)(uVar1 & 1));
        dVar2 = dVar2 + dVar2;
      }
      else {
        dVar2 = (double)param_3;
      }
      if (dVar2 == 0.00000000) {
        return 0xffffffff;
      }
      *param_1 = *param_1 / dVar2;
      return 0;
    }
  }
  return 0;
}



ulong FUN_0010c1d0(ulong param_1,ulong param_2,ulong param_3)

{
  if (param_3 != 0) {
    switch((uint)param_1 & 7) {
    case 0:
      param_2 = param_2 & param_3;
      break;
    case 1:
      param_2 = param_2 | param_3;
      break;
    case 2:
      param_2 = param_2 ^ param_3;
      break;
    case 3:
      param_2 = param_2 + param_3;
      break;
    case 4:
      param_2 = param_2 - param_3;
      break;
    case 5:
      param_2 = param_2 * param_3;
      break;
    case 6:
      param_2 = (long)param_2 / (long)param_3;
      break;
    case 7:
      param_2 = (long)param_2 % param_3;
    }
  }
  if ((param_1 & 0x40) != 0) {
    param_2 = ~param_2;
  }
  return param_2 & 0xffffffff;
}



undefined8
FUN_0010c250(long param_1,undefined8 *param_2,int param_3,int param_4,long param_5,uint param_6,
            ulong param_7,uint *param_8,uint *param_9)

{
  undefined auVar1 [16];
  char cVar2;
  uint uVar3;
  void *pvVar4;
  ulong uVar5;
  char *pcVar6;
  char *pcVar7;
  ulong uVar8;
  ulong uVar9;
  char *__s;
  undefined *__src;
  undefined8 *puVar10;
  char *pcVar11;
  bool bVar12;
  byte bVar13;
  
  bVar13 = 0;
  if (param_4 == 0) {
    switch(param_3) {
    case 0x11:
      if (param_5 == 0) {
        *(undefined8 *)(param_1 + 0x58) = 0;
        *(undefined8 *)(param_1 + 0x50) = 0;
      }
      else {
        uVar5 = (ulong)*param_8;
        bVar12 = (*param_9 & 0x800) != 0;
        if (bVar12) {
          uVar8 = uVar5 * 0x50;
        }
        else {
          uVar8 = uVar5;
          uVar5 = 0;
        }
        uVar9 = (ulong)param_6;
        param_7 = param_7 - uVar9;
        if ((uVar8 != 0) && (uVar8 < param_7)) {
          param_7 = uVar8;
        }
        pcVar7 = (char *)(param_5 + uVar9);
        if ((ulong)*(ushort *)(param_1 + 0xda) <= param_7) {
          param_7 = (ulong)*(ushort *)(param_1 + 0xda);
        }
        pcVar11 = (char *)(uVar9 + param_7 + param_5);
        pcVar6 = pcVar11;
        if ((pcVar7 < pcVar11) && (__s = pcVar7, bVar12 && *param_8 != 0)) {
          do {
            pcVar6 = (char *)memchr(__s,10,(size_t)(pcVar11 + -(long)__s));
            if ((pcVar6 == (char *)0x0) &&
               (pcVar6 = (char *)memchr(__s,0xd,(size_t)(pcVar11 + -(long)__s)),
               pcVar6 == (char *)0x0)) goto LAB_0010c561;
            __s = pcVar6 + 1;
            if ((*pcVar6 == '\r') && (pcVar6[1] == '\n')) {
              __s = pcVar6 + 2;
            }
            uVar5 = uVar5 - 1;
          } while (uVar5 != 0 && __s < pcVar11);
        }
        if (uVar5 != 0) {
LAB_0010c561:
          pcVar6 = (char *)(param_7 + param_5);
        }
        *(undefined8 *)(param_1 + 0x68) = 0;
        *(char **)(param_1 + 0x50) = pcVar7;
        *(char **)(param_1 + 0x58) = pcVar6 + -(long)pcVar7;
        *(ulong *)(param_1 + 0x60) = uVar9;
      }
      break;
    case 0x12:
    case 0x13:
      pcVar7 = (char *)(param_5 + (ulong)param_6 + (ulong)(param_3 == 0x12));
      if ((ulong)param_6 < param_7) {
        if (pcVar7 < (char *)(param_5 + param_7)) {
          puVar10 = param_2;
          do {
            cVar2 = *pcVar7;
            *(char *)puVar10 = cVar2;
            if (cVar2 == '\0') {
              if (param_3 == 0x12) {
                cVar2 = pcVar7[-1];
              }
              else {
                cVar2 = pcVar7[1];
              }
              if (cVar2 != '\0') {
                *(undefined *)puVar10 = 0x20;
              }
            }
            puVar10 = (undefined8 *)((long)puVar10 + 1);
            pcVar7 = pcVar7 + 2;
          } while ((puVar10 < (undefined8 *)((long)param_2 + 0x5f)) &&
                  (pcVar7 < (char *)(param_5 + param_7)));
        }
        *(undefined *)((long)param_2 + 0x5f) = 0;
        return 0;
      }
      goto LAB_0010c2f8;
    case 0x14:
    case 0x30:
      uVar5 = (ulong)param_6;
      if (param_7 < (ulong)param_6) {
        uVar5 = param_7 & 0xffffffff;
      }
      *(ulong *)(param_1 + 0x60) = uVar5;
      *(long *)(param_1 + 0x58) = param_7 - uVar5;
      *(long *)(param_1 + 0x50) = param_5 + uVar5;
      break;
    default:
      goto switchD_0010c286_caseD_15;
    }
  }
  else {
switchD_0010c286_caseD_15:
    uVar5 = (ulong)param_6;
    if (uVar5 < param_7) {
      param_7 = param_7 - uVar5;
      __src = (undefined *)(uVar5 + param_5);
      if (0x5f < param_7) {
                    // WARNING: Load size is inaccurate
        auVar1[0] = *(undefined *)__src;
        *(int *)param_2 = SUB164(auVar1,0);
        *(undefined4 *)((long)param_2 + 4) = SUB164(auVar1[0] >> 0x20,0);
        *(int *)(param_2 + 1) = SUB164(auVar1[0] >> 0x40,0);
        *(undefined4 *)((long)param_2 + 0xc) = SUB164(auVar1[0] >> 0x60,0);
                    // WARNING: Load size is inaccurate
        auVar1[0] = *(undefined *)(__src + 0x10);
        *(int *)(param_2 + 2) = SUB164(auVar1,0);
        *(undefined4 *)((long)param_2 + 0x14) = SUB164(auVar1[0] >> 0x20,0);
        *(int *)(param_2 + 3) = SUB164(auVar1[0] >> 0x40,0);
        *(undefined4 *)((long)param_2 + 0x1c) = SUB164(auVar1[0] >> 0x60,0);
                    // WARNING: Load size is inaccurate
        auVar1[0] = *(undefined *)(__src + 0x20);
        *(int *)(param_2 + 4) = SUB164(auVar1[0],0);
        *(undefined4 *)((long)param_2 + 0x24) = SUB164(auVar1[0] >> 0x20,0);
        *(int *)(param_2 + 5) = SUB164(auVar1[0] >> 0x40,0);
        *(undefined4 *)((long)param_2 + 0x2c) = SUB164(auVar1[0] >> 0x60,0);
                    // WARNING: Load size is inaccurate
        auVar1[0] = *(undefined *)(__src + 0x30);
        *(int *)(param_2 + 6) = SUB164(auVar1,0);
        *(undefined4 *)((long)param_2 + 0x34) = SUB164(auVar1[0] >> 0x20,0);
        *(int *)(param_2 + 7) = SUB164(auVar1[0] >> 0x40,0);
        *(undefined4 *)((long)param_2 + 0x3c) = SUB164(auVar1[0] >> 0x60,0);
                    // WARNING: Load size is inaccurate
        auVar1[0] = *(undefined *)(__src + 0x40);
        *(int *)(param_2 + 8) = SUB164(auVar1,0);
        *(undefined4 *)((long)param_2 + 0x44) = SUB164(auVar1[0] >> 0x20,0);
        *(int *)(param_2 + 9) = SUB164(auVar1[0] >> 0x40,0);
        *(undefined4 *)((long)param_2 + 0x4c) = SUB164(auVar1[0] >> 0x60,0);
                    // WARNING: Load size is inaccurate
        auVar1[0] = *(undefined *)(__src + 0x50);
        *(int *)(param_2 + 10) = SUB164(auVar1,0);
        *(undefined4 *)((long)param_2 + 0x54) = SUB164(auVar1[0] >> 0x20,0);
        *(int *)(param_2 + 0xb) = SUB164(auVar1[0] >> 0x40,0);
        *(undefined4 *)((long)param_2 + 0x5c) = SUB164(auVar1[0] >> 0x60,0);
        return 0;
      }
      pvVar4 = memcpy(param_2,__src,param_7);
      uVar5 = 0x60 - param_7;
      puVar10 = (undefined8 *)((long)pvVar4 + param_7);
      uVar3 = (uint)uVar5;
      if (7 < uVar3) {
        *puVar10 = 0;
        *(undefined8 *)((long)puVar10 + ((uVar5 & 0xffffffff) - 8)) = 0;
        uVar5 = (ulong)(((int)puVar10 -
                        (int)(undefined8 *)((ulong)(puVar10 + 1) & 0xfffffffffffffff8)) + uVar3 >> 3
                       );
        puVar10 = (undefined8 *)((ulong)(puVar10 + 1) & 0xfffffffffffffff8);
        while (uVar5 != 0) {
          uVar5 = uVar5 - 1;
          *puVar10 = 0;
          puVar10 = puVar10 + (ulong)bVar13 * 0x1ffffffffffffffe + 1;
        }
        return 0;
      }
      if ((uVar5 & 4) != 0) {
        *(undefined4 *)puVar10 = 0;
        *(undefined4 *)((long)puVar10 + ((uVar5 & 0xffffffff) - 4)) = 0;
        return 0;
      }
      if (uVar3 == 0) {
        return 0;
      }
      *(undefined *)puVar10 = 0;
      if ((uVar5 & 2) == 0) {
        return 0;
      }
      *(undefined2 *)((long)puVar10 + ((uVar5 & 0xffffffff) - 2)) = 0;
      return 0;
    }
LAB_0010c2f8:
    *param_2 = 0;
    param_2[0xb] = 0;
    uVar5 = (ulong)(((int)param_2 - (int)(undefined8 *)((ulong)(param_2 + 1) & 0xfffffffffffffff8))
                    + 0x60U >> 3);
    puVar10 = (undefined8 *)((ulong)(param_2 + 1) & 0xfffffffffffffff8);
    while (uVar5 != 0) {
      uVar5 = uVar5 - 1;
      *puVar10 = 0;
      puVar10 = puVar10 + 1;
    }
  }
  return 0;
}



long FUN_0010c5d0(byte *param_1,byte *param_2,long param_3,uint param_4)

{
  byte bVar1;
  byte bVar2;
  ushort *puVar3;
  int iVar4;
  ushort **ppuVar5;
  __int32_t **pp_Var6;
  byte *pbVar7;
  ulong uVar8;
  ulong uVar9;
  byte *pbVar10;
  
  if (param_4 == 0) {
    pbVar10 = param_1;
    do {
      if (pbVar10 == param_1 + param_3) {
        return 0;
      }
      bVar1 = *param_2;
      bVar2 = *pbVar10;
      param_2 = param_2 + 1;
      pbVar10 = pbVar10 + 1;
    } while ((long)(int)((uint)bVar1 - (uint)bVar2) == 0);
    return (long)(int)((uint)bVar1 - (uint)bVar2);
  }
  pbVar10 = param_1 + param_3;
LAB_0010c610:
  if (param_1 == pbVar10) {
    return 0;
  }
  do {
    bVar1 = *param_1;
    uVar9 = (ulong)bVar1;
    param_1 = param_1 + 1;
    bVar2 = *param_2;
    uVar8 = (ulong)bVar2;
    if (((param_4 & 4) != 0) &&
       (ppuVar5 = __ctype_b_loc(), (*(byte *)((long)*ppuVar5 + uVar9 * 2 + 1) & 2) != 0)) {
      pp_Var6 = __ctype_tolower_loc();
LAB_0010c642:
      iVar4 = (*pp_Var6)[uVar8] - (uint)bVar1;
      goto joined_r0x0010c653;
    }
    if (((param_4 & 8) != 0) &&
       (ppuVar5 = __ctype_b_loc(), (*(byte *)((long)*ppuVar5 + uVar9 * 2 + 1) & 1) != 0)) {
      pp_Var6 = __ctype_toupper_loc();
      goto LAB_0010c642;
    }
    if ((param_4 & 1) == 0) break;
    ppuVar5 = __ctype_b_loc();
    puVar3 = *ppuVar5;
    if ((*(byte *)((long)puVar3 + uVar9 * 2 + 1) & 0x20) == 0) break;
    pbVar7 = param_2 + 1;
    if ((*(byte *)((long)puVar3 + uVar8 * 2 + 1) & 0x20) == 0) {
      return 1;
    }
    if ((*(byte *)((long)puVar3 + (ulong)*param_1 * 2 + 1) & 0x20) == 0) {
      bVar1 = *(byte *)((long)puVar3 + (ulong)param_2[1] * 2 + 1);
      while ((bVar1 & 0x20) != 0) {
        pbVar7 = pbVar7 + 1;
        bVar1 = *(byte *)((long)puVar3 + (ulong)*pbVar7 * 2 + 1);
      }
    }
    param_2 = pbVar7;
    if (param_1 == pbVar10) {
      return 0;
    }
  } while( true );
  if ((param_4 & 2) != 0) {
    ppuVar5 = __ctype_b_loc();
    puVar3 = *ppuVar5;
    if ((*(byte *)((long)puVar3 + uVar9 * 2 + 1) & 0x20) != 0) {
      bVar1 = *(byte *)((long)puVar3 + uVar8 * 2 + 1);
      while ((bVar1 & 0x20) != 0) {
        param_2 = param_2 + 1;
        bVar1 = *(byte *)((long)puVar3 + (ulong)*param_2 * 2 + 1);
      }
      goto LAB_0010c610;
    }
  }
  iVar4 = (uint)bVar2 - (uint)bVar1;
joined_r0x0010c653:
  param_2 = param_2 + 1;
  if ((long)iVar4 != 0) {
    return (long)iVar4;
  }
  goto LAB_0010c610;
}



ulong FUN_0010c7c0(long param_1,long param_2)

{
  float fVar1;
  float fVar2;
  byte bVar3;
  long lVar4;
  size_t __size;
  uint uVar5;
  double dVar6;
  void *__dest;
  uint *puVar7;
  char *pcVar8;
  ulong uVar9;
  ulong uVar10;
  double dVar11;
  void *__ptr;
  ulong uVar12;
  long in_FS_OFFSET;
  undefined8 uVar13;
  int local_b0;
  int local_ac;
  undefined local_a8 [104];
  long local_40;
  
  dVar11 = *(double *)(param_2 + 0x20);
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  switch(*(undefined *)(param_2 + 6)) {
  default:
    uVar10 = 0xffffffff;
    FUN_00112fc0(param_1,"invalid type %d in magiccheck()");
    goto LAB_0010c828;
  case 1:
    uVar10 = (ulong)*(byte *)(param_1 + 0x70);
    break;
  case 2:
  case 7:
  case 10:
    uVar10 = (ulong)*(ushort *)(param_1 + 0x70);
    break;
  case 3:
  case 0x2f:
    uVar10 = 0;
    dVar11 = 0.00000000;
    break;
  case 4:
  case 6:
  case 8:
  case 9:
  case 0xb:
  case 0xc:
  case 0xe:
  case 0xf:
  case 0x10:
  case 0x15:
  case 0x16:
  case 0x17:
    uVar10 = (ulong)*(uint *)(param_1 + 0x70);
    break;
  case 5:
  case 0xd:
    dVar11 = 0.00000000;
    uVar10 = FUN_0010c5d0(param_2 + 0x20,param_1 + 0x70,(ulong)*(byte *)(param_2 + 5),
                          (ulong)*(uint *)(param_2 + 0x1c));
    break;
  case 0x11:
    uVar10 = 0;
    if (*(long *)(param_1 + 0x50) == 0) goto LAB_0010c828;
    FUN_001139c0(local_a8,param_2 + 0x20,
                         (ulong)((-(uint)((*(uint *)(param_2 + 0x1c) & 0xc) == 0) & 0xfffffffe) + 7)
                        );
    if (uVar5 != 0) {
LAB_0010cd9e:
      FUN_00113ab0(local_a8,(ulong)uVar5,param_1);
      uVar10 = 0xffffffff;
      FUN_00113a80(local_a8);
      goto LAB_0010c828;
    }
    __size = *(size_t *)(param_1 + 0x58);
    if (__size == 0) {
      __dest = *(void **)(param_1 + 0x50);
      __ptr = (void *)0x0;
    }
    else {
      __dest = malloc(__size);
      if (__dest == (void *)0x0) {
        uVar10 = 0xffffffff;
        FUN_00113a80(local_a8);
        puVar7 = (uint *)__errno_location();
        FUN_00112ce0(param_1,(ulong)*puVar7,"can\'t allocate %zu bytes",__size);
        goto LAB_0010c828;
      }
      __dest = memcpy(__dest,*(void **)(param_1 + 0x50),__size);
      *(undefined *)((long)__dest + (__size - 1)) = 0;
      __ptr = __dest;
    }
    FUN_00113a60(local_a8,__dest,1,&local_b0,0);
    free(__ptr);
    if (uVar5 == 0) {
      *(long *)(param_1 + 0x50) = *(long *)(param_1 + 0x50) + (long)local_b0;
      *(long *)(param_1 + 0x60) = *(long *)(param_1 + 0x60) + (long)local_b0;
      *(long *)(param_1 + 0x68) = (long)(local_ac - local_b0);
      FUN_00113a80(local_a8);
      uVar10 = 0;
    }
    else {
      if (uVar5 != 1) goto LAB_0010cd9e;
      FUN_00113a80(local_a8);
      uVar10 = 1;
    }
LAB_0010c9d9:
    dVar11 = 0.00000000;
    break;
  case 0x12:
  case 0x13:
    dVar11 = 0.00000000;
    uVar10 = FUN_0010c5d0(param_2 + 0x20,param_1 + 0x70,(ulong)*(byte *)(param_2 + 5),0);
    break;
  case 0x14:
    lVar4 = *(long *)(param_1 + 0x50);
    if (lVar4 == 0) goto LAB_0010c8d6;
    uVar9 = (ulong)*(byte *)(param_2 + 5);
    if (0x60 < *(byte *)(param_2 + 5)) {
      uVar9 = 0x60;
    }
    uVar5 = *(uint *)(param_2 + 0x18);
    uVar12 = 0;
    uVar10 = 0;
    while( true ) {
      if (((uVar5 != 0) && (uVar5 <= uVar12)) || (*(ulong *)(param_1 + 0x58) < uVar12 + uVar9))
      goto LAB_0010c9d9;
      uVar10 = FUN_0010c5d0(param_2 + 0x20,lVar4 + uVar12,uVar9,(ulong)*(uint *)(param_2 + 0x1c));
      if (uVar10 == 0) break;
      uVar12 = uVar12 + 1;
    }
    *(long *)(param_1 + 0x60) = *(long *)(param_1 + 0x60) + uVar12;
    dVar11 = 0.00000000;
    *(long *)(param_1 + 0x68) = uVar5 - uVar12;
    break;
  case 0x18:
  case 0x19:
  case 0x1a:
  case 0x1b:
  case 0x1c:
  case 0x1d:
  case 0x1e:
  case 0x1f:
  case 0x20:
  case 0x2a:
  case 0x2b:
  case 0x2c:
    uVar10 = *(ulong *)(param_1 + 0x70);
    break;
  case 0x21:
  case 0x22:
  case 0x23:
    bVar3 = *(byte *)(param_2 + 4);
    fVar1 = *(float *)(param_2 + 0x20);
    fVar2 = *(float *)(param_1 + 0x70);
    if (bVar3 == 0x3d) {
      uVar10 = (ulong)(fVar1 == fVar2);
    }
    else {
      if (bVar3 < 0x3e) {
        if (bVar3 == 0x21) {
          uVar10 = (ulong)(fVar1 != fVar2);
          goto LAB_0010c828;
        }
        if (bVar3 == 0x3c) {
          uVar10 = (ulong)(fVar2 < fVar1);
          goto LAB_0010c828;
        }
      }
      else {
        if (bVar3 == 0x3e) {
          uVar10 = (ulong)(fVar1 < fVar2);
          goto LAB_0010c828;
        }
        uVar10 = 1;
        if (bVar3 == 0x78) goto LAB_0010c828;
      }
      uVar10 = 0xffffffff;
      FUN_00112fc0(param_1,"cannot happen with float: invalid relation `%c\'",(ulong)bVar3);
    }
    goto LAB_0010c828;
  case 0x24:
  case 0x25:
  case 0x26:
    bVar3 = *(byte *)(param_2 + 4);
    dVar6 = *(double *)(param_1 + 0x70);
    if (bVar3 == 0x3d) {
      uVar10 = (ulong)(dVar6 == dVar11);
    }
    else {
      if (bVar3 < 0x3e) {
        if (bVar3 == 0x21) {
          uVar10 = (ulong)(dVar6 != dVar11);
          goto LAB_0010c828;
        }
        if (bVar3 == 0x3c) {
          uVar10 = (ulong)(dVar6 < dVar11);
          goto LAB_0010c828;
        }
      }
      else {
        if (bVar3 == 0x3e) {
          uVar10 = (ulong)(dVar11 < dVar6);
          goto LAB_0010c828;
        }
        uVar10 = 1;
        if (bVar3 == 0x78) goto LAB_0010c828;
      }
      uVar10 = 0xffffffff;
      FUN_00112fc0(param_1,"cannot happen with double: invalid relation `%c\'",(ulong)bVar3);
    }
    goto LAB_0010c828;
  case 0x29:
  case 0x2d:
  case 0x2e:
    goto switchD_0010c80c_caseD_29;
  case 0x30:
    uVar5 = FUN_00113f60(param_1,param_2);
    uVar10 = (ulong)uVar5;
    if (uVar5 != 0xffffffff) goto LAB_0010c828;
    if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
      uVar10 = 0;
      fwrite("EOF comparing DER entries",1,0x19,stderr);
      goto LAB_0010c828;
    }
LAB_0010c8d6:
    uVar10 = 0;
    goto LAB_0010c828;
  }
  uVar13 = 0x10c86b;
  dVar6 = (double)FUN_00108980(param_1,param_2,uVar10);
  bVar3 = *(byte *)(param_2 + 4);
  if (bVar3 == 0x3d) {
    uVar10 = (ulong)(dVar11 == dVar6);
    if ((*(byte *)(param_1 + 0x38) & 1) == 0) goto LAB_0010c828;
    pcVar8 = "%llu == %llu = %d\n";
  }
  else {
    if (bVar3 < 0x3e) {
      if (bVar3 == 0x26) {
        uVar10 = (ulong)((double)((ulong)dVar11 & (ulong)dVar6) == dVar11);
        if ((*(byte *)(param_1 + 0x38) & 1) == 0) goto LAB_0010c828;
        pcVar8 = "((%llx & %llx) == %llx) = %d\n";
LAB_0010cc87:
        fprintf(stderr,1,pcVar8,dVar6,dVar11,dVar11,uVar10,uVar13);
        goto LAB_0010c828;
      }
      if (bVar3 == 0x3c) {
        uVar5 = *(uint *)(param_1 + 0x38) & 1;
        if ((*(byte *)(param_2 + 2) & 8) == 0) {
          uVar10 = (ulong)((long)dVar6 < (long)dVar11);
          if (uVar5 == 0) goto LAB_0010c828;
          pcVar8 = "%lld < %lld = %d\n";
        }
        else {
          uVar10 = (ulong)((ulong)dVar6 < (ulong)dVar11);
          if (uVar5 == 0) goto LAB_0010c828;
          pcVar8 = "%llu < %llu = %d\n";
        }
      }
      else {
        if (bVar3 != 0x21) {
LAB_0010c899:
          uVar10 = 0xffffffff;
          FUN_00112fc0(param_1,"cannot happen: invalid relation `%c\'");
          goto LAB_0010c828;
        }
        uVar10 = (ulong)(dVar11 != dVar6);
        if ((*(byte *)(param_1 + 0x38) & 1) == 0) goto LAB_0010c828;
        pcVar8 = "%llu != %llu = %d\n";
      }
    }
    else {
      if (bVar3 == 0x5e) {
        uVar10 = (ulong)((double)((ulong)dVar11 & (ulong)dVar6) != dVar11);
        if ((*(byte *)(param_1 + 0x38) & 1) == 0) goto LAB_0010c828;
        pcVar8 = "((%llx & %llx) != %llx) = %d\n";
        goto LAB_0010cc87;
      }
      if (bVar3 == 0x78) {
        uVar5 = *(uint *)(param_1 + 0x38) & 1;
        uVar10 = (ulong)uVar5;
        if (uVar5 == 0) {
switchD_0010c80c_caseD_29:
          uVar10 = 1;
        }
        else {
          fprintf(stderr,1,"%llu == *any* = 1\n",dVar6);
        }
        goto LAB_0010c828;
      }
      if (bVar3 != 0x3e) goto LAB_0010c899;
      uVar5 = *(uint *)(param_1 + 0x38) & 1;
      if ((*(byte *)(param_2 + 2) & 8) == 0) {
        uVar10 = (ulong)((long)dVar11 < (long)dVar6);
        if (uVar5 == 0) goto LAB_0010c828;
        pcVar8 = "%lld > %lld = %d\n";
      }
      else {
        uVar10 = (ulong)((ulong)dVar11 < (ulong)dVar6);
        if (uVar5 == 0) goto LAB_0010c828;
        pcVar8 = "%llu > %llu = %d\n";
      }
    }
  }
  fprintf(stderr,1,pcVar8,dVar6,dVar11,uVar10);
LAB_0010c828:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar10;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void FUN_0010cf30(uint param_1,undefined8 param_2)

{
  fprintf(stderr,1,"mget/%zu @%d: ",0x60,(ulong)param_1);
  FUN_001089a0(stderr,param_2,0x60);
  fputc(10,stderr);
  fputc(10,stderr);
  return;
}



long FUN_0010cf90(undefined8 param_1,long param_2,long param_3,undefined8 param_4,undefined8 param_5
                 )

{
  long lVar1;
  
  lVar1 = FUN_00118170(param_2 + 0x80,param_3);
  if (param_3 != lVar1) {
    return lVar1;
  }
  FUN_00112fc0(param_1,"%s, %zu: format `%s\' does not match with `%s\'","softmagic.c",param_5,
               param_2 + 0x80,lVar1);
  return lVar1;
}



ulong FUN_0010d000(long param_1,long param_2)

{
  float fVar1;
  byte bVar2;
  ushort *puVar3;
  byte *pbVar4;
  int iVar5;
  long lVar6;
  undefined8 uVar7;
  size_t __n;
  ushort **ppuVar8;
  byte *pbVar9;
  char *__ptr;
  ulong uVar10;
  undefined8 uVar11;
  undefined *puVar12;
  byte *__s;
  long in_FS_OFFSET;
  undefined local_2d8 [32];
  undefined local_2b8 [128];
  undefined local_238 [520];
  long local_30;
  
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  switch(*(undefined *)(param_2 + 6)) {
  default:
    FUN_00112fc0(param_1,"invalid m->type (%d) in mprint()");
    uVar10 = 0xffffffff;
    goto LAB_0010d0a6;
  case 1:
    uVar10 = FUN_00108980(param_1,param_2,(ulong)*(byte *)(param_1 + 0x70));
    iVar5 = FUN_0010b840(param_1,param_2);
    if (iVar5 != -1) {
      if (iVar5 == 1) {
        snprintf(local_2b8,0x80,1,0x80,0x11b0c8,uVar10 & 0xff);
        uVar7 = FUN_0010cf90(param_1,param_2,0x11ad2b,"softmagic.c",0x1ce);
        iVar5 = FUN_00112ee0(param_1,uVar7,local_2b8);
      }
      else {
        uVar7 = FUN_0010cf90(param_1,param_2,0x11b0c8,"softmagic.c",0x1d2);
        iVar5 = FUN_00112ee0(param_1,uVar7,uVar10 & 0xff);
      }
      if (iVar5 != -1) {
        uVar10 = (ulong)*(uint *)(param_1 + 0x30) + 1;
        goto LAB_0010d0a4;
      }
    }
    break;
  case 2:
  case 7:
  case 10:
    uVar10 = FUN_00108980(param_1,param_2,(ulong)*(ushort *)(param_1 + 0x70));
    iVar5 = FUN_0010b840(param_1,param_2);
    if (iVar5 != -1) {
      if (iVar5 == 1) {
        snprintf(local_2b8,0x80,1,0x80,0x11c358,uVar10 & 0xffff);
        uVar7 = FUN_0010cf90(param_1,param_2,0x11ad2b,"softmagic.c",0x1e4);
        iVar5 = FUN_00112ee0(param_1,uVar7,local_2b8);
      }
      else {
        uVar7 = FUN_0010cf90(param_1,param_2,0x11c358,"softmagic.c",0x1e8);
        iVar5 = FUN_00112ee0(param_1,uVar7,uVar10 & 0xffff);
      }
      if (iVar5 != -1) {
        uVar10 = (ulong)*(uint *)(param_1 + 0x30) + 2;
        goto LAB_0010d0a4;
      }
    }
    break;
  case 3:
  case 0x2f:
    lVar6 = param_2 + 0x80;
    uVar7 = 0x11ad2b;
    goto LAB_0010d08e;
  case 4:
  case 8:
  case 0xb:
  case 0x17:
    uVar10 = FUN_00108980(param_1,param_2,(ulong)*(uint *)(param_1 + 0x70));
    iVar5 = FUN_0010b840(param_1,param_2);
    if (iVar5 == -1) break;
    if (iVar5 == 1) {
      puVar12 = local_2b8;
      snprintf(puVar12,0x80,1,0x80,0x11c358,uVar10 & 0xffffffff);
      uVar7 = FUN_0010cf90(param_1,param_2,0x11ad2b,"softmagic.c",0x1fa);
      goto LAB_0010d454;
    }
    uVar7 = FUN_0010cf90(param_1,param_2,0x11c358,"softmagic.c",0x1fe);
    iVar5 = FUN_00112ee0(param_1,uVar7,uVar10 & 0xffffffff);
    goto joined_r0x0010d79c;
  case 5:
  case 0xd:
  case 0x12:
  case 0x13:
    if ((*(char *)(param_2 + 4) == '=') || (*(char *)(param_2 + 4) == '!')) {
      uVar7 = FUN_00113cf0(local_238,0x200,param_2 + 0x20);
      uVar11 = FUN_0010cf90(param_1,param_2,0x11ad2b,"softmagic.c",0x220);
      iVar5 = FUN_00112ee0(param_1,uVar11,uVar7);
      if (iVar5 != -1) {
        uVar10 = (ulong)((uint)*(byte *)(param_2 + 5) + *(int *)(param_1 + 0x30));
        goto LAB_0010d0a4;
      }
      break;
    }
    __s = (byte *)(param_1 + 0x70);
    __n = strlen((char *)__s);
    uVar10 = *(uint *)(param_1 + 0x30) + __n;
    if (*(char *)(param_2 + 0x20) == '\0') {
      __n = strcspn((char *)__s,"\r\n");
      *(undefined *)(param_1 + 0x70 + __n) = 0;
    }
    if ((*(byte *)(param_2 + 0x1d) & 0x20) != 0) {
      ppuVar8 = __ctype_b_loc();
      puVar3 = *ppuVar8;
      while (bVar2 = *__s, pbVar4 = __s,
            (*(byte *)((long)puVar3 + (ulong)bVar2 * 2 + 1) & 0x20) != 0) {
        __s = __s + 1;
      }
      while (bVar2 != 0) {
        bVar2 = pbVar4[1];
        pbVar4 = pbVar4 + 1;
      }
      pbVar9 = pbVar4 + -1;
      bVar2 = *(byte *)((long)puVar3 + (ulong)pbVar4[-1] * 2 + 1);
      while ((bVar2 & 0x20) != 0) {
        pbVar9 = pbVar9 + -1;
        bVar2 = *(byte *)((long)puVar3 + (ulong)*pbVar9 * 2 + 1);
      }
      pbVar9[1] = 0;
    }
    uVar7 = FUN_00113cf0(local_238,0x200,__s);
    uVar11 = FUN_0010cf90(param_1,param_2,0x11ad2b,"softmagic.c",0x23c);
    iVar5 = FUN_00112ee0(param_1,uVar11,uVar7);
    if (iVar5 == -1) break;
    if (*(char *)(param_2 + 6) == '\r') {
      lVar6 = FUN_00108ae0(param_2);
      uVar10 = uVar10 + lVar6;
    }
    goto LAB_0010d0a4;
  case 6:
  case 9:
  case 0xc:
  case 0x15:
    puVar12 = (undefined *)FUN_00111d40((ulong)*(uint *)(param_1 + 0x70),0,local_2d8);
    uVar7 = 0x249;
    goto LAB_0010d438;
  case 0xe:
  case 0xf:
  case 0x10:
  case 0x16:
    puVar12 = (undefined *)FUN_00111d40((ulong)*(uint *)(param_1 + 0x70),1,local_2d8);
    uVar7 = 0x253;
LAB_0010d438:
    uVar7 = FUN_0010cf90(param_1,param_2,0x11ad2b,"softmagic.c",uVar7);
LAB_0010d454:
    iVar5 = FUN_00112ee0(param_1,uVar7,puVar12);
joined_r0x0010d79c:
    if (iVar5 == -1) break;
    uVar10 = (ulong)*(uint *)(param_1 + 0x30) + 4;
    goto LAB_0010d0a4;
  case 0x11:
  case 0x14:
    __n = *(size_t *)(param_1 + 0x68);
    __ptr = strndup(*(char **)(param_1 + 0x50),__n);
    if (__ptr == (char *)0x0) {
      FUN_00113100(param_1,__n);
    }
    else {
      uVar7 = FUN_00113cf0(local_238,0x200,__ptr);
      uVar11 = FUN_0010cf90(param_1,param_2,0x11ad2b,"softmagic.c",0x2a6);
      iVar5 = FUN_00112ee0(param_1,uVar11,uVar7);
      free(__ptr);
      if (iVar5 != -1) {
        uVar10 = *(ulong *)(param_1 + 0x60);
        if ((*(byte *)(param_2 + 0x1c) & 0x10) == 0) {
          uVar10 = uVar10 + *(long *)(param_1 + 0x68);
        }
        goto LAB_0010d0a4;
      }
    }
    break;
  case 0x18:
  case 0x19:
  case 0x1a:
    puVar12 = (undefined *)FUN_00108980(param_1,param_2,*(undefined8 *)(param_1 + 0x70));
    iVar5 = FUN_0010b840(param_1,param_2);
    if (iVar5 == -1) break;
    if (iVar5 == 1) {
      snprintf(local_2b8,0x80,1,0x80,&DAT_00119f10,puVar12);
      uVar7 = FUN_0010cf90(param_1,param_2,0x11ad2b,"softmagic.c",0x20f);
      puVar12 = local_2b8;
    }
    else {
      uVar7 = FUN_0010cf90(param_1,param_2,&DAT_00119f10,"softmagic.c",0x213);
    }
    goto LAB_0010d108;
  case 0x1b:
  case 0x1c:
  case 0x1d:
    puVar12 = (undefined *)FUN_00111d40(*(undefined8 *)(param_1 + 0x70),0,local_2d8);
    uVar7 = 0x25c;
    goto LAB_0010d0ec;
  case 0x1e:
  case 0x1f:
  case 0x20:
    puVar12 = (undefined *)FUN_00111d40(*(undefined8 *)(param_1 + 0x70),1,local_2d8);
    uVar7 = 0x265;
    goto LAB_0010d0ec;
  case 0x21:
  case 0x22:
  case 0x23:
    fVar1 = *(float *)(param_1 + 0x70);
    iVar5 = FUN_0010b840(param_1,param_2);
    if (iVar5 != -1) {
      if (iVar5 != 1) {
        uVar7 = FUN_0010cf90(param_1,param_2,0x11c361,"softmagic.c",0x281);
        iVar5 = FUN_00112ee0((double)fVar1,param_1,uVar7);
        goto joined_r0x0010d79c;
      }
      puVar12 = local_2b8;
      snprintf(0,puVar12,0x80,1,0x80,0x11c361);
      uVar7 = 0x27d;
      goto LAB_0010d438;
    }
    break;
  case 0x24:
  case 0x25:
  case 0x26:
    uVar7 = *(undefined8 *)(param_1 + 0x70);
    iVar5 = FUN_0010b840(param_1,param_2);
    if (iVar5 == -1) break;
    if (iVar5 == 1) {
      puVar12 = local_2b8;
      snprintf(uVar7,puVar12,0x80,1,0x80,0x11c361);
      uVar7 = 0x291;
      goto LAB_0010d0ec;
    }
    uVar11 = FUN_0010cf90(param_1,param_2,0x11c361,"softmagic.c",0x295);
    iVar5 = FUN_00112ee0(uVar7,param_1,uVar11);
    if (iVar5 == -1) break;
    goto LAB_0010d11e;
  case 0x29:
  case 0x2d:
  case 0x2e:
    goto switchD_0010d046_caseD_29;
  case 0x2a:
  case 0x2b:
  case 0x2c:
    puVar12 = (undefined *)FUN_00111d40(*(undefined8 *)(param_1 + 0x70),2,local_2d8);
    uVar7 = 0x26e;
LAB_0010d0ec:
    uVar7 = FUN_0010cf90(param_1,param_2,0x11ad2b,"softmagic.c",uVar7);
LAB_0010d108:
    iVar5 = FUN_00112ee0(param_1,uVar7,puVar12);
    if (iVar5 != -1) {
LAB_0010d11e:
      uVar10 = (ulong)*(uint *)(param_1 + 0x30) + 8;
LAB_0010d0a4:
      uVar10 = uVar10 & 0xffffffff;
      goto LAB_0010d0a6;
    }
    break;
  case 0x30:
    lVar6 = FUN_00113cf0(local_238,0x200,param_1 + 0x70);
    uVar7 = FUN_0010cf90(param_1,param_2,0x11ad2b,"softmagic.c",0x2c1);
LAB_0010d08e:
    iVar5 = FUN_00112ee0(param_1,uVar7,lVar6);
    if (iVar5 == -1) break;
switchD_0010d046_caseD_29:
    uVar10 = (ulong)*(uint *)(param_1 + 0x30);
    goto LAB_0010d0a4;
  }
  uVar10 = 0xffffffff;
LAB_0010d0a6:
  if (local_30 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar10;
}



undefined8
FUN_0010d8f0(long *param_1,undefined8 param_2,undefined8 param_3,undefined2 *param_4,
            undefined2 *param_5,ulong param_6,uint param_7)

{
  undefined8 uVar1;
  undefined8 *puVar2;
  long in_FS_OFFSET;
  undefined2 local_4c;
  undefined2 local_4a;
  undefined4 local_48;
  undefined4 local_44;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_48 = 0;
  local_44 = 0;
  if (param_5 == (undefined2 *)0x0) {
    param_5 = &local_4c;
    local_4c = 0;
  }
  if (param_4 == (undefined2 *)0x0) {
    param_4 = &local_4a;
    local_4a = 0;
  }
  puVar2 = (undefined8 *)((undefined8 *)*param_1)[3];
  if ((undefined8 *)*param_1 != puVar2) {
    do {
      uVar1 = FUN_0010e750(param_1,*puVar2,(ulong)*(uint *)(puVar2 + 1),param_2,param_3,0,
                           param_6 & 0xffffffff,(ulong)param_7,0,param_4,param_5,&local_48,&local_44
                           ,0);
      if ((int)uVar1 != 0) goto LAB_0010d9ae;
      puVar2 = (undefined8 *)puVar2[3];
    } while ((undefined8 *)*param_1 != puVar2);
  }
  uVar1 = 0;
LAB_0010d9ae:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar1;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



ulong FUN_0010da10(long param_1,long param_2,long param_3,ulong param_4,long param_5,int param_6,
                  uint param_7,uint param_8,uint param_9,ushort *param_10,ushort *param_11,
                  undefined8 param_12,undefined4 *param_13,undefined8 param_14)

{
  byte bVar1;
  undefined4 uVar2;
  byte bVar3;
  uint uVar4;
  int iVar5;
  void *__ptr;
  ulong uVar6;
  long lVar7;
  byte bVar8;
  uint uVar9;
  uint *puVar10;
  ulong uVar11;
  ulong uVar12;
  ulong uVar13;
  ulong uVar14;
  long in_FS_OFFSET;
  undefined8 uVar15;
  long local_b0;
  undefined *local_80;
  undefined8 local_68;
  uint local_60;
  long local_40;
  
  local_80 = (undefined *)(param_1 + 0x70);
  uVar9 = *(uint *)(param_1 + 0x30);
  uVar11 = (ulong)uVar9;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if (*(ushort *)(param_1 + 0xd0) <= *param_10) {
    FUN_00112ce0(param_1,0,"indirect count (%hu) exceeded",(ulong)*param_10);
    uVar12 = 0xffffffff;
    goto LAB_0010ddc0;
  }
  if (*(ushort *)(param_1 + 0xd2) <= *param_11) {
    FUN_00112ce0(param_1,0,"name use count (%hu) exceeded");
    uVar12 = 0xffffffff;
    goto LAB_0010ddc0;
  }
  uVar4 = FUN_0010c250(param_1,param_1 + 0x70,(ulong)*(byte *)(param_3 + 6),0,0,0,0,0,0);
  uVar12 = (ulong)uVar4;
  if (uVar4 == 0xffffffff) goto LAB_0010ddc0;
  bVar3 = *(byte *)(param_3 + 2);
  if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
    fprintf(stderr,1,"mget(type=%d, flag=%x, offset=%u, o=%zu, nbytes=%zu, il=%hu, nc=%hu)\n")
    ;
    FUN_0010cf30((ulong)uVar9,0);
    FUN_00111e30(param_3);
    bVar3 = *(byte *)(param_3 + 2);
  }
  if ((bVar3 & 1) == 0) goto LAB_0010dc70;
  uVar12 = SEXT48(*(int *)(param_3 + 0x10));
  bVar3 = *(byte *)(param_3 + 8) & 0x20;
  if (-1 < (char)*(byte *)(param_3 + 8)) {
    uVar6 = (ulong)*(byte *)(param_3 + 7);
    goto LAB_0010db3e;
  }
  if ((param_4 < *(int *)(param_3 + 0x10) + uVar9) ||
     (uVar14 = (ulong)uVar9, param_4 - (uVar14 + uVar12) < 0x60)) goto LAB_0010de88;
  bVar8 = *(byte *)(param_3 + 7);
  uVar6 = (ulong)bVar8;
  uVar9 = (uint)bVar8;
  uVar13 = uVar12;
  if (param_9 != 0) {
    uVar9 = FUN_0010bb50((ulong)bVar8);
  }
  puVar10 = (uint *)(uVar14 + uVar13 + param_2);
  switch(uVar9) {
  case 1:
    uVar12 = (long)(char)*(byte *)puVar10;
    if (bVar3 == 0) {
      uVar12 = (long)(char)*(byte *)puVar10 & 0xff;
    }
    break;
  case 2:
    uVar12 = (long)*(short *)puVar10;
    if (bVar3 == 0) {
      uVar12 = (long)*(short *)puVar10 & 0xffff;
    }
    break;
  case 4:
  case 0xb:
  case 0x28:
    uVar12 = (long)(int)*puVar10;
    if (bVar3 == 0) {
      uVar12 = (long)(int)*puVar10 & 0xffffffff;
    }
    break;
  case 7:
    bVar8 = *(byte *)puVar10;
    bVar1 = *(byte *)((long)puVar10 + 1);
    goto LAB_0010e096;
  case 8:
  case 0x27:
    uVar9 = *puVar10;
    uVar9 = uVar9 >> 0x18 | (uVar9 & 0xff0000) >> 8 | (uVar9 & 0xff00) << 8 | uVar9 << 0x18;
    uVar12 = (long)(int)uVar9;
    if (bVar3 == 0) {
      uVar12 = (ulong)uVar9;
    }
    break;
  case 10:
    bVar8 = *(byte *)((long)puVar10 + 1);
    bVar1 = *(byte *)puVar10;
LAB_0010e096:
    uVar12 = (long)(short)((ushort)bVar1 | (ushort)((ulong)bVar8 << 8));
    if (bVar3 == 0) {
      uVar12 = (ulong)((uint)bVar1 | (uint)((ulong)bVar8 << 8));
    }
    break;
  case 0x17:
    uVar9 = (uint)*(byte *)((long)puVar10 + 1) << 0x18 | (uint)*(byte *)puVar10 << 0x10 |
            (uint)*(byte *)((long)puVar10 + 2) | (uint)*(byte *)((long)puVar10 + 3) << 8;
    uVar12 = (long)(int)uVar9;
    if (bVar3 == 0) {
      uVar12 = (ulong)uVar9;
    }
  }
  if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
    fprintf(stderr,1,"indirect offs=%jd\n");
    uVar6 = (ulong)*(byte *)(param_3 + 7);
  }
LAB_0010db3e:
  iVar5 = (int)uVar6;
  if (param_9 != 0) {
    iVar5 = FUN_0010bb50(uVar6 & 0xffffffff);
  }
  switch(iVar5) {
  default:
switchD_0010db64_caseD_0:
    if ((*(byte *)(param_3 + 2) & 4) != 0) {
      uVar9 = *(uint *)(param_1 + 0x38) & 1;
      uVar4 = (int)uVar11 + *(int *)((ulong)(param_6 - 1) * 0x10 + *(long *)(param_1 + 0x18));
      uVar11 = (ulong)uVar4;
      if (uVar4 == 0) {
        if (uVar9 != 0) {
          fwrite("indirect *zero* offset\n",1,0x17,stderr);
          uVar12 = 0;
          goto LAB_0010ddc0;
        }
        break;
      }
      if (uVar9 != 0) {
        fprintf(stderr,1,"indirect +offs=%u\n");
      }
    }
    uVar9 = FUN_0010c250(param_1,param_1 + 0x70,(ulong)*(byte *)(param_3 + 6),0,param_2,uVar11,
                         param_4,param_3 + 0x18,param_3 + 0x1c);
    uVar12 = (ulong)uVar9;
    if (uVar9 == 0xffffffff) goto LAB_0010ddc0;
    *(undefined4 *)(param_1 + 0x30) = (int)uVar11;
    if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
      FUN_0010cf30(uVar11,0);
      FUN_00111e30(param_3);
    }
LAB_0010dc70:
    switch(*(byte *)(param_3 + 6)) {
    case 1:
      if (param_4 <= uVar11) goto LAB_0010de88;
      uVar11 = 1;
      if (param_9 != 0) goto LAB_0010df17;
      goto switchD_0010decb_caseD_1;
    case 2:
    case 7:
    case 10:
      if ((param_4 < uVar11) || (param_4 - uVar11 < 2)) goto LAB_0010de88;
      break;
    case 4:
    case 6:
    case 8:
    case 9:
    case 0xb:
    case 0xc:
    case 0xe:
    case 0xf:
    case 0x10:
    case 0x15:
    case 0x16:
    case 0x17:
    case 0x21:
    case 0x22:
    case 0x23:
      if ((param_4 < uVar11) || (param_4 - uVar11 < 4)) goto LAB_0010de88;
      break;
    case 5:
    case 0xd:
    case 0x14:
      if ((param_4 < uVar11) || (param_4 - uVar11 < (ulong)*(byte *)(param_3 + 5)))
      goto LAB_0010de88;
      break;
    case 0x11:
      if (param_4 < uVar11) goto LAB_0010de88;
      uVar11 = 0x11;
      if (param_9 != 0) goto LAB_0010df17;
      goto switchD_0010decb_caseD_3;
    case 0x24:
    case 0x25:
    case 0x26:
      if ((param_4 < uVar11) || (param_4 - uVar11 < 8)) goto LAB_0010de88;
      break;
    case 0x29:
      uVar9 = (uint)uVar11;
      if ((*(byte *)(param_3 + 0x1c) & 1) != 0) {
        uVar9 = (int)param_5 + (uint)uVar11;
      }
      if ((uVar9 == 0) || (uVar11 = (ulong)uVar9, param_4 < uVar11)) goto LAB_0010de88;
      uVar15 = 0x10dcb8;
      lVar7 = FUN_00113c50(param_1);
      if (lVar7 != 0) {
        *param_10 = *param_10 + 1;
        uVar4 = FUN_0010d8f0(param_1,param_2 + uVar11,param_4 - uVar11,param_10,param_11,0x20,
                             (ulong)param_8);
        if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
          fprintf(stderr,1,"indirect @offs=%u[%d]\n",(ulong)uVar9,(ulong)uVar4);
        }
        __ptr = (void *)FUN_00113ca0(param_1,lVar7);
        if ((__ptr != (void *)0x0) || ((*(byte *)(param_1 + 0x3c) & 1) == 0)) {
          if (uVar4 == 1) {
            if ((*(uint *)(param_1 + 0x38) & 0x1000c10) == 0) {
              uVar15 = FUN_0010cf90(param_1,param_3,0x11c358,"softmagic.c",0x624);
              uVar9 = FUN_00112ee0(param_1,uVar15,(ulong)uVar9);
              if (uVar9 != 0xffffffff) goto LAB_0010dd84;
            }
            else {
LAB_0010dd84:
              uVar9 = FUN_00112ee0(param_1,0x11ad2b,__ptr);
              if (uVar9 != 0xffffffff) goto LAB_0010ddab;
            }
            free(__ptr);
            uVar12 = (ulong)uVar9;
          }
          else {
LAB_0010ddab:
            free(__ptr);
            uVar12 = (ulong)uVar4;
          }
          goto LAB_0010ddc0;
        }
      }
LAB_0010e359:
      uVar12 = 0xffffffff;
      goto LAB_0010ddc0;
    case 0x2d:
      if (((*(uint *)(param_1 + 0x38) & 0x1000c10) == 0) &&
         (iVar5 = FUN_00112ee0(param_1,0x11ad2b,param_3 + 0x80), iVar5 == -1)) goto LAB_0010e359;
      goto switchD_0010decb_caseD_3;
    case 0x2e:
      if (param_4 < uVar11) goto LAB_0010de88;
      if (*(char *)(param_3 + 0x20) == '^') {
        local_b0 = param_3 + 0x21;
        param_9 = (uint)(param_9 == 0);
      }
      else {
        local_b0 = param_3 + 0x20;
      }
      iVar5 = FUN_0010b640(param_1,local_b0,&local_68);
      if (iVar5 == -1) {
        FUN_00112ce0(param_1,0,"cannot find entry `%s\'",local_b0);
        uVar12 = 0xffffffff;
        goto LAB_0010ddc0;
      }
      *param_11 = *param_11 + 1;
      uVar2 = *param_13;
      if ((*(byte *)(param_3 + 2) & 0x10) != 0) {
        *param_13 = 0;
      }
      iVar5 = FUN_0010e750(param_1,local_68,(ulong)local_60,param_2,param_4,uVar11 + param_5,
                           (ulong)param_7,(ulong)param_8,(ulong)param_9,param_10,param_11,param_12,
                           param_13,param_14);
      if (iVar5 != 1) {
        uVar12 = 1;
        *param_13 = uVar2;
        goto LAB_0010ddc0;
      }
      goto switchD_0010decb_caseD_3;
    }
    uVar11 = (ulong)*(byte *)(param_3 + 6);
    if (param_9 != 0) {
LAB_0010df17:
      uVar9 = FUN_0010bb50(uVar11);
      uVar11 = (ulong)uVar9;
    }
    switch(uVar11 & 0xff) {
    default:
      FUN_00112fc0(param_1,"invalid type %d in mconvert()");
      uVar12 = 0;
      goto LAB_0010ddc0;
    case 1:
switchD_0010decb_caseD_1:
      bVar3 = *(byte *)(param_3 + 9);
      if (*(long *)(param_3 + 0x18) == 0) goto LAB_0010e5cd;
      bVar8 = (byte)*(long *)(param_3 + 0x18);
      switch((uint)bVar3 & 7) {
      case 0:
        *(byte *)(param_1 + 0x70) = *(byte *)(param_1 + 0x70) & bVar8;
        bVar3 = *(byte *)(param_3 + 9);
        break;
      case 1:
        *(byte *)(param_1 + 0x70) = *(byte *)(param_1 + 0x70) | bVar8;
        bVar3 = *(byte *)(param_3 + 9);
        break;
      case 2:
        *(byte *)(param_1 + 0x70) = *(byte *)(param_1 + 0x70) ^ bVar8;
        bVar3 = *(byte *)(param_3 + 9);
        break;
      case 3:
        *(char *)(param_1 + 0x70) = *(char *)(param_1 + 0x70) + bVar8;
        bVar3 = *(byte *)(param_3 + 9);
        break;
      case 4:
        *(char *)(param_1 + 0x70) = *(char *)(param_1 + 0x70) - bVar8;
        bVar3 = *(byte *)(param_3 + 9);
        break;
      case 5:
        *(char *)(param_1 + 0x70) = *(char *)(param_1 + 0x70) * bVar8;
        bVar3 = *(byte *)(param_3 + 9);
        break;
      case 6:
        if (bVar8 != 0) {
          *(byte *)(param_1 + 0x70) = *(byte *)(param_1 + 0x70) / bVar8;
          bVar3 = *(byte *)(param_3 + 9);
          break;
        }
        goto LAB_0010e3af;
      case 7:
        if (bVar8 == 0) goto LAB_0010e3af;
        *(byte *)(param_1 + 0x70) = *(byte *)(param_1 + 0x70) % bVar8;
        bVar3 = *(byte *)(param_3 + 9);
      }
LAB_0010e5cd:
      if ((bVar3 & 0x40) != 0) {
        *(byte *)(param_1 + 0x70) = ~*(byte *)(param_1 + 0x70);
        uVar12 = 1;
        goto LAB_0010ddc0;
      }
      goto switchD_0010decb_caseD_3;
    case 5:
    case 0x12:
    case 0x13:
      *(undefined *)(param_1 + 0xcf) = 0;
      uVar12 = 1;
      goto LAB_0010ddc0;
    case 7:
      *(undefined2 *)(param_1 + 0x70) =
           CONCAT11(*(undefined *)(param_1 + 0x70),*(undefined *)(param_1 + 0x71));
switchD_0010decb_caseD_2:
      iVar5 = FUN_0010bcc0(param_1 + 0x70,param_3 + 9,*(undefined8 *)(param_3 + 0x18));
      goto joined_r0x0010e3a9;
    case 8:
    case 9:
    case 0xf:
      uVar9 = *(uint *)(param_1 + 0x70);
      *(uint *)(param_1 + 0x70) =
           uVar9 >> 0x18 | (uVar9 & 0xff0000) >> 8 | (uVar9 & 0xff00) << 8 | uVar9 << 0x18;
      break;
    case 0xd:
      lVar7 = FUN_00108ae0(param_3);
      uVar12 = FUN_0010b5b0(param_3,local_80);
      uVar11 = 0x60U - lVar7;
      if (uVar12 < 0x60U - lVar7) {
        uVar11 = uVar12;
      }
      if (uVar11 != 0) {
        uVar12 = 0;
        do {
          local_80[uVar12] = local_80[uVar12 + lVar7];
          uVar12 = uVar12 + 1;
        } while (uVar11 != uVar12);
        local_80 = local_80 + uVar11;
      }
      uVar12 = 1;
      *local_80 = 0;
      goto LAB_0010ddc0;
    case 0x15:
    case 0x16:
    case 0x17:
      *(uint *)(param_1 + 0x70) =
           (uint)*(byte *)(param_1 + 0x71) << 0x18 | (uint)*(byte *)(param_1 + 0x70) << 0x10 |
           (uint)*(byte *)(param_1 + 0x72) | (uint)*(byte *)(param_1 + 0x73) << 8;
      break;
    case 0x1a:
    case 0x1d:
    case 0x20:
    case 0x2c:
      uVar11 = *(ulong *)(param_1 + 0x70);
      *(ulong *)(param_1 + 0x70) =
           uVar11 >> 0x38 | (uVar11 & 0xff000000000000) >> 0x28 | (uVar11 & 0xff0000000000) >> 0x18
           | (uVar11 & 0xff00000000) >> 8 | (uVar11 & 0xff000000) << 8 | (uVar11 & 0xff0000) << 0x18
           | (uVar11 & 0xff00) << 0x28 | uVar11 << 0x38;
switchD_0010decb_caseD_18:
      iVar5 = FUN_0010be50(param_1 + 0x70,param_3 + 9,*(undefined8 *)(param_3 + 0x18));
      goto joined_r0x0010e3a9;
    case 0x22:
      uVar9 = *(uint *)(param_1 + 0x70);
      *(uint *)(param_1 + 0x70) =
           uVar9 >> 0x18 | (uVar9 & 0xff0000) >> 8 | (uVar9 & 0xff00) << 8 | uVar9 << 0x18;
switchD_0010decb_caseD_21:
      iVar5 = FUN_0010bf10(param_1 + 0x70,(ulong)*(byte *)(param_3 + 9),
                           *(undefined8 *)(param_3 + 0x18));
      goto joined_r0x0010e3a9;
    case 0x25:
      uVar11 = *(ulong *)(param_1 + 0x70);
      *(ulong *)(param_1 + 0x70) =
           uVar11 >> 0x38 | (uVar11 & 0xff000000000000) >> 0x28 | (uVar11 & 0xff0000000000) >> 0x18
           | (uVar11 & 0xff00000000) >> 8 | (uVar11 & 0xff000000) << 8 | (uVar11 & 0xff0000) << 0x18
           | (uVar11 & 0xff00) << 0x28 | uVar11 << 0x38;
switchD_0010decb_caseD_24:
      iVar5 = FUN_0010c070(param_1 + 0x70,(ulong)*(byte *)(param_3 + 9),
                           *(undefined8 *)(param_3 + 0x18));
      goto joined_r0x0010e3a9;
    case 0x24:
    case 0x26:
      goto switchD_0010decb_caseD_24;
    case 0x21:
    case 0x23:
      goto switchD_0010decb_caseD_21;
    case 0x18:
    case 0x19:
    case 0x1b:
    case 0x1c:
    case 0x1e:
    case 0x1f:
    case 0x2a:
    case 0x2b:
      goto switchD_0010decb_caseD_18;
    case 2:
    case 10:
      goto switchD_0010decb_caseD_2;
    case 3:
    case 0x11:
    case 0x14:
    case 0x2d:
    case 0x2e:
    case 0x2f:
    case 0x30:
      goto switchD_0010decb_caseD_3;
    case 4:
    case 6:
    case 0xb:
    case 0xc:
    case 0xe:
    case 0x10:
      break;
    }
    iVar5 = FUN_0010bd90(param_1 + 0x70,param_3 + 9,*(undefined8 *)(param_3 + 0x18));
joined_r0x0010e3a9:
    if (iVar5 != -1) {
switchD_0010decb_caseD_3:
      uVar12 = 1;
      goto LAB_0010ddc0;
    }
LAB_0010e3af:
    FUN_00112fc0(param_1,"zerodivide in mconvert()");
    break;
  case 1:
    if (uVar11 < param_4) {
      uVar11 = SEXT18(*(char *)(param_1 + 0x70));
      uVar6 = uVar11 & 0xff;
LAB_0010e148:
      if (bVar3 == 0) {
        uVar11 = uVar6;
      }
      uVar9 = FUN_0010c1d0((ulong)*(byte *)(param_3 + 8),uVar11,uVar12);
      uVar11 = (ulong)uVar9;
      goto switchD_0010db64_caseD_0;
    }
    break;
  case 2:
    if ((uVar11 <= param_4) && (1 < param_4 - uVar11)) {
      uVar11 = SEXT28(*(short *)(param_1 + 0x70));
      uVar6 = uVar11 & 0xffff;
      goto LAB_0010e148;
    }
    break;
  case 4:
    if ((uVar11 <= param_4) && (3 < param_4 - uVar11)) {
      uVar11 = SEXT48((int)*(uint *)(param_1 + 0x70));
      uVar6 = (ulong)*(uint *)(param_1 + 0x70);
      goto LAB_0010e148;
    }
    break;
  case 7:
    if ((uVar11 <= param_4) && (1 < param_4 - uVar11)) {
      lVar7 = (ulong)*(byte *)(param_1 + 0x70) << 8;
      uVar11 = SEXT28((short)((ushort)*(byte *)(param_1 + 0x71) | (ushort)lVar7));
      uVar6 = (ulong)((uint)*(byte *)(param_1 + 0x71) | (uint)lVar7);
      goto LAB_0010e148;
    }
    break;
  case 8:
  case 0x27:
    if ((uVar11 <= param_4) && (3 < param_4 - uVar11)) {
      uVar9 = *(uint *)(param_1 + 0x70);
      uVar11 = (ulong)(uVar9 >> 0x18 | (uVar9 & 0xff0000) >> 8 | (uVar9 & 0xff00) << 8 |
                      uVar9 << 0x18);
      if (iVar5 == 0x27) {
LAB_0010e22a:
        uVar9 = FUN_0010baf0((ulong)*(uint *)(param_1 + 0x38),uVar11);
        uVar11 = (ulong)uVar9;
      }
LAB_0010db9b:
      if (bVar3 != 0) {
        uVar11 = (long)(int)uVar11;
      }
      uVar9 = FUN_0010c1d0((ulong)*(byte *)(param_3 + 8),uVar11,uVar12);
      uVar11 = (ulong)uVar9;
      goto switchD_0010db64_caseD_0;
    }
    break;
  case 10:
    if ((uVar11 <= param_4) && (1 < param_4 - uVar11)) {
      lVar7 = (ulong)*(byte *)(param_1 + 0x71) << 8;
      uVar11 = SEXT28((short)((ushort)*(byte *)(param_1 + 0x70) | (ushort)lVar7));
      uVar6 = (ulong)((uint)*(byte *)(param_1 + 0x70) | (uint)lVar7);
      goto LAB_0010e148;
    }
    break;
  case 0xb:
  case 0x28:
    if ((uVar11 <= param_4) && (3 < param_4 - uVar11)) {
      uVar11 = (ulong)*(uint *)(param_1 + 0x70);
      if (iVar5 == 0x28) goto LAB_0010e22a;
      goto LAB_0010db9b;
    }
    break;
  case 0x17:
    if ((uVar11 <= param_4) && (3 < param_4 - uVar11)) {
      uVar9 = (uint)*(byte *)(param_1 + 0x71) << 0x18 | (uint)*(byte *)(param_1 + 0x70) << 0x10 |
              (uint)*(byte *)(param_1 + 0x72) | (uint)*(byte *)(param_1 + 0x73) << 8;
      uVar11 = SEXT48((int)uVar9);
      uVar6 = (ulong)uVar9;
      goto LAB_0010e148;
    }
  }
LAB_0010de88:
  uVar12 = 0;
LAB_0010ddc0:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar12;
}



ulong FUN_0010e750(long param_1,long param_2,uint param_3,undefined8 param_4,undefined8 param_5, undefined8 param_6,uint param_7,uint param_8,uint param_9,undefined8 param_10, undefined8 param_11,uint *param_12,int *param_13,uint *param_14)

{
  byte bVar1;
  ushort uVar2;
  uint uVar3;
  int iVar4;
  ulong uVar5;
  ulong uVar6;
  uint uVar7;
  long lVar8;
  ushort *puVar9;
  uint uVar10;
  long in_FS_OFFSET;
  uint local_5c;
  uint local_44;
  long local_40;
  
  local_44 = 0;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  uVar3 = *(uint *)(param_1 + 0x38) & 0x1000c10;
  if (param_14 == (uint *)0x0) {
    param_14 = &local_44;
  }
  iVar4 = FUN_00113920(param_1,0);
  if (iVar4 == -1) {
LAB_0010ec40:
    uVar5 = 0xffffffff;
  }
  else {
    if (param_3 != 0) {
      local_5c = 1;
      uVar6 = 0;
LAB_0010e80d:
      do {
        lVar8 = uVar6 * 0x158 + param_2;
        bVar1 = *(byte *)(lVar8 + 6);
        if (bVar1 == 0x2d) {
LAB_0010e844:
          *(undefined4 *)(param_1 + 0x30) = *(undefined4 *)(lVar8 + 0xc);
          *(ulong *)(param_1 + 0x48) = (ulong)*(uint *)(lVar8 + 0x14);
          iVar4 = FUN_0010da10(param_1,param_4,lVar8,param_5,param_6,0,(ulong)param_7,(ulong)param_8
                               ,(ulong)param_9,param_10,param_11,param_12,param_13,param_14);
          if (iVar4 == -1) goto LAB_0010ec40;
          if (iVar4 != 0) {
            if (*(char *)(lVar8 + 6) == ')') {
              *param_14 = 1;
            }
            iVar4 = FUN_0010c7c0(param_1,lVar8);
            if (iVar4 != -1) {
              if (iVar4 != 0) goto LAB_0010e8ba;
              goto LAB_0010eaed;
            }
            goto LAB_0010ec40;
          }
          if (*(char *)(lVar8 + 4) != '!') goto LAB_0010eaed;
LAB_0010e8ba:
          uVar5 = FUN_0010b740(param_1,lVar8,(ulong)local_5c);
          if ((int)uVar5 != 0) {
LAB_0010ed78:
            *param_13 = 1;
            *param_12 = 1;
            *param_14 = 1;
            goto LAB_0010ec45;
          }
          if (*(char *)(lVar8 + 0x80) != '\0') {
            *param_13 = 1;
            *param_12 = 1;
            if ((local_5c == 0) && (iVar4 = FUN_00112ee0(param_1,&DAT_00119dc8), iVar4 == -1))
            goto LAB_0010ec40;
          }
          if ((uVar3 == 0) && (iVar4 = FUN_0010d000(param_1,lVar8), iVar4 == -1)) goto LAB_0010ec40;
          iVar4 = FUN_0010b900(param_1,lVar8,param_5,0);
          if (iVar4 + 1U < 2) goto LAB_0010eaed;
          iVar4 = FUN_00113920(param_1,0);
          if (iVar4 == -1) goto LAB_0010ec40;
          uVar7 = (int)uVar6 + 1;
          uVar10 = 1;
          puVar9 = (ushort *)((ulong)uVar7 * 0x158 + param_2);
          while (uVar6 = (ulong)uVar7, uVar7 < param_3) {
            uVar2 = *puVar9;
            if (uVar2 == 0) {
              if (*param_12 != 0) goto LAB_0010ed1b;
              goto LAB_0010e80d;
            }
            *(ulong *)(param_1 + 0x48) = (ulong)*(uint *)(puVar9 + 10);
            if (uVar2 <= uVar10) {
              if (uVar2 < uVar10) {
                uVar10 = (uint)uVar2;
              }
              iVar4 = *(int *)(puVar9 + 6);
              *(int *)(param_1 + 0x30) = iVar4;
              if ((*(byte *)(puVar9 + 1) & 2) != 0) {
                *(int *)(param_1 + 0x30) =
                     iVar4 + *(int *)((ulong)(uVar10 - 1) * 0x10 + *(long *)(param_1 + 0x18));
              }
              if ((1 < (byte)(*(char *)(puVar9 + 5) - 2U)) ||
                 (*(int *)((ulong)uVar10 * 0x10 + *(long *)(param_1 + 0x18) + 8) != 1)) {

                if (iVar4 == -1) goto LAB_0010ec40;
                if (iVar4 == 0) {
                  if (*(char *)(puVar9 + 2) == '!') goto LAB_0010ec8b;
                }
                else {
                  if (*(char *)(puVar9 + 3) == ')') {
                    *param_14 = 1;
                  }
                  iVar4 = FUN_0010c7c0(param_1,0);
                  if (iVar4 == -1) goto LAB_0010ec40;
                  if (iVar4 == 0) {
                    *(undefined4 *)((ulong)uVar10 * 0x10 + *(long *)(param_1 + 0x18) + 8) = 0;
                  }
                  else {
LAB_0010ec8b:
                    lVar8 = *(long *)(param_1 + 0x18) + (ulong)uVar10 * 0x10;
                    *(undefined4 *)(lVar8 + 8) = 1;
                    if (*(char *)(puVar9 + 3) == '/') {
                      *(undefined4 *)(lVar8 + 4) = 0;
                    }
                    else {
                      if (*(int *)(lVar8 + 4) == 0) {
                        *(undefined4 *)(lVar8 + 4) = 1;
                      }
                      else {
                        if (*(char *)(puVar9 + 3) == '\x03') goto LAB_0010ea88;
                      }
                    }
                    uVar5 = FUN_0010b740(param_1,puVar9,(ulong)local_5c);
                    if ((int)uVar5 != 0) goto LAB_0010ed78;
                    if ((((*(char *)(puVar9 + 0x40) != '\0') && (*param_12 == 0)) &&
                        (*param_12 = 1, local_5c == 0)) && (iVar4 = FUN_00112ee0(0,""), iVar4 == -1))
                    goto LAB_0010ec40;
                    if (((*param_13 != 0) && ((*(byte *)(puVar9 + 1) & 0x10) == 0)) &&
                       (*(char *)(puVar9 + 0x40) != '\0')) {
                      if ((uVar3 == 0) && (iVar4 = FUN_00112ee0(param_1,""), iVar4 == -1))
                      goto LAB_0010ec40;
                      *param_13 = 0;
                    }
                    if ((uVar3 == 0) && (iVar4 = FUN_0010d000(param_1,puVar9), iVar4 == -1))
                    goto LAB_0010ec40;
                    FUN_0010b900(param_1,puVar9,param_5,0);
                    if (*(char *)(puVar9 + 0x40) != '\0') {
                      *param_13 = 1;
                    }
                    uVar10 = uVar10 + 1;
                    iVar4 = FUN_00113920(param_1,0);
                    if (iVar4 == -1) goto LAB_0010ec40;
                  }
                }
              }
            }
LAB_0010ea88:
            puVar9 = puVar9 + 0xac;
            uVar7 = uVar7 + 1;
          }
          if (*param_12 == 0) break;
LAB_0010ed1b:
          if (uVar3 == 0) {
            *param_14 = 1;
            if ((*(byte *)(param_1 + 0x38) & 0x20) != 0) goto LAB_0010eda4;
            local_5c = *param_12;
            if (local_5c != 0) break;
          }
          else {
            if ((*(byte *)(param_1 + 0x38) & 0x20) == 0) break;
LAB_0010eda4:
            local_5c = 0;
          }
        }
        else {
          if ((bVar1 < 0x2f) && ((0x4200001e2020U >> ((ulong)bVar1 & 0x1f) & 1) != 0)) {
            uVar10 = *(uint *)(lVar8 + 0x1c) & 0x60;
            if (param_8 == 0) {
              if (uVar10 != 0x20) goto LAB_0010e82b;
            }
            else {
              if (uVar10 != 0x40) goto LAB_0010e82b;
            }
          }
          else {
LAB_0010e82b:
            if ((*(byte *)(lVar8 + 2) & param_7) == param_7) goto LAB_0010e844;
          }
LAB_0010eaed:
          do {
            uVar10 = (uint)uVar6;
            uVar6 = (ulong)(uVar10 + 1);
            if (param_3 - 1 <= uVar10) break;
          } while (*(short *)(param_2 + uVar6 * 0x158) != 0);
        }
      } while ((uint)uVar6 < param_3);
    }
    uVar5 = (ulong)*param_14;
  }
LAB_0010ec45:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar5;
}



ulong FUN_0010ede0(long param_1,long param_2,ulong param_3,long param_4,ulong param_5,
                  undefined8 param_6,byte *param_7,uint param_8)

{
  char cVar1;
  byte bVar2;
  size_t __size;
  bool bVar3;
  bool bVar4;
  byte bVar5;
  int iVar6;
  uint uVar7;
  ulong uVar8;
  long lVar9;
  byte *pbVar10;
  byte *pbVar11;
  uint uVar12;
  ulong uVar13;
  ulong uVar14;
  byte *pbVar15;
  undefined *puVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  bool bVar20;
  bool bVar21;
  byte bVar22;
  undefined8 uVar23;
  byte *local_60;
  uint local_4c;
  uint local_48;
  uint local_44;
  
  bVar22 = 0;
  if (param_3 < 2) {
LAB_0010ee24:
    uVar13 = 0;
    local_60 = (byte *)0x0;
    goto LAB_0010ee2f;
  }
  cVar1 = *(char *)(param_2 + -1 + param_3);
  uVar13 = param_3 - 1;
  while (uVar14 = uVar13, cVar1 == '\0') {
    if (uVar14 == 1) goto LAB_0010ee24;
    cVar1 = *(char *)(param_2 + -1 + uVar14);
    uVar13 = uVar14 - 1;
    param_3 = uVar14;
  }
  uVar7 = *(uint *)(param_1 + 0x38);
  if (param_5 == 0) {
    uVar19 = uVar7 & 0x1000800;
    if (uVar19 != 0) {
      return 0;
    }
    bVar4 = false;
    uVar17 = 0;
    local_4c = 0;
    bVar3 = false;
    local_48 = 0;
    bVar20 = false;
    uVar18 = 0;
    bVar21 = true;
    local_60 = (byte *)0x0;
    local_44 = 0xffffffff;
  }
  else {
    if ((uVar7 & 0x4000) == 0) {
      __size = param_5 * 6;
      uVar23 = 0x10f076;
      local_60 = (byte *)malloc(__size);
      if (local_60 == (byte *)0x0) {
        uVar13 = 0xffffffff;
        FUN_00113100(param_1,__size);
        goto LAB_0010ee2f;
      }
      uVar13 = 0;
      pbVar15 = local_60 + __size;
      pbVar10 = local_60;
      do {
        uVar14 = *(ulong *)(param_4 + uVar13 * 8);
        bVar5 = (byte)uVar14;
        if (uVar14 < 0x80) {
          if ((long)(pbVar15 + -(long)pbVar10) < 1) goto LAB_0010f4c3;
          *pbVar10 = bVar5;
          pbVar11 = pbVar10 + 1;
        }
        else {
          if (uVar14 < 0x800) {
            if ((long)(pbVar15 + -(long)pbVar10) < 2) goto LAB_0010f4c3;
            pbVar11 = pbVar10 + 2;
            pbVar10[1] = (bVar5 & 0x3f) + 0x80;
            *pbVar10 = (char)(uVar14 >> 6) - 0x40;
          }
          else {
            if (uVar14 < 0x10000) {
              if ((long)(pbVar15 + -(long)pbVar10) < 3) goto LAB_0010f4c3;
              pbVar11 = pbVar10 + 3;
              *pbVar10 = (char)(uVar14 >> 0xc) - 0x20;
              pbVar10[2] = (bVar5 & 0x3f) + 0x80;
              pbVar10[1] = ((byte)(uVar14 >> 6) & 0x3f) + 0x80;
            }
            else {
              if (uVar14 < 0x200000) {
                if ((long)(pbVar15 + -(long)pbVar10) < 4) goto LAB_0010f4c3;
                pbVar11 = pbVar10 + 4;
                *pbVar10 = (char)(uVar14 >> 0x12) - 0x10;
                pbVar10[1] = ((byte)(uVar14 >> 0xc) & 0x3f) + 0x80;
                pbVar10[3] = (bVar5 & 0x3f) + 0x80;
                pbVar10[2] = ((byte)(uVar14 >> 6) & 0x3f) + 0x80;
              }
              else {
                bVar2 = (byte)(uVar14 >> 0x18);
                if (uVar14 < 0x4000000) {
                  if ((long)(pbVar15 + -(long)pbVar10) < 5) goto LAB_0010f4c3;
                  pbVar11 = pbVar10 + 5;
                  *pbVar10 = bVar2 - 8;
                  pbVar10[1] = ((byte)(uVar14 >> 0x12) & 0x3f) + 0x80;
                  pbVar10[2] = ((byte)(uVar14 >> 0xc) & 0x3f) + 0x80;
                  pbVar10[4] = (bVar5 & 0x3f) + 0x80;
                  pbVar10[3] = ((byte)(uVar14 >> 6) & 0x3f) + 0x80;
                }
                else {
                  if ((0x7fffffff < uVar14) || ((long)(pbVar15 + -(long)pbVar10) < 6))
                  goto LAB_0010f4c3;
                  pbVar11 = pbVar10 + 6;
                  *pbVar10 = (char)(uVar14 >> 0x1e) - 4;
                  pbVar10[1] = (bVar2 & 0x3f) + 0x80;
                  pbVar10[2] = ((byte)(uVar14 >> 0x12) & 0x3f) + 0x80;
                  pbVar10[3] = ((byte)(uVar14 >> 0xc) & 0x3f) + 0x80;
                  pbVar10[5] = (bVar5 & 0x3f) + 0x80;
                  pbVar10[4] = ((byte)(uVar14 >> 6) & 0x3f) + 0x80;
                }
              }
            }
          }
        }
        uVar13 = uVar13 + 1;
        pbVar10 = pbVar11;
      } while (param_5 != uVar13);
      if (pbVar11 == (byte *)0x0) {
LAB_0010f4c3:
        uVar13 = 0xffffffff;
        goto LAB_0010ee2f;
      }
      uVar19 = FUN_0010d8f0(param_1,local_60,pbVar11 + -(long)local_60,0,0,0x40,(ulong)param_8);

      local_44 = 0xffffffff;
      if (uVar19 != 0) {
        local_44 = uVar19;
      }
      if ((*(uint *)(param_1 + 0x38) & 0x1000800) != 0) {
        uVar13 = (ulong)(local_44 != 0xffffffff);
        goto LAB_0010ee2f;
      }
    }
    else {
      if ((uVar7 & 0x1000800) != 0) {
        return 0;
      }
      local_44 = 0xffffffff;
      local_60 = (byte *)0x0;
    }
    bVar3 = false;
    uVar18 = 0;
    uVar19 = 0;
    local_4c = 0;
    local_48 = 0;
    bVar21 = false;
    uVar17 = 0;
    bVar4 = false;
    uVar13 = 0;
    uVar14 = 0xffffffffffffffff;
    do {
      while (uVar8 = uVar13, lVar9 = *(long *)(param_4 + uVar8 * 8), lVar9 != 10) {
        uVar19 = (uVar19 + 1) - (uint)!bVar21;
        if (lVar9 == 0xd) {
          bVar21 = true;
          uVar14 = uVar8;
LAB_0010f018:
          if (uVar14 + 300 < uVar8) {
            bVar3 = true;
          }
          if (lVar9 == 0x1b) {
            bVar4 = true;
          }
          else {
            if (lVar9 == 8) {
              uVar17 = 1;
            }
          }
        }
        else {
          if (lVar9 != 0x85) {
            bVar21 = false;
            goto LAB_0010f018;
          }
          uVar18 = uVar18 + 1;
          bVar21 = false;
          uVar14 = uVar8;
        }
        uVar13 = uVar8 + 1;
        if (param_5 == uVar8 + 1) goto LAB_0010ef2f;
      }
      if (bVar21) {
        local_48 = local_48 + 1;
      }
      else {
        local_4c = local_4c + 1;
      }
      bVar21 = false;
      if (0xfffffffffffffed3 < uVar8) {
        bVar3 = true;
      }
      uVar13 = uVar8 + 1;
      uVar14 = uVar8;
    } while (param_5 != uVar8 + 1);
LAB_0010ef2f:
    bVar20 = false;
    bVar21 = !bVar21;
    if (!bVar21) {
      uVar12 = (uint)(param_3 < *(ulong *)(param_1 + 0xe0));
      bVar20 = CARRY4(uVar19,uVar12);
      uVar19 = uVar19 + uVar12;
      bVar21 = uVar19 == 0;
    }
  }
  lVar9 = 7;
  pbVar15 = param_7;
  pbVar10 = (byte *)"binary";
  do {
    if (lVar9 == 0) break;
    lVar9 = lVar9 + -1;
    bVar20 = *pbVar15 < *pbVar10;
    bVar21 = *pbVar15 == *pbVar10;
    pbVar15 = pbVar15 + (ulong)bVar22 * -2 + 1;
    pbVar10 = pbVar10 + (ulong)bVar22 * -2 + 1;
  } while (bVar21);
  uVar12 = SEXT14((char)((!bVar20 && !bVar21) - bVar20));
  uVar13 = (ulong)uVar12;
  if (uVar12 == 0) goto LAB_0010ee2f;
  uVar12 = uVar7 & 0x410;
  if (uVar12 != 0) {
    uVar13 = 1;
    lVar9 = FUN_001139a0(param_1);
    if (((lVar9 == 0) && ((uVar7 & 0x10) != 0)) &&
       (iVar6 = FUN_00112ee0(param_1,"text/plain"), iVar6 == -1)) {
      uVar13 = (ulong)local_44;
    }
    goto LAB_0010ee2f;
  }
  lVar9 = FUN_001139a0(param_1);
  if (lVar9 != 0) {
    iVar6 = FUN_00113b30(param_1," text$",0x118228);
    uVar13 = (ulong)local_44;
    if (iVar6 == -1) goto LAB_0010ee2f;
    if (iVar6 == 0) {
      iVar6 = FUN_00113b30(param_1," text executable$",0x118228);
      if (iVar6 == -1) goto LAB_0010ee2f;
      if (iVar6 == 0) {
        iVar6 = FUN_00112ee0(param_1,0x118228);
        if (iVar6 == -1) goto LAB_0010ee2f;
      }
      else {
        uVar12 = 1;
      }
    }
  }
  iVar6 = FUN_00112ee0(param_1,0x11ad2b,param_6);
  uVar13 = (ulong)local_44;
  if ((iVar6 == -1) || (iVar6 = FUN_00112ee0(param_1,0x11ad2a,param_7), iVar6 == -1))
  goto LAB_0010ee2f;
  if (uVar12 != 0) {
    iVar6 = FUN_00112ee0(param_1," executable");
    uVar13 = (ulong)local_44;
    if (iVar6 == -1) goto LAB_0010ee2f;
  }
  if (bVar3) {
    iVar6 = FUN_00112ee0(param_1,", with very long lines");
    uVar13 = (ulong)local_44;
    if (iVar6 == -1) goto LAB_0010ee2f;
  }
  uVar7 = local_48 | uVar19 | uVar18;
  if ((local_4c | uVar7) == 0) {
    iVar6 = FUN_00112ee0(param_1,", with");
    uVar13 = (ulong)local_44;
    if (iVar6 == -1) goto LAB_0010ee2f;
    puVar16 = &DAT_0011a8d6;
LAB_0010f5b2:
    iVar6 = FUN_00112ee0(param_1,puVar16);
    uVar13 = (ulong)local_44;
    if (iVar6 == -1) goto LAB_0010ee2f;
LAB_0010f3e3:
    iVar6 = FUN_00112ee0(param_1," line terminators");
    uVar13 = (ulong)local_44;
    if (iVar6 == -1) goto LAB_0010ee2f;
  }
  else {
    if (uVar7 != 0) {
      iVar6 = FUN_00112ee0(param_1,", with");
      if (iVar6 == -1) {
        uVar13 = (ulong)local_44;
        goto LAB_0010ee2f;
      }
      if (local_48 == 0) {
LAB_0010f393:
        if (uVar19 != 0) {
          iVar6 = FUN_00112ee0(param_1,&DAT_0011a8f2);
          uVar13 = (ulong)local_44;
          if (iVar6 == -1) goto LAB_0010ee2f;
          if ((local_4c | uVar18) == 0) goto LAB_0010f3e3;
          iVar6 = FUN_00112ee0(param_1,&DAT_0011b6eb);
          if (iVar6 == -1) goto LAB_0010ee2f;
        }
        if (local_4c == 0) {
          if (uVar18 != 0) {
LAB_0010f64a:
            puVar16 = &DAT_0011a8fa;
            goto LAB_0010f5b2;
          }
        }
        else {
          iVar6 = FUN_00112ee0(param_1,&DAT_0011a8f6);
          uVar13 = (ulong)local_44;
          if (iVar6 == -1) goto LAB_0010ee2f;
          if (uVar18 != 0) {
            iVar6 = FUN_00112ee0(param_1,&DAT_0011b6eb);
            if (iVar6 == -1) goto LAB_0010ee2f;
            goto LAB_0010f64a;
          }
        }
      }
      else {
        iVar6 = FUN_00112ee0(param_1," CRLF");
        uVar13 = (ulong)local_44;
        if (iVar6 == -1) goto LAB_0010ee2f;
        if ((local_4c | uVar19 | uVar18) != 0) {
          iVar6 = FUN_00112ee0(param_1,&DAT_0011b6eb);
          if (iVar6 == -1) goto LAB_0010ee2f;
          goto LAB_0010f393;
        }
      }
      goto LAB_0010f3e3;
    }
  }
  if (bVar4) {
    iVar6 = FUN_00112ee0(param_1,", with escape sequences");
    uVar13 = (ulong)local_44;
    if (iVar6 == -1) goto LAB_0010ee2f;
  }
  uVar13 = 1;
  if (uVar17 != 0) {
    iVar6 = FUN_00112ee0(param_1,", with overstriking");
    if (iVar6 != -1) {
      local_44 = uVar17;
    }
    uVar13 = (ulong)local_44;
  }
LAB_0010ee2f:
  free(local_60);
  return uVar13;
}



ulong FUN_0010f780(undefined8 param_1,long param_2,ulong param_3,uint param_4)

{
  char cVar1;
  ulong uVar2;
  uint uVar3;
  long in_FS_OFFSET;
  void *local_58;
  undefined8 local_50;
  undefined8 local_48;
  undefined8 local_40;
  undefined8 local_38;
  long local_30;
  
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  local_58 = (void *)0x0;
  local_50 = 0;
  local_48 = 0;
  local_40 = 0;
  local_38 = 0;
  if (1 < param_3) {
    cVar1 = *(char *)(param_2 + -1 + param_3);
    uVar2 = param_3 - 1;
    while ((cVar1 == '\0' && (param_3 = uVar2, uVar2 != 1))) {
      cVar1 = *(char *)(param_2 + -1 + uVar2);
      uVar2 = uVar2 - 1;
    }
  }
  uVar3 = FUN_0010fa40(param_1,param_2,param_3,&local_58,&local_50,&local_48,&local_40,&local_38);
  if (uVar3 != 0) {
    uVar3 = FUN_0010ede0(param_1,param_2,param_3,local_58,local_50,local_48,local_38,(ulong)param_4)
    ;
  }
  free(local_58);
  if (local_30 == *(long *)(in_FS_OFFSET + 0x28)) {
    return (ulong)uVar3;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 FUN_0010f8a0(long param_1,ulong param_2,long param_3,long *param_4)

{
  byte bVar1;
  long lVar2;
  bool bVar3;
  bool bVar4;
  int iVar5;
  undefined8 uVar6;
  ulong uVar7;
  ulong uVar8;
  ulong uVar9;
  
  if (param_3 != 0) {
    *param_4 = 0;
  }
  if (param_2 == 0) {
    return 1;
  }
  bVar3 = false;
  uVar8 = 0;
  bVar4 = false;
  do {
    bVar1 = *(byte *)(param_1 + uVar8);
    if ((char)bVar1 < '\0') {
      if ((bVar1 & 0x40) == 0) {
        return 0xffffffff;
      }
      if ((bVar1 & 0x20) == 0) {
        iVar5 = 1;
        uVar7 = (ulong)((uint)bVar1 & 0x1f);
      }
      else {
        if ((bVar1 & 0x10) == 0) {
          iVar5 = 2;
          uVar7 = (ulong)((uint)bVar1 & 0xf);
        }
        else {
          if ((bVar1 & 8) == 0) {
            iVar5 = 3;
            uVar7 = (ulong)((uint)bVar1 & 7);
          }
          else {
            if ((bVar1 & 4) == 0) {
              iVar5 = 4;
              uVar7 = (ulong)((uint)bVar1 & 3);
            }
            else {
              if ((bVar1 & 2) != 0) {
                return 0xffffffff;
              }
              iVar5 = 5;
              uVar7 = (ulong)((uint)bVar1 & 1);
            }
          }
        }
      }
      uVar8 = uVar8 + 1;
      uVar9 = (iVar5 - 1) + uVar8;
      while( true ) {
        if (param_2 <= uVar8) goto LAB_0010f908;
        bVar1 = *(byte *)(param_1 + uVar8);
        if (-1 < (char)bVar1) {
          return 0xffffffff;
        }
        if ((bVar1 & 0x40) != 0) {
          return 0xffffffff;
        }
        uVar7 = uVar7 * 0x40 + (ulong)((uint)bVar1 & 0x3f);
        if (uVar9 == uVar8) break;
        uVar8 = uVar8 + 1;
      }
      bVar4 = true;
      if (param_3 != 0) {
        lVar2 = *param_4;
        *param_4 = lVar2 + 1;
        *(ulong *)(param_3 + lVar2 * 8) = uVar7;
      }
    }
    else {
      if ((&DAT_0011ab80)[(ulong)bVar1] != '\x01') {
        bVar3 = true;
      }
      if (param_3 != 0) {
        lVar2 = *param_4;
        *param_4 = lVar2 + 1;
        *(ulong *)(param_3 + lVar2 * 8) = (ulong)bVar1;
      }
    }
    uVar8 = uVar8 + 1;
  } while (uVar8 < param_2);
LAB_0010f908:
  uVar6 = 0;
  if ((!bVar3) && (uVar6 = 2, !bVar4)) {
    return 1;
  }
  return uVar6;
}



undefined8 FUN_0010fa40(undefined8 param_1,byte *param_2,ulong param_3,void **param_4,ulong *param_5, char **param_6,undefined8 *param_7,undefined8 *param_8)

{
  size_t __size;
  long *plVar1;
  byte bVar2;
  byte bVar3;
  bool bVar4;
  int iVar5;
  void *pvVar6;
  ulong uVar7;
  char *pcVar8;
  ulong uVar9;
  ulong uVar10;
  byte *pbVar11;
  undefined8 uVar12;
  byte *__ptr;
  
  *param_8 = 0x11a980;
  *param_5 = 0;
  *param_6 = "unknown";
  *param_7 = 0x11a888;
  __size = param_3 + 1;
  pvVar6 = calloc(1,__size * 8);
  *param_4 = pvVar6;
  if (pvVar6 == (void *)0x0) {
    uVar12 = 1;
    __ptr = (byte *)0x0;
    FUN_00113100(param_1,__size * 8);
    goto LAB_0010fbae;
  }
  __ptr = (byte *)calloc(1,__size);
  if (__ptr == (byte *)0x0) {
    uVar12 = 1;
    FUN_00113100(param_1,__size);
    goto LAB_0010fbae;
  }
  *param_5 = 0;
  if (param_3 == 0) {
LAB_0010fc60:
    uVar12 = 1;
    *param_6 = "ASCII";
    *param_7 = 0x11a999;
    goto LAB_0010fbae;
  }
  uVar9 = (ulong)*param_2;
  if ((&DAT_0011ab80)[uVar9] == '\x01') {
    uVar7 = 1;
    do {
      *param_5 = uVar7;
      *(ulong *)((long)pvVar6 + uVar7 * 8 + -8) = uVar9;
      if (param_3 == uVar7) {
        if (((((param_3 < 5) || (*param_2 != 0x2b)) || (param_2[1] != 0x2f)) ||
            ((param_2[2] != 0x76 || (0x39 < param_2[3])))) ||
           ((0x300880000000000U >> ((ulong)param_2[3] & 0x1f) & 1) == 0)) goto LAB_0010fc60;
        *param_5 = 0;
        uVar12 = 1;
        *param_6 = "UTF-7 Unicode";
        *param_7 = 0x11a993;
        goto LAB_0010fbae;
      }
      uVar9 = (ulong)param_2[uVar7];
      uVar7 = uVar7 + 1;
    } while ((&DAT_0011ab80)[uVar9] == '\x01');
  }
  if (((param_3 < 4) || (*param_2 != 0xef)) || ((param_2[1] != 0xbb || (param_2[2] != 0xbf)))) {
LAB_0010fca7:
    iVar5 = FUN_0010f8a0(param_2,param_3,pvVar6,param_5);
    if (iVar5 < 2) {
      pvVar6 = *param_4;
      if (1 < param_3) {
        if (*param_2 == 0xff) {
          if (param_2[1] == 0xfe) {
            bVar4 = false;
            *param_5 = 0;
            if (3 < param_3) goto LAB_0010fe05;
LAB_0010fe7c:
            uVar12 = 1;
            *param_6 = "Little-endian UTF-16 Unicode";
            *param_7 = 0x11a9ec;
            goto LAB_0010fbae;
          }
        }
        else {
          if ((*param_2 == 0xfe) && (param_2[1] == 0xff)) {
            *param_5 = 0;
            if (3 < param_3) {
              bVar4 = true;
LAB_0010fe05:
              pbVar11 = param_2 + 2;
              uVar9 = 0;
              do {
                bVar2 = *pbVar11;
                bVar3 = pbVar11[1];
                plVar1 = (long *)((long)pvVar6 + uVar9 * 8);
                *param_5 = uVar9 + 1;
                if (bVar4) {
                  *plVar1 = (long)(int)((uint)bVar3 + (uint)bVar2 * 0x100);
                }
                else {
                  *plVar1 = (long)(int)((uint)bVar3 * 0x100 + (uint)bVar2);
                }
                uVar9 = *param_5;
                uVar7 = *(ulong *)((long)pvVar6 + uVar9 * 8 + -8);
                if ((uVar7 == 0xfffe) || ((uVar7 < 0x80 && ((&DAT_0011ab80)[uVar7] != '\x01'))))
                goto LAB_0010fcf0;
                pbVar11 = pbVar11 + 2;
              } while (param_2 + (param_3 - 4 & 0xfffffffffffffffe) + 4 != pbVar11);
              if (!bVar4) goto LAB_0010fe7c;
            }
            uVar12 = 1;
            *param_6 = "Big-endian UTF-16 Unicode";
            *param_7 = 0x11aa0f;
            goto LAB_0010fbae;
          }
        }
      }
LAB_0010fcf0:
      *param_5 = 0;
      uVar9 = (ulong)*param_2;
      if ((int)(char)(&DAT_0011ab80)[uVar9] - 1U < 2) {
        pbVar11 = param_2 + 1;
        uVar7 = 0;
        while( true ) {
          *param_5 = uVar7 + 1;
          *(ulong *)((long)pvVar6 + uVar7 * 8) = uVar9;
          if (param_2 + param_3 == pbVar11) break;
          uVar9 = (ulong)*pbVar11;
          pbVar11 = pbVar11 + 1;
          if (1 < (int)(char)(&DAT_0011ab80)[uVar9] - 1U) goto LAB_0010fd6d;
          uVar7 = *param_5;
        }
        uVar12 = 1;
        *param_6 = "ISO-8859";
        *param_7 = 0x11aa21;
      }
      else {
LAB_0010fd6d:
        *param_5 = 0;
        uVar9 = (ulong)*param_2;
        if ((int)(char)(&DAT_0011ab80)[*param_2] - 1U < 3) {
          pbVar11 = param_2 + 1;
          uVar7 = 0;
          while( true ) {
            *param_5 = uVar7 + 1;
            *(ulong *)((long)pvVar6 + uVar7 * 8) = uVar9;
            if (param_2 + param_3 == pbVar11) break;
            uVar9 = (ulong)*pbVar11;
            pbVar11 = pbVar11 + 1;
            if (2 < (int)(char)(&DAT_0011ab80)[uVar9] - 1U) goto LAB_0010fea0;
            uVar7 = *param_5;
          }
          uVar12 = 1;
          *param_6 = "Non-ISO extended-ASCII";
          *param_7 = 0x11aa43;
        }
        else {
LAB_0010fea0:
          uVar9 = 0;
          do {
            __ptr[uVar9] = (&DAT_0011aa80)[param_2[uVar9]];
            uVar9 = uVar9 + 1;
          } while (param_3 != uVar9);
          uVar9 = (ulong)*__ptr;
          *param_5 = 0;
          if ((&DAT_0011ab80)[uVar9] == '\x01') {
            uVar7 = 0;
            uVar10 = uVar9;
            pbVar11 = __ptr;
            while( true ) {
              pbVar11 = pbVar11 + 1;
              *param_5 = uVar7 + 1;
              *(ulong *)((long)pvVar6 + uVar7 * 8) = uVar10;
              if (pbVar11 == __ptr + param_3) break;
              uVar10 = (ulong)*pbVar11;
              if ((&DAT_0011ab80)[uVar10] != '\x01') goto LAB_0010ff8f;
              uVar7 = *param_5;
            }
            uVar12 = 1;
            *param_6 = "EBCDIC";
            *param_7 = 0x11aa50;
          }
          else {
            if ((&DAT_0011ab80)[uVar9] == '\x02') {
LAB_0010ff8f:
              uVar7 = 0;
              pbVar11 = __ptr;
              while( true ) {
                pbVar11 = pbVar11 + 1;
                *param_5 = uVar7 + 1;
                *(ulong *)((long)pvVar6 + uVar7 * 8) = uVar9;
                if (pbVar11 == __ptr + param_3) break;
                uVar9 = (ulong)*pbVar11;
                if (1 < (int)(char)(&DAT_0011ab80)[uVar9] - 1U) goto LAB_0010ffe0;
                uVar7 = *param_5;
              }
              uVar12 = 1;
              *param_6 = "International EBCDIC";
              *param_7 = 0x11aa50;
            }
            else {
LAB_0010ffe0:
              uVar12 = 0;
              *param_8 = 0x11a888;
            }
          }
        }
      }
      goto LAB_0010fbae;
    }
    pcVar8 = "UTF-8 Unicode";
  }
  else {
    iVar5 = FUN_0010f8a0(param_2 + 3,param_3 - 3,pvVar6,param_5);
    if (iVar5 < 1) {
      pvVar6 = *param_4;
      goto LAB_0010fca7;
    }
    pcVar8 = "UTF-8 Unicode (with BOM)";
  }
  *param_6 = pcVar8;
  uVar12 = 1;
  *param_7 = 0x11a9bb;
LAB_0010fbae:
  free(__ptr);
  return uVar12;
}



size_t FUN_00110050(int param_1,void *param_2,size_t param_3)

{
  int *piVar1;
  ssize_t sVar2;
  size_t __n;
  
  __n = param_3;
  do {
    while (sVar2 = write(param_1,param_2,__n), sVar2 != -1) {
      __n = __n - sVar2;
      param_2 = (void *)((long)param_2 + sVar2);
      if (__n == 0) {
        return param_3;
      }
    }
    piVar1 = __errno_location();
    if (*piVar1 != 4) {
      return 0xffffffffffffffff;
    }
  } while (__n != 0);
  return param_3;
}



undefined8
FUN_001100b0(undefined4 param_1,undefined4 param_2,const char * param_3, ...)

{
  char in_AL;
  int iVar1;
  undefined8 uVar2;
  size_t sVar3;
  long in_FS_OFFSET;
  char *local_f0;
  undefined4 local_e8;
  undefined4 local_e4;
  undefined *local_e0;
  undefined *local_d8;
  long local_d0;
  undefined local_c8 [24];
  undefined8 local_b0;
  undefined8 local_a8;
  undefined8 local_a0;
  undefined4 local_98;
  undefined4 local_88;
  undefined4 local_78;
  undefined4 local_68;
  undefined4 local_58;
  undefined4 local_48;
  undefined4 local_38;
  undefined4 local_28;
  
  if (in_AL != '\0') {
    local_98 = param_1;
    local_88 = param_2;

  }
  local_d0 = *(long *)(in_FS_OFFSET + 0x28);
  local_e0 = &stack0x00000008;
  local_d8 = local_c8;
  local_e8 = 0x18;
  local_e4 = 0x30;
  iVar1 = vasprintf(&local_f0,1,param_3,&local_e8);
  if (iVar1 < 0) {
    param_1 = (char *)0x0;
    uVar2 = 1;
    param_2 = 0;
  }
  else {
    param_1 = local_f0;
    sVar3 = strlen(local_f0);
    param_2 = sVar3;
    uVar2 = 2;
  }
  if (local_d0 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar2;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 FUN_001101b0(undefined8 param_1,char **param_2,long param_3,size_t *param_4,int param_5)

{
  uint uVar1;
  size_t sVar2;
  undefined8 uVar3;
  int *piVar4;
  char *pcVar5;
  long in_FS_OFFSET;
  undefined8 local_a8;
  undefined4 local_a0;
  char *local_90;
  undefined4 local_88;
  size_t local_80;
  long local_78;
  undefined8 local_68;
  undefined8 local_60;
  undefined8 local_58;
  long local_30;
  
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  pcVar5 = (char *)malloc(param_3 + 1);
  *param_2 = pcVar5;
  if (pcVar5 == (char *)0x0) {
    piVar4 = __errno_location();
    pcVar5 = strerror(*piVar4);
    uVar3 = FUN_001100b0(param_2,param_4,"No buffer, %s",pcVar5);
  }
  else {
    local_88 = (undefined4)param_3;
    local_68 = 0;
    local_60 = 0;
    local_a0 = (undefined4)*param_4;
    local_58 = 0;
    local_a8 = param_1;
    local_90 = pcVar5;
    if (param_5 == 0) {
      uVar1 = inflateInit2_(&local_a8,0xfffffff1,"1.2.11",0x70);
    }
    else {
      uVar1 = inflateInit_(&local_a8,"1.2.11",0x70);
    }
    if (uVar1 == 0) {
      uVar1 = inflate(&local_a8,2);
      if (uVar1 < 2) {
        *param_4 = local_80;
        uVar3 = inflateEnd(&local_a8);
        uVar1 = (uint)uVar3;
        if (uVar1 == 0) {
          (*param_2)[*param_4] = '\0';
          goto LAB_00110285;
        }
      }
    }
    if (local_78 == 0) {
      zError();
    }
    FUN_00117c00(*param_2,local_78,param_3);
    sVar2 = strlen(*param_2);
    *param_4 = sVar2;
    uVar3 = 2;
  }
LAB_00110285:
  if (local_30 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar3;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void FUN_00110350(int *param_1)

{
  if (*param_1 != -1) {
    close(*param_1);
    *param_1 = -1;
  }
  if (param_1[1] == -1) {
    return;
  }
  close(param_1[1]);
  param_1[1] = -1;
  return;
}



ulong FUN_00110380(int param_1,void *param_2,size_t param_3,int param_4)

{
  byte bVar1;
  int iVar2;
  ulong uVar3;
  int *piVar4;
  long lVar5;
  ulong uVar6;
  fd_set *pfVar7;
  long in_FS_OFFSET;
  long local_f0;
  int local_dc;
  timeval local_d8;
  __fd_mask local_c8 [17];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_dc = 0;
  uVar6 = param_3;
  if ((param_1 != 0) && (param_4 != 0)) {
    iVar2 = ioctl(param_1,0x541b,&local_dc);
    if ((iVar2 == -1) || (local_dc == 0)) {
      local_f0 = 0;
      bVar1 = (byte)(param_1 >> 0x37);
      while( true ) {
        local_d8.tv_sec = 0;
        local_d8.tv_usec = 100000;
        lVar5 = 0x10;
        pfVar7 = (fd_set *)local_c8;
        while (lVar5 != 0) {
          lVar5 = lVar5 + -1;
          pfVar7->__fds_bits[0] = 0;
          pfVar7 = (fd_set *)(pfVar7->__fds_bits + 1);
        }

        *(ulong *)(local_c8 + lVar5 * 8) =
             *(ulong *)(local_c8 + lVar5 * 8) |
             1 << (((char)param_1 + (bVar1 >> 2) & 0x3f) - (bVar1 >> 2) & 0x3f);
        iVar2 = select(param_1 + 1,(fd_set *)local_c8,(fd_set *)0x0,(fd_set *)0x0,&local_d8);
        if (iVar2 != -1) break;
        local_f0 = local_f0 + 1;
      }
      if ((iVar2 == 0) && (uVar3 = 0, 4 < local_f0)) goto LAB_001103e4;
      ioctl(param_1,0x541b,&local_dc);
    }
    uVar3 = SEXT48(local_dc);
    if ((0 < local_dc) && (uVar3 < param_3)) {
      param_3 = uVar3;
      uVar6 = uVar3;
    }
  }
  do {
    uVar3 = read(param_1,param_2,param_3);
    if (uVar3 == 0xffffffffffffffff) {
      piVar4 = __errno_location();
      if (*piVar4 != 4) break;
    }
    else {
      if (uVar3 == 0) {
        uVar3 = uVar6 - param_3;
        break;
      }
      param_3 = param_3 - uVar3;
      param_2 = (void *)((long)param_2 + uVar3);
    }
    uVar3 = uVar6;
  } while (param_3 != 0);
LAB_001103e4:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar3;
}



// WARNING: Could not reconcile some variable overlaps

ulong FUN_00110550(long param_1,uint param_2,undefined8 param_3,void *param_4,ulong param_5)

{
  byte bVar1;
  long lVar2;
  char **__argv;
  byte *__dest;
  size_t sVar3;
  uint uVar4;
  uint uVar5;
  int __fd;
  __pid_t _Var6;
  __sighandler_t __handler;
  char *pcVar7;
  long lVar8;
  void *__ptr;
  ulong uVar9;
  ulong uVar10;
  size_t sVar11;
  int *piVar12;
  char *pcVar13;
  ushort **ppuVar14;
  __int32_t **pp_Var15;
  undefined *puVar16;
  int __fd2;
  ulong __n;
  byte *__src;
  ushort *puVar17;
  long lVar18;
  long in_FS_OFFSET;
  int local_c0;
  uint local_b4;
  undefined *local_90;
  size_t local_88;
  undefined local_6c [4];
  byte *local_68;
  size_t local_60;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 local_48;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_68 = (byte *)0x0;
  local_b4 = *(uint *)(param_1 + 0x38) & 4;
  if (local_b4 == 0) {
LAB_00110599:
    if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
      return (ulong)local_b4;
    }
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  uVar4 = *(uint *)(param_1 + 0x38) & 0x410;
  lVar18 = 1;
  __handler = signal(0xd,(__sighandler_t)0x1);
  pcVar7 = " (";
  local_b4 = 0;
  __n = 2;
  if (uVar4 != 0) {
    pcVar7 = " compressed-encoding=";
  }
LAB_00110628:
  lVar8 = lVar18 + -1;
  if (param_5 < __n) {
joined_r0x0011096c:
    if (lVar18 == 0xe) goto LAB_00110a08;
  }
  else {
    if (__n == 0) {
      uVar5 = (**(void*(*)())(&DAT_0031f508 + lVar18 * 0x18))(param_4);
    }
    else {
      __fd = memcmp(param_4,*(void*(*)())(&DAT_0031f508 + lVar18 * 0x18),__n);
      uVar5 = (uint)(__fd == 0);
    }
    if (uVar5 == 0) goto joined_r0x0011096c;
    lVar2 = *(long *)(param_1 + 0xe0);
    local_60 = param_5;
    if (lVar8 != 2) {
      if (__n == 0) {
        local_c0 = FUN_001101b0(param_4,&local_68,lVar2,&local_60,1);
      }
      else {
        fflush(stdout);
        fflush(stderr);
        local_58 = 0xffffffffffffffff;
        local_50 = 0xffffffffffffffff;
        local_48 = 0xffffffffffffffff;
        if ((((param_2 == 0xffffffff) && (__fd = pipe((int *)&local_58), __fd == -1)) ||
            (__fd = pipe((int *)&local_50), __fd == -1)) ||
           (__fd = pipe((int *)&local_48), __fd == -1)) {
          FUN_00110350(&local_58);
          FUN_00110350(0);
          piVar12 = __errno_location();
          pcVar13 = strerror(*piVar12);
          local_c0 = FUN_001100b0(&local_68,&local_60,"Cannot create pipe, %s",pcVar13);
        }
        else {
          _Var6 = fork();
          if (_Var6 == -1) {
            piVar12 = __errno_location();
            pcVar13 = strerror(*piVar12);
            local_c0 = FUN_001100b0(&local_68,&local_60,"Cannot fork, %s",pcVar13);
          }
          else {
            if (_Var6 == 0) {
              if (param_2 != 0xffffffff) {
                local_58 = local_58 & 0xffffffff00000000 | (ulong)param_2;
                lseek(param_2,0,0);
              }
              lVar18 = 0;
              goto LAB_00110f81;
            }
            if (local_50 != -1) {
              close(local_50);
              local_50 = CONCAT44(0xffffffff,(int)local_50);
            }
            if (local_48 != -1) {
              close(local_48);
              local_48 = CONCAT44(0xffffffff,(int)local_48);
            }
            sVar3 = local_60;
            if (param_2 == 0xffffffff) {
              if ((int)local_58 != -1) {
                close((int)local_58);
                local_58 = local_58 & 0xffffffff00000000 | 0xffffffff;
              }
              _Var6 = fork();
              if (_Var6 == -1) goto LAB_00110fa5;
              if (_Var6 == 0) {
                if ((int)local_50 != -1) {
                  close((int)local_50);
                  local_50 = CONCAT44(local_50,0xffffffff);
                }
                sVar11 = FUN_00110050(local_58 >> 0x20,param_4,sVar3);
                if (sVar11 == sVar3) {
                    // WARNING: Subroutine does not return
                  exit(0);
                }
                goto LAB_00110fa5;
              }
              _Var6 = wait(local_6c);
              if (_Var6 == -1) goto LAB_00110fa5;
              if (local_58 != -1) {
                close(local_58);
                local_58 = CONCAT44(0xffffffff,(int)local_58);
              }
            }
            local_90 = local_6c;
            local_68 = (byte *)malloc(lVar2 + 1);
            if (local_68 == (byte *)0x0) {
              piVar12 = __errno_location();
              pcVar13 = strerror(*piVar12);
              local_c0 = FUN_001100b0(&local_68,&local_60,"No buffer, %s",pcVar13);
            }
            else {
              local_88 = FUN_00110380(local_50 & 0xffffffff,local_68,lVar2,0);
              local_c0 = 0;
              if ((long)local_88 < 1) {
                if (local_88 == 0) {
                  local_88 = FUN_00110380(local_48 & 0xffffffff,local_68,lVar2,0);
                  __dest = local_68;
                  if (0 < (long)local_88) {
                    local_68[local_88] = 0;
                    ppuVar14 = __ctype_b_loc();
                    __src = __dest;
                    while ((*(byte *)((long)*ppuVar14 + (ulong)*__src * 2 + 1) & 0x20) != 0) {
                      __src = __src + 1;
                    }
                    pcVar13 = strchr((char *)__src,10);
                    if (pcVar13 != (char *)0x0) {
                      *pcVar13 = '\0';
                    }
                    pcVar13 = strchr((char *)__src,0x3b);
                    if (pcVar13 != (char *)0x0) {
                      *pcVar13 = '\0';
                    }
                    pcVar13 = strrchr((char *)__src,0x3a);
                    puVar17 = *ppuVar14;
                    if (pcVar13 != (char *)0x0) {
                      __src = (byte *)(pcVar13 + 1);
                      bVar1 = *(byte *)((long)puVar17 + (ulong)(byte)pcVar13[1] * 2 + 1);
                      while ((bVar1 & 0x20) != 0) {
                        __src = __src + 1;
                        bVar1 = *(byte *)((long)puVar17 + (ulong)*__src * 2 + 1);
                      }
                      local_88 = strlen((char *)__src);
                      memmove(__dest,__src,local_88 + 1);
                      puVar17 = *ppuVar14;
                    }
                    local_c0 = 2;
                    bVar1 = *__dest;
                    if ((*(byte *)((long)puVar17 + (ulong)bVar1 * 2 + 1) & 2) != 0) {
                      pp_Var15 = __ctype_toupper_loc();
                      *__dest = (byte)(*pp_Var15)[(ulong)bVar1];
                      local_c0 = 2;
                    }
                    goto LAB_001107a8;
                  }
                  free(local_68);
                  if (local_88 == 0) {
                    piVar12 = __errno_location();
                    pcVar13 = strerror(*piVar12);
                    local_c0 = FUN_001100b0(&local_68,&local_60,"Read failed, %s",pcVar13);
                    goto LAB_001107b6;
                  }
                }
                else {
                  free(local_68);
                }
                local_c0 = FUN_001100b0(&local_68,&local_60,"No data");
              }
              else {
LAB_001107a8:
                local_68[local_88] = 0;
                local_60 = local_88;
              }
            }
LAB_001107b6:
            if (local_58 != -1) {
              close(local_58);
              local_58 = CONCAT44(0xffffffff,(int)local_58);
            }
            if ((int)local_50 != -1) {
              close((int)local_50);
              local_50 = CONCAT44(local_50,0xffffffff);
            }
            if ((int)local_48 != -1) {
              close((int)local_48);
              local_48 = CONCAT44(local_48,0xffffffff);
            }
            _Var6 = wait(local_90);
            if (_Var6 == -1) {
              free(local_68);
              piVar12 = __errno_location();
              pcVar13 = strerror(*piVar12);
              local_c0 = FUN_001100b0(&local_68,&local_60,"Wait failed, %s",pcVar13);
            }
            if ((int)local_58 != -1) {
              close((int)local_58);
            }
          }
        }
      }
      if (local_c0 == 1) goto joined_r0x0011096c;
LAB_001109b6:
      if ((local_c0 != 2) && (local_c0 != 0)) {
                    // WARNING: Subroutine does not return
        abort();
      }
      *(uint *)(param_1 + 0x38) = *(uint *)(param_1 + 0x38) & 0xfffffffb;
      if (local_c0 == 2) {
        if ((__n == 0) || (lVar8 == 2)) {
          puVar16 = &DAT_0011acd5;
        }
        else {
          puVar16 = (undefined *)**(undefined8 **)(&DAT_0031f518 + lVar18 * 0x18);
        }
        __fd = FUN_00112ee0(param_1,"%s ERROR: %s",puVar16);
      }
      else {
        __fd = FUN_00113170(param_1,0xffffffff,param_3,local_68,0);
      }
      if (__fd != -1) {
        if (((*(byte *)(param_1 + 0x3b) & 2) != 0) || ((uVar4 != 0x410 && (uVar4 != 0)))) {
          local_b4 = 1;
LAB_00110a08:
          signal(0xd,__handler);
          free(local_68);
          *(uint *)(param_1 + 0x38) = *(uint *)(param_1 + 0x38) | 4;
          goto LAB_00110599;
        }
        __fd = FUN_00112ee0(param_1,pcVar7);
        if (((__fd != -1) && (lVar8 = FUN_00113c50(param_1), lVar8 != 0)) &&
           (__fd = FUN_00113170(param_1,0xffffffff,0,param_4,0), __fd != -1)) {
          __ptr = (void *)FUN_00113ca0(param_1,lVar8);
          if (__ptr != (void *)0x0) {
            local_b4 = FUN_00112ee0(param_1,0x11ad2b,__ptr);
            if (local_b4 == 0xffffffff) {
              free(__ptr);
              goto joined_r0x0011096c;
            }
            free(__ptr);
          }
          if ((uVar4 != 0) || (__fd = FUN_00112ee0(param_1,0x119fd9), __fd != -1)) {
            local_b4 = 1;
            goto joined_r0x0011096c;
          }
        }
      }
      local_b4 = 0xffffffff;
      goto joined_r0x0011096c;
    }
    bVar1 = *(byte *)((long)param_4 + 3);
    if ((bVar1 & 4) == 0) {
      uVar10 = 10;
LAB_00110b25:
      if ((bVar1 & 8) != 0) {
        uVar9 = uVar10;
        if (uVar10 < param_5) {
          do {
            uVar9 = uVar10;
            if (*(char *)((long)param_4 + uVar10) == '\0') break;
            uVar10 = uVar10 + 1;
            uVar9 = param_5;
          } while (param_5 != uVar10);
        }
        uVar10 = uVar9 + 1;
      }
      if ((bVar1 & 0x10) != 0) {
        uVar9 = uVar10;
        if (uVar10 < param_5) {
          do {
            uVar9 = uVar10;
            if (*(char *)((long)param_4 + uVar10) == '\0') break;
            uVar10 = uVar10 + 1;
            uVar9 = param_5;
          } while (param_5 != uVar10);
        }
        uVar10 = uVar9 + 1;
      }
      if ((bVar1 & 2) != 0) {
        uVar10 = uVar10 + 2;
      }
      if (param_5 <= uVar10) goto LAB_00110ae8;
      local_60 = param_5 - uVar10;
      local_c0 = FUN_001101b0((long)param_4 + uVar10,&local_68,lVar2,&local_60,0);
    }
    else {
      if (0xb < param_5) {
        uVar10 = (long)(int)((uint)*(byte *)((long)param_4 + 10) + 2 +
                            (uint)*(byte *)((long)param_4 + 0xb) * 0x100) + 10;
        goto LAB_00110b25;
      }
LAB_00110ae8:
      local_c0 = FUN_001100b0(&local_68,&local_60,"File too short");
    }
    if (local_c0 != 1) goto LAB_001109b6;
  }
  __n = *(ulong *)(&DAT_0031f528 + lVar18 * 0x18);
  lVar18 = lVar18 + 1;
  goto LAB_00110628;
LAB_00110f81:
  do {
    __fd2 = (int)lVar18;
    __fd = *(int *)((long)&local_58 + (ulong)(__fd2 != 0) * 4 + lVar18 * 8);
    if (__fd2 != __fd) {
      __fd = dup2(__fd,__fd2);
      if (__fd == -1) goto LAB_00110fa5;
      FUN_00110350(0);
    }
    lVar18 = lVar18 + 1;
  } while (lVar18 != 3);
  __argv = (char **)(&PTR_PTR_DAT_0031f530)[lVar8 * 3];
  execvp(*__argv,__argv);
  piVar12 = __errno_location();
  pcVar7 = strerror(*piVar12);
  __dprintf_chk(2,1,"exec `%s\' failed, %s",*__argv,pcVar7);
LAB_00110fa5:
                    // WARNING: Subroutine does not return
  exit(1);
}



ulong FUN_00111000(undefined8 param_1,uint param_2,undefined8 param_3,long param_4)

{
  uint __fd;
  uint __fd_00;
  uint *puVar1;
  long lVar2;
  ulong uVar3;
  __off_t _Var4;
  ulong uVar5;
  long in_FS_OFFSET;
  char local_1048 [4104];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  FUN_00117c00(local_1048,"/tmp/file.XXXXXX",0x1000);
  __fd = mkstemp(local_1048);
  puVar1 = (uint *)__errno_location();
  __fd_00 = *puVar1;
  unlink(local_1048);
  *puVar1 = __fd_00;
  if (__fd == 0xffffffff) {
    uVar5 = 0xffffffff;
    FUN_00112ce0(param_1,(ulong)__fd_00,"cannot create temporary file for pipe copy");
    goto LAB_001110eb;
  }
  lVar2 = FUN_00110050((ulong)__fd,param_3,param_4);
  if (lVar2 == param_4) {
    do {
      uVar5 = FUN_00110380((ulong)param_2,local_1048,0x1000,1);
      if ((long)uVar5 < 1) break;
      uVar3 = FUN_00110050((ulong)__fd,local_1048,uVar5);
    } while (uVar3 == uVar5);
    if (uVar5 == 0xffffffffffffffff) {
      FUN_00112ce0(param_1,(ulong)*puVar1,"error copying from pipe to temp file");
      goto LAB_001110eb;
    }
    if (uVar5 == 0) {
      __fd_00 = dup2(__fd,param_2);
      uVar5 = (ulong)__fd_00;
      if (__fd_00 == 0xffffffff) {
        FUN_00112ce0(param_1,(ulong)*puVar1,"could not dup descriptor for temp file");
      }
      else {
        close(__fd);
        _Var4 = lseek(__fd_00,0,0);
        if (_Var4 == -1) {
          FUN_00113130(param_1);
          uVar5 = 0xffffffff;
        }
      }
      goto LAB_001110eb;
    }
  }
  uVar5 = 0xffffffff;
  FUN_00112ce0(param_1,(ulong)*puVar1,"error while writing to temp file");
LAB_001110eb:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar5 & 0xffffffff;
}



undefined8 FUN_001111d0(long param_1,byte *param_2,ulong param_3)

{
  byte bVar1;
  uint uVar2;
  char cVar3;
  ushort **ppuVar4;
  ulong uVar5;
  byte *pbVar6;
  undefined8 uVar7;
  long lVar8;
  int iVar9;
  char *pcVar10;
  uint uVar11;
  byte *pbVar12;
  bool bVar13;
  bool bVar14;
  bool bVar15;
  byte bVar16;
  
  bVar16 = 0;
  uVar2 = *(uint *)(param_1 + 0x38);
  if (((uVar2 & 0x1000800) != 0) || (param_3 < 0x200)) {
    return 0;
  }
  pbVar12 = param_2 + 0x94;
  ppuVar4 = __ctype_b_loc();
  iVar9 = 8;
  do {
    uVar5 = (ulong)*pbVar12;
    if ((*(byte *)((long)*ppuVar4 + uVar5 * 2 + 1) & 0x20) == 0) {
      uVar11 = 0;
      pbVar6 = pbVar12 + (ulong)(iVar9 - 1) + 1;
      goto LAB_00111255;
    }
    pbVar12 = pbVar12 + 1;
    iVar9 = iVar9 + -1;
  } while (iVar9 != 0);
  uVar11 = 0xffffffff;
LAB_00111275:
  iVar9 = 0;
  pbVar12 = param_2;
  do {
    pbVar6 = pbVar12 + 1;
    iVar9 = iVar9 + (uint)*pbVar12;
    pbVar12 = pbVar6;
  } while (pbVar6 != param_2 + 0x200);
  pbVar12 = param_2 + 0x9b;
  do {
    bVar1 = *pbVar12;
    pbVar12 = pbVar12 + -1;
    iVar9 = iVar9 - (char)bVar1;
  } while (param_2 + 0x93 != pbVar12);
  uVar7 = 0;
  if (iVar9 + 0x100U == uVar11) {
    bVar13 = (byte *)0xfffffffffffffefe < param_2;
    param_2 = param_2 + 0x101;
    bVar15 = param_2 == (byte *)0x0;
    lVar8 = 8;
    iVar9 = 3;
    pbVar12 = param_2;
    pbVar6 = (byte *)"ustar  ";
    do {
      if (lVar8 == 0) break;
      lVar8 = lVar8 + -1;
      bVar13 = *pbVar12 < *pbVar6;
      bVar15 = *pbVar12 == *pbVar6;
      pbVar12 = pbVar12 + (ulong)bVar16 * -2 + 1;
      pbVar6 = pbVar6 + (ulong)bVar16 * -2 + 1;
    } while (bVar15);
    bVar14 = false;
    bVar13 = (!bVar13 && !bVar15) == bVar13;
    if (!bVar13) {
      lVar8 = 6;
      pbVar12 = (byte *)"ustar";
      do {
        if (lVar8 == 0) break;
        lVar8 = lVar8 + -1;
        bVar14 = *param_2 < *pbVar12;
        bVar13 = *param_2 == *pbVar12;
        param_2 = param_2 + (ulong)bVar16 * -2 + 1;
        pbVar12 = pbVar12 + (ulong)bVar16 * -2 + 1;
      } while (bVar13);
      iVar9 = (uint)((!bVar14 && !bVar13) == bVar14) + 1;
    }
    pcVar10 = "application/x-tar";
    if ((uVar2 & 0x410) == 0) {
      pcVar10 = "tar archive" + (long)(iVar9 + -1) * 0x20;
    }
    uVar7 = FUN_00112ee0(param_1,0x11ad2b,pcVar10);
    if ((int)uVar7 != -1) {
      return 1;
    }
  }
  return uVar7;
LAB_00111255:
  cVar3 = (char)uVar5;
  if (7 < (byte)(cVar3 - 0x30U)) goto LAB_00111365;
  pbVar12 = pbVar12 + 1;
  uVar11 = uVar11 << 3 | (int)cVar3 - 0x30U;
  if (pbVar6 == pbVar12) goto LAB_00111275;
  uVar5 = (ulong)*pbVar12;
  goto LAB_00111255;
LAB_00111365:
  if ((cVar3 != '\0') && ((*(byte *)((long)*ppuVar4 + uVar5 * 2 + 1) & 0x20) == 0)) {
    uVar11 = 0xffffffff;
  }
  goto LAB_00111275;
}



ulong FUN_00111390(long param_1,uint param_2,char *param_3,ulong param_4)

{
  byte bVar1;
  char cVar2;
  ushort uVar3;
  ulong uVar4;
  ushort uVar5;
  int iVar6;
  undefined uVar15;
  uint uVar7;
  uint uVar8;
  __off_t _Var9;
  undefined uVar14;
  ulong uVar10;
  ulong uVar11;
  int *piVar12;
  ulong uVar13;
  ushort uVar16;
  undefined uVar17;
  ushort uVar18;
  ushort uVar19;
  undefined uVar22;
  ushort uVar20;
  char *pcVar21;
  ulong uVar23;
  long in_FS_OFFSET;
  undefined8 uVar24;
  undefined8 uVar25;
  uint local_100;
  short local_de;
  uint local_dc;
  stat local_d8;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_dc = 0;
  if (((((*(uint *)(param_1 + 0x38) & 0x1000c10) != 0) || (*param_3 != '\x7f')) ||
      ((param_3[1] != 'E' && (param_3[1] != 'O')))) || ((param_3[2] != 'L' || (param_3[3] != 'F'))))
  {
LAB_001113cd:
    uVar11 = 0;
    goto LAB_001113cf;
  }
  _Var9 = lseek(param_2,0,0);
  if ((_Var9 == -1) && (piVar12 = __errno_location(), *piVar12 == 0x1d)) {
    param_2 = FUN_00111000(param_1,(ulong)param_2,param_3,0);
  }
  uVar24 = 0x111448;
  iVar6 = __fxstat(1,param_2,&local_d8);
  if (iVar6 == -1) {
    FUN_00113150(param_1);
    uVar11 = 0xffffffff;
    goto LAB_001113cf;
  }
  if (((local_d8.st_mode & 0xf000) != 0x8000) && (local_d8.st_size == 0)) {
    local_d8.st_size = -1;
  }
  bVar1 = param_3[4];
  if (bVar1 == 1) {
    if (param_4 < 0x35) goto LAB_001113cd;
    uVar16 = *(ushort *)(param_3 + 0x12);
    cVar2 = param_3[5];
    uVar5 = *(ushort *)(param_3 + 0x10);
    uVar8 = *(uint *)(param_3 + 0x1c);
    uVar7 = *(uint *)(param_3 + 0x20);
    uVar23 = (ulong)*(ushort *)(param_3 + 0x2a);
    uVar20 = *(ushort *)(param_3 + 0x2c);
    uVar11 = (ulong)uVar20;
    uVar3 = *(ushort *)(param_3 + 0x30);
    uVar19 = *(ushort *)(param_3 + 0x2e);
    local_de = *(short *)(param_1 + 0xd8);
    uVar18 = *(ushort *)(param_3 + 0x32);
    local_100 = (uint)(cVar2 != '\x01');
    uVar22 = (undefined)(uVar11 >> 8);
    uVar15 = (undefined)(uVar23 >> 8);
    uVar17 = (undefined)*(ushort *)(param_3 + 0x2a);
    if (cVar2 == '\x01') {
      if (uVar5 < 4) {
        if (uVar5 < 2) {
          if (uVar5 != 1) goto LAB_001115c5;
        }
        else {
          if (*(ushort *)(param_1 + 0xd6) < uVar20) goto LAB_00111aa5;
          uVar4 = (ulong)uVar3;
          if (*(ushort *)(param_1 + 0xd4) < uVar3) goto LAB_00111a96;
          iVar6 = FUN_001053f0(param_1,1,0,(ulong)param_2,(ulong)uVar8,uVar11,uVar23,
                               local_d8.st_size,(ulong)uVar3,&local_dc,&local_de);
          if (iVar6 == -1) goto LAB_001118c3;
        }
        uVar11 = (ulong)uVar3;
        if (*(ushort *)(param_1 + 0xd4) < uVar3) goto LAB_00111a84;
LAB_0011172f:
        uVar10 = (ulong)uVar7;
        uVar24 = 1;
LAB_001115b0:
        iVar6 = FUN_0010590f(param_1,uVar24,(ulong)local_100,(ulong)param_2,uVar10,uVar11,
                             (ulong)uVar19,local_d8.st_size,(ulong)uVar16,(ulong)uVar18,&local_dc,
                             &local_de);
        if (iVar6 == -1) goto LAB_001118c3;
      }
      else {
        if (uVar5 == 4) goto LAB_00111a13;
      }
LAB_001115c5:
      uVar11 = 1;
      if (local_de != 0) goto LAB_001113cf;
      uVar11 = (ulong)*(ushort *)(param_1 + 0xd8);
      pcVar21 = "notes";
    }
    else {
      uVar5 = CONCAT11((char)uVar5,(char)((ulong)uVar5 >> 8));
      if (uVar5 < 4) {
        uVar14 = (undefined)((ulong)uVar3 >> 8);
        if (uVar5 < 2) {
          if (uVar5 != 1) goto LAB_001115c5;
LAB_001116ba:
          uVar5 = CONCAT11((char)uVar3,uVar14);
          if (*(ushort *)(param_1 + 0xd4) <= uVar5 && uVar5 != *(ushort *)(param_1 + 0xd4))
          goto LAB_00111a80;
          uVar18 = CONCAT11((char)uVar18,(char)(uVar18 >> 8));
          uVar16 = CONCAT11((char)uVar16,(char)(uVar16 >> 8));
          uVar19 = CONCAT11((char)uVar19,(char)((ulong)uVar19 >> 8));
          uVar7 = entry((ulong)uVar7);
          uVar11 = (ulong)uVar5;
          goto LAB_0011172f;
        }
        uVar5 = CONCAT11((char)uVar20,uVar22);
        uVar11 = (ulong)uVar5;
        if (uVar5 < *(ushort *)(param_1 + 0xd6) || uVar5 == *(ushort *)(param_1 + 0xd6)) {
          uVar20 = CONCAT11((char)uVar3,uVar14);
          uVar4 = (ulong)uVar20;
          if (uVar20 < *(ushort *)(param_1 + 0xd4) || uVar20 == *(ushort *)(param_1 + 0xd4)) {
            uVar24 = 0x111875;
            uVar8 = entry(0);
            iVar6 = FUN_001053f0(param_1,1,1,(ulong)param_2,(ulong)uVar8,(ulong)uVar5,
                                 (ulong)CONCAT11(uVar17,uVar15),local_d8.st_size,(ulong)uVar20,
                                 &local_dc,&local_de);
            if (iVar6 != -1) goto LAB_001116ba;
            goto LAB_001118c3;
          }
LAB_00111a96:
          uVar11 = uVar4;
          pcVar21 = "section";
        }
        else {
LAB_00111aa5:
          pcVar21 = "program";
        }
      }
      else {
        if (uVar5 != 4) goto LAB_001115c5;
LAB_00111a13:
        if (cVar2 == '\x01') {
          if (uVar20 <= *(ushort *)(param_1 + 0xd6)) {
            local_dc = local_dc | 0x100;
            goto LAB_00111a5a;
          }
        }
        else {
          uVar16 = CONCAT11((char)uVar20,uVar22);
          if (uVar16 <= *(ushort *)(param_1 + 0xd6)) {
            local_dc = local_dc | 0x100;
            uVar11 = (ulong)uVar16;
            uVar23 = (ulong)CONCAT11(uVar17,uVar15);
            uVar8 = entry(0);
LAB_00111a5a:
            uVar13 = (ulong)uVar8;
            uVar24 = 1;
            goto LAB_001119ef;
          }
LAB_00111ad2:
          uVar11 = (ulong)uVar16;
        }
LAB_00111ad5:
        pcVar21 = "program headers";
      }
    }
LAB_001115e4:
    iVar6 = FUN_00112ee0(param_1,", too many %s (%u)",pcVar21,uVar11);
    uVar11 = (ulong)-(uint)(iVar6 == -1);
  }
  else {
    if (bVar1 != 2) {
      iVar6 = FUN_00112ee0(param_1,", unknown class %d",(ulong)bVar1);
      uVar11 = (ulong)-(uint)(iVar6 == -1);
      goto LAB_001113cf;
    }
    if (param_4 < 0x41) goto LAB_001113cd;
    uVar16 = *(ushort *)(param_3 + 0x12);
    cVar2 = param_3[5];
    uVar5 = *(ushort *)(param_3 + 0x10);
    uVar13 = *(ulong *)(param_3 + 0x20);
    uVar10 = *(ulong *)(param_3 + 0x28);
    uVar23 = (ulong)*(ushort *)(param_3 + 0x36);
    uVar20 = *(ushort *)(param_3 + 0x38);
    uVar11 = (ulong)uVar20;
    uVar3 = *(ushort *)(param_3 + 0x3c);
    uVar19 = *(ushort *)(param_3 + 0x3a);
    local_de = *(short *)(param_1 + 0xd8);
    uVar18 = *(ushort *)(param_3 + 0x3e);
    local_100 = (uint)(cVar2 != '\x01');
    uVar22 = (undefined)(uVar11 >> 8);
    uVar15 = (undefined)(uVar23 >> 8);
    uVar17 = (undefined)*(ushort *)(param_3 + 0x36);
    if (cVar2 == '\x01') {
      if (3 < uVar5) {
        if (uVar5 == 4) goto LAB_00111985;
        goto LAB_001115c5;
      }
      if (uVar5 < 2) {
        if (uVar5 != 1) goto LAB_001115c5;
      }
      else {
        if (*(ushort *)(param_1 + 0xd6) <= uVar20 && uVar20 != *(ushort *)(param_1 + 0xd6))
        goto LAB_00111aa5;
        uVar4 = (ulong)uVar3;
        if (*(ushort *)(param_1 + 0xd4) <= uVar3 && uVar3 != *(ushort *)(param_1 + 0xd4))
        goto LAB_00111a96;
        iVar6 = FUN_001053f0(param_1,2,0,(ulong)param_2,uVar13,uVar11,uVar23,local_d8.st_size,
                             (ulong)uVar3,&local_dc,&local_de);
        if (iVar6 == -1) goto LAB_001118c3;
      }
      uVar11 = (ulong)uVar3;
      if (uVar3 < *(ushort *)(param_1 + 0xd4) || uVar3 == *(ushort *)(param_1 + 0xd4))
      goto LAB_0011158f;
LAB_00111a84:
      pcVar21 = "section headers";
      goto LAB_001115e4;
    }
    uVar5 = CONCAT11((char)uVar5,(char)((ulong)uVar5 >> 8));
    if (uVar5 < 4) {
      uVar14 = (undefined)((ulong)uVar3 >> 8);
      if (uVar5 < 2) {
        if (uVar5 != 1) goto LAB_001115c5;
      }
      else {
        uVar5 = CONCAT11((char)uVar20,uVar22);
        uVar11 = (ulong)uVar5;
        if (*(ushort *)(param_1 + 0xd6) <= uVar5 && uVar5 != *(ushort *)(param_1 + 0xd6))
        goto LAB_00111aa5;
        uVar20 = CONCAT11((char)uVar3,uVar14);
        uVar4 = (ulong)uVar20;
        if (*(ushort *)(param_1 + 0xd4) <= uVar20 && uVar20 != *(ushort *)(param_1 + 0xd4))
        goto LAB_00111a96;
        uVar25 = 0x111928;
        uVar24 = FUN_00103e0f(uVar13);
        iVar6 = FUN_001053f0(param_1,2,1,(ulong)param_2,uVar24,(ulong)uVar5,
                             (ulong)CONCAT11(uVar17,uVar15),local_d8.st_size,(ulong)uVar20,&local_dc
                             ,&local_de);
        if (iVar6 == -1) goto LAB_001118c3;
      }
      uVar5 = CONCAT11((char)uVar3,uVar14);
      if (*(ushort *)(param_1 + 0xd4) <= uVar5 && uVar5 != *(ushort *)(param_1 + 0xd4)) {
LAB_00111a80:
        uVar11 = (ulong)uVar5;
        goto LAB_00111a84;
      }
      uVar18 = CONCAT11((char)uVar18,(char)(uVar18 >> 8));
      uVar16 = CONCAT11((char)uVar16,(char)(uVar16 >> 8));
      uVar19 = CONCAT11((char)uVar19,(char)((ulong)uVar19 >> 8));
      uVar10 = FUN_00103e0f(uVar10);
      uVar11 = (ulong)uVar5;
LAB_0011158f:
      uVar24 = 2;
      goto LAB_001115b0;
    }
    if (uVar5 != 4) goto LAB_001115c5;
LAB_00111985:
    if (cVar2 == '\x01') {
      if (*(ushort *)(param_1 + 0xd6) < uVar20) goto LAB_00111ad5;
      local_dc = local_dc | 0x100;
    }
    else {
      uVar16 = CONCAT11((char)uVar20,uVar22);
      uVar11 = (ulong)uVar16;
      if (*(ushort *)(param_1 + 0xd6) < uVar16) goto LAB_00111ad2;
      local_dc = local_dc | 0x100;
      uVar23 = (ulong)CONCAT11(uVar17,uVar15);
      uVar13 = FUN_00103e0f(uVar13);
    }
    uVar24 = 2;
LAB_001119ef:
    iVar6 = FUN_0010512c(param_1,uVar24,(ulong)local_100,(ulong)param_2,uVar13,uVar11,uVar23,
                         local_d8.st_size,&local_dc,&local_de);
    if (iVar6 != -1) goto LAB_001115c5;
LAB_001118c3:
    uVar11 = 0xffffffff;
  }
LAB_001113cf:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar11;
}



void FUN_00111c10(undefined4 param_1,const char* param_2,...)

{
  char in_AL;
  long in_FS_OFFSET;
  undefined4 local_e8;
  undefined4 local_e4;
  undefined *local_e0;
  undefined *local_d8;
  long local_d0;
  undefined local_c8 [16];
  undefined8 local_b8;
  undefined8 local_b0;
  undefined8 local_a8;
  undefined8 local_a0;
  undefined4 local_98;
  undefined4 local_88;
  undefined4 local_78;
  undefined4 local_68;
  undefined4 local_58;
  undefined4 local_48;
  undefined4 local_38;
  undefined4 local_28;
  
  if (in_AL != '\0') {
    local_98 = param_1;
    local_88 = param_2;
  }
  local_d0 = *(long *)(in_FS_OFFSET + 0x28);
  fflush(stdout);
  if (*(long *)(param_1 + 0x40) != 0) {
    fprintf(stderr,1,"%s, %lu: ",param_2,
                  *(undefined8 *)(param_1 + 0x48));
  }
  fwrite("Warning: ",1,9,stderr);
  local_e0 = &stack0x00000008;
  local_e8 = 0x10;
  local_d8 = local_c8;
  local_e4 = 0x30;
  __vfprintf_chk(stderr,1,param_2,&local_e8);
  fputc(10,stderr);
  if (local_d0 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 * FUN_00111d40(time_t param_1,ulong param_2,undefined8 *param_3)

{
  tm *__tp;
  undefined8 *__s;
  size_t sVar1;
  long in_FS_OFFSET;
  time_t local_60;
  time_t local_58;
  long local_20;
  
  local_20 = *(long *)(in_FS_OFFSET + 0x28);
  local_60 = param_1;
  if ((param_2 & 2) != 0) {
    FUN_00116ae0(&local_58,param_1);
    local_60 = local_58;
  }
  if ((param_2 & 1) == 0) {
    __tp = gmtime_r(&local_60,&local_58);
  }
  else {
    __tp = localtime_r(&local_60,&local_58);
  }
  if ((__tp == (tm *)0x0) ||
     (__s = (undefined8 *)asctime_r(__tp,(char *)param_3), __s == (undefined8 *)0x0)) {
    *(undefined4 *)(param_3 + 1) = 0x6d697420;
    *(undefined *)((long)param_3 + 0xe) = 0;
    *param_3 = 0x64696c61766e492a;
    *(undefined2 *)((long)param_3 + 0xc) = 0x2a65;
  }
  else {
    sVar1 = strcspn((char *)__s,"\n");
    *(undefined *)((long)__s + sVar1) = 0;
    param_3 = __s;
  }
  if (local_20 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return param_3;
}



// WARNING: Type propagation algorithm not settling

void FUN_00111e30(ushort *param_1)

{
  byte bVar1;
  uint uVar2;
  undefined1 *puVar3;
  undefined8 uVar4;
  ulong uVar5;
  char *pcVar6;
  long in_FS_OFFSET;
  double dVar7;
  undefined auStack72 [40];
  long local_20;
  
  local_20 = *(long *)(in_FS_OFFSET + 0x28);
  fprintf(stderr,1,"%u: %.*s %u",(ulong)*(uint *)(param_1 + 10),
                (ulong)(((uint)*param_1 & 7) + 1),">>>>>>>>",(ulong)*(uint *)(param_1 + 6));
  bVar1 = *(byte *)(param_1 + 1);
  if ((bVar1 & 1) != 0) {
    fprintf(stderr,1,&DAT_0011b6e1);
    bVar1 = *(byte *)(param_1 + 4);
    if ((bVar1 & 0x40) != 0) {
      fputc(0x7e,stderr);
      bVar1 = *(byte *)(param_1 + 4);
    }
    fprintf(stderr,1,&DAT_0011b6e6,(ulong)(uint)(int)"&|^+-*/%"[(uint)bVar1 & 7],
                  (ulong)*(uint *)(param_1 + 8));
    bVar1 = *(byte *)(param_1 + 1);
  }
  pcVar6 = "*bad type";
  if (*(byte *)(param_1 + 3) < 0x31) {
    pcVar6 = *(char **)(&DAT_003205e0 + (ulong)*(byte *)(param_1 + 3) * 8);
  }
  puVar3 = &DAT_0011ad97;
  if ((bVar1 & 8) != 0) {
    puVar3 = (undefined1 *)0x11c359;
  }
  fprintf(stderr,1,&DAT_0011b6ed,puVar3,pcVar6);
  if ((*(byte *)((long)param_1 + 9) & 0x40) != 0) {
    fputc(0x7e,stderr);
  }
  if ((*(byte *)(param_1 + 3) < 0x2f) &&
     ((0x6200001e2020U >> ((ulong)*(byte *)(param_1 + 3) & 0x1f) & 1) != 0)) {
    if (*(int *)(param_1 + 0xe) != 0) {
      fputc(0x2f,stderr);
      uVar2 = *(uint *)(param_1 + 0xe);
      if ((uVar2 & 1) != 0) {
        fputc(0x57,stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 2) != 0) {
        fputc(0x77,stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 4) != 0) {
        fputc(99,stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 8) != 0) {
        fputc(0x43,stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x10) != 0) {
        fputc(0x73,stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x20) != 0) {
        fputc(0x74,stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x40) != 0) {
        fputc(0x62,stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x80) != 0) {
        fputc(0x42,stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x100) != 0) {
        fputc(0x48,stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x200) != 0) {
        fputc(0x68,stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x400) != 0) {
        fputc(0x4c,stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x800) != 0) {
        fputc(0x6c,stderr);
        uVar2 = *(uint *)(param_1 + 0xe);
      }
      if ((uVar2 & 0x1000) != 0) {
        fputc(0x4a,stderr);
      }
    }
    if (*(int *)(param_1 + 0xc) != 0) {
      fprintf(stderr,1,&DAT_0011b6f3);
    }
  }
  else {
    fputc((int)"&|^+-*/%"[(uint)*(byte *)((long)param_1 + 9) & 7],stderr);
    if (*(long *)(param_1 + 0xc) != 0) {
      fprintf(stderr,1,"%.8llx");
    }
  }
  fprintf(stderr,1,&DAT_0011b6fe);
  if (*(char *)(param_1 + 2) == 'x') goto switchD_00111ff9_caseD_3;
  switch(*(undefined *)(param_1 + 3)) {
  default:
    fprintf(stderr,1,"*bad type %d*");
    break;
  case 1:
  case 2:
  case 4:
  case 7:
  case 8:
  case 10:
  case 0xb:
  case 0x17:
  case 0x29:
    fprintf(stderr,1,0x11b0c8,(ulong)*(uint *)(param_1 + 0x10));
    break;
  case 3:
    break;
  case 5:
  case 0xd:
  case 0x11:
  case 0x12:
  case 0x13:
  case 0x14:
    FUN_001089a0(stderr,param_1 + 0x10,(ulong)*(byte *)((long)param_1 + 5));
    break;
  case 6:
  case 9:
  case 0xc:
  case 0x15:
    uVar5 = (ulong)*(uint *)(param_1 + 0x10);
    uVar4 = 0;
    goto LAB_00112008;
  case 0xe:
  case 0xf:
  case 0x10:
  case 0x16:
    uVar5 = (ulong)*(uint *)(param_1 + 0x10);
    goto LAB_00112186;
  case 0x18:
  case 0x19:
  case 0x1a:
    fprintf(stderr,1,&DAT_0011b702,*(undefined8 *)(param_1 + 0x10));
    break;
  case 0x1b:
  case 0x1c:
  case 0x1d:
    uVar5 = *(ulong *)(param_1 + 0x10);
    uVar4 = 0;
    goto LAB_00112008;
  case 0x1e:
  case 0x1f:
  case 0x20:
    uVar5 = *(ulong *)(param_1 + 0x10);
LAB_00112186:
    uVar4 = 1;
    goto LAB_00112008;
  case 0x21:
  case 0x22:
  case 0x23:
    dVar7 = (double)*(float *)(param_1 + 0x10);
    goto LAB_001121d9;
  case 0x24:
  case 0x25:
  case 0x26:
    dVar7 = *(double *)(param_1 + 0x10);
LAB_001121d9:
    fprintf(0,stderr,1,&DAT_0011b707);
    break;
  case 0x2a:
  case 0x2b:
  case 0x2c:
    uVar5 = *(ulong *)(param_1 + 0x10);
    uVar4 = 2;
LAB_00112008:
    uVar4 = FUN_00111d40(uVar5,uVar4,auStack72);
    fprintf(stderr,1,&DAT_0011b6e2,uVar4);
    break;
  case 0x2d:
  case 0x2e:
  case 0x30:
    fprintf(stderr,1,0x11b0bd,param_1 + 0x10);
  }
switchD_00111ff9_caseD_3:
  fprintf(stderr,1,",\"%s\"]\n",param_1 + 0x40);
  if (local_20 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return;
}



undefined8 FUN_00112410(long param_1,uint param_2,undefined8 param_3)

{
  uint uVar1;
  int iVar2;
  
  uVar1 = *(uint *)(param_1 + 0x38);
  if (((uVar1 & 0x10) == 0) || (iVar2 = FUN_00112ee0(param_1,"inode/symlink"), iVar2 != -1)) {
    if ((uVar1 & 0x410) != 0) {
      return 1;
    }
    if ((*(byte *)(param_1 + 0x39) & 2) == 0) {
      iVar2 = FUN_00112ee0(param_1,"broken symbolic link to %s");
      if (iVar2 != -1) {
        return 1;
      }
    }
    else {
      FUN_00112ce0(param_1,(ulong)param_2,"broken symbolic link to %s",param_3);
    }
  }
  return 0xffffffff;
}



ulong FUN_001124b0(undefined8 param_1,ulong param_2)

{
  int iVar1;
  undefined8 uVar2;
  
  if ((param_2 & 0x10) == 0) {
    if ((param_2 & 0x400) != 0) {
LAB_001124fe:
      iVar1 = FUN_00112ee0(param_1,"binary");
      return (ulong)-(uint)(iVar1 == -1);
    }
LAB_001124c5:
    uVar2 = 0;
  }
  else {
    iVar1 = FUN_00112ee0(param_1,"inode/%s");
    if (iVar1 != -1) {
      if ((param_2 & 0x400) == 0) goto LAB_001124c5;
      iVar1 = FUN_00112ee0(param_1,"; charset=");
      if (iVar1 != -1) goto LAB_001124fe;
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



ulong FUN_00112530(long param_1,char *param_2,stat *param_3)

{
  ulong uVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  uint *puVar6;
  char *__buf;
  ssize_t sVar7;
  char *pcVar8;
  int *piVar9;
  long lVar10;
  undefined1 *puVar11;
  uint uVar12;
  char *__filename;
  uint uVar13;
  long in_FS_OFFSET;
  stat local_60e8;
  char local_6058 [8208];
  char local_4048;
  undefined auStack16455 [16391];
  long local_40;
  
  uVar12 = *(uint *)(param_1 + 0x38);
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if (((uVar12 & 0x1000800) != 0) || (param_2 == (char *)0x0)) {
    uVar2 = 0;
    goto LAB_001125c2;
  }
  if ((uVar12 & 2) == 0) {
    uVar2 = __lxstat(1,param_2,param_3);
  }
  else {
    uVar2 = __xstat(1,param_2,param_3);
  }
  if (uVar2 != 0) {
    puVar6 = (uint *)__errno_location();
    if ((*(byte *)(param_1 + 0x39) & 2) == 0) {
      __buf = strerror(*puVar6);
      iVar3 = FUN_00112ee0(param_1,"cannot open `%s\' (%s)",param_2,__buf);
      uVar2 = -(uint)(iVar3 == -1);
    }
    else {
      uVar2 = 0xffffffff;
      FUN_00112ce0(param_1,(ulong)*puVar6,"cannot stat `%s\'",param_2);
    }
    goto LAB_001125c2;
  }
  uVar12 = uVar12 & 0x410;
  uVar4 = param_3->st_mode;
  if (uVar12 == 0) {
    if ((uVar4 & 0x800) == 0) {
      if ((uVar4 & 0x400) == 0) {
        uVar13 = 1;
        puVar11 = &DAT_0011ad97;
        if ((uVar4 & 0x200) == 0) {
          uVar5 = uVar4 & 0xf000;
          if (uVar5 == 0x6000) goto LAB_001128a0;
          if (uVar5 < 0x6001) {
            if (uVar5 == 0x2000) goto LAB_00112928;
            if (uVar5 != 0x4000) {
              if (uVar5 != 0x1000) goto LAB_00112705;
              uVar13 = 0;
              goto LAB_00112686;
            }
LAB_00112a57:
            __buf = "%sdirectory";
          }
          else {
            uVar13 = uVar2;
            if (uVar5 == 0xa000) goto LAB_001129a3;
            if (uVar5 != 0xc000) goto LAB_001126fa;
LAB_00112b69:
            puVar11 = &DAT_0011ad97;
LAB_00112a90:
            __buf = "%ssocket";
          }
LAB_001126b0:
          iVar3 = FUN_00112ee0(param_1,__buf,puVar11);
          goto joined_r0x00112a45;
        }
LAB_00112633:
        iVar3 = FUN_00112ee0(param_1,"%ssticky",puVar11);
        if (iVar3 != -1) {
          uVar4 = param_3->st_mode;
          goto LAB_0011264d;
        }
      }
      else {
        puVar11 = &DAT_0011ad97;
        uVar13 = 1;
LAB_00112785:
        iVar3 = FUN_00112ee0(param_1,"%ssetgid",puVar11);
        if (iVar3 != -1) {
          uVar4 = param_3->st_mode;
          goto LAB_001127a3;
        }
      }
    }
    else {
      iVar3 = FUN_00112ee0(param_1,"%ssetuid",&DAT_0011ad97);
      if (iVar3 != -1) {
        uVar4 = param_3->st_mode;
        uVar13 = 2;
        puVar11 = (undefined1 *)0x118228;
        if ((uVar4 & 0x400) != 0) goto LAB_00112785;
        uVar13 = 1;
LAB_001127a3:
        if ((uVar4 & 0x200) != 0) {
          uVar13 = uVar13 + 1;
          puVar11 = (undefined1 *)0x118228;
          goto LAB_00112633;
        }
LAB_0011264d:
        uVar4 = uVar4 & 0xf000;
        if (uVar4 != 0x6000) {
          if (uVar4 < 0x6001) {
            if (uVar4 == 0x2000) goto LAB_0011292b;
            if (uVar4 == 0x4000) {
              puVar11 = (undefined1 *)0x118228;
              goto LAB_00112a57;
            }
            if (uVar4 == 0x1000) {
LAB_00112686:
              if ((*(byte *)(param_1 + 0x38) & 8) == 0) {
                puVar11 = (undefined1 *)0x118228;
                __buf = "%sfifo (named pipe)";
                if (uVar13 == 0) {
                  puVar11 = &DAT_0011ad97;
                }
                goto LAB_001126b0;
              }
              goto LAB_0011276b;
            }
          }
          else {
            if (uVar4 == 0xa000) goto LAB_001129a3;
            if (uVar4 == 0xc000) {
              puVar11 = (undefined1 *)0x118228;
              if (uVar13 == 0) goto LAB_00112b69;
              goto LAB_00112a90;
            }
            if (uVar4 == 0x8000) goto LAB_001127e1;
          }
LAB_00112705:
          uVar2 = 0xffffffff;
          FUN_00112ce0(param_1,0,"invalid mode 0%o");
          goto LAB_001125c2;
        }
        goto LAB_001128a3;
      }
    }
LAB_001126c3:
    uVar2 = 0xffffffff;
  }
  else {
    uVar5 = uVar4 & 0xf000;
    if (uVar5 == 0x6000) {
LAB_001128a0:
      uVar13 = 0;
LAB_001128a3:
      if ((*(byte *)(param_1 + 0x38) & 8) != 0) {
LAB_00112820:
        if ((uVar12 == 0) && (uVar13 != 0)) {
          iVar3 = FUN_00112ee0(param_1,0x11af78);
          uVar2 = -(uint)(iVar3 == -1);
        }
        goto LAB_001125c2;
      }
      __buf = "blockdevice";
      if (uVar12 != 0) goto LAB_00112758;
      uVar1 = param_3->st_rdev;
      param_2 = (char *)(ulong)((uint)(uVar1 >> 0x20) & 0xfffff000 | (uint)(uVar1 >> 8) & 0xfff);
      puVar11 = (undefined1 *)0x118228;
      if (uVar13 == 0) {
        puVar11 = &DAT_0011ad97;
      }
      __buf = (char *)(ulong)((uint)uVar1 & 0xff | (uint)((uVar1 >> 0x14) << 8));
      __filename = "%sblock special (%ld/%ld)";
LAB_0011290d:
      iVar3 = FUN_00112ee0(param_1,__filename,puVar11,param_2,__buf);
joined_r0x00112a45:
      if (iVar3 == -1) goto LAB_001126c3;
    }
    else {
      if (0x6000 < uVar5) {
        uVar13 = uVar2;
        if (uVar5 != 0xa000) {
          if (uVar5 == 0xc000) {
            __buf = "socket";
            goto LAB_00112758;
          }
LAB_001126fa:
          if ((uVar4 & 0xf000) != 0x8000) goto LAB_00112705;
          uVar13 = 0;
LAB_001127e1:
          if (((*(byte *)(param_1 + 0x38) & 8) != 0) || (param_3->st_size != 0)) goto LAB_00112820;
          if (uVar12 == 0) {
            puVar11 = (undefined1 *)0x118228;
            __buf = "%sempty";
            if (uVar13 == 0) {
              puVar11 = &DAT_0011ad97;
            }
            goto LAB_001126b0;
          }
          __buf = "x-empty";
          goto LAB_00112758;
        }
LAB_001129a3:
        __buf = local_6058;
        sVar7 = readlink(param_2,__buf,0x1fff);
        if (sVar7 < 1) {
          if ((*(byte *)(param_1 + 0x39) & 2) != 0) {
            puVar6 = (uint *)__errno_location();
            FUN_00112ce0(param_1,(ulong)*puVar6,"unreadable symlink `%s\'",param_2);
            goto LAB_001126c3;
          }
          if (uVar12 == 0) {
            piVar9 = __errno_location();
            __buf = strerror(*piVar9);
            puVar11 = (undefined1 *)0x118228;
            __filename = "%sunreadable symlink `%s\' (%s)";
            if (uVar13 == 0) {
              puVar11 = &DAT_0011ad97;
            }
            goto LAB_0011290d;
          }
LAB_00112b27:
          __buf = "symlink";
LAB_00112758:
          iVar3 = FUN_001124b0(param_1,(ulong)uVar12);
        }
        else {
          local_6058[sVar7] = '\0';
          if (local_6058[0] == '/') {
            iVar3 = __xstat(1,__buf,&local_60e8);
joined_r0x00112c0e:
            if (iVar3 < 0) {
              puVar6 = (uint *)__errno_location();
              uVar2 = FUN_00112410(param_1,(ulong)*puVar6,__buf);
              goto LAB_001125c2;
            }
            uVar2 = *(uint *)(param_1 + 0x38) & 2;
            if (uVar2 != 0) {
              *(uint *)(param_1 + 0x38) = uVar2;
              lVar10 = magic_file(param_1,__buf);
              *(uint *)(param_1 + 0x38) = *(uint *)(param_1 + 0x38) | 2;
              if (lVar10 != 0) goto LAB_0011276b;
              goto LAB_001126c3;
            }
            if (uVar12 != 0) goto LAB_00112b27;
            puVar11 = (undefined1 *)0x118228;
            __filename = "%ssymbolic link to %s";
            if (uVar13 == 0) {
              puVar11 = &DAT_0011ad97;
            }
          }
          else {
            pcVar8 = strrchr(param_2,0x2f);
            __filename = __buf;
            if (pcVar8 == (char *)0x0) {
LAB_00112bb2:
              iVar3 = __xstat(1,__filename,&local_60e8);
              goto joined_r0x00112c0e;
            }
            if ((long)(pcVar8 + -(long)param_2) < 0x2000) {
              FUN_00117c00(&local_4048,param_2,0x4004);
              auStack16455[(long)(pcVar8 + -(long)param_2)] = 0;
              FUN_00117c50(&local_4048,__buf,0x4004);
              __filename = &local_4048;
              goto LAB_00112bb2;
            }
            if ((*(byte *)(param_1 + 0x39) & 2) != 0) {
              uVar2 = 0xffffffff;
              FUN_00112ce0(param_1,0,0x11b949,__buf);
              goto LAB_001125c2;
            }
            __buf = "x-path-too-long";
            if (uVar12 != 0) goto LAB_00112758;
            puVar11 = (undefined1 *)0x118228;
            __filename = "%spath too long: `%s\'";
            __buf = param_2;
            if (uVar13 == 0) {
              puVar11 = &DAT_0011ad97;
            }
          }
          iVar3 = FUN_00112ee0(param_1,__filename,puVar11,__buf);
        }
        goto joined_r0x00112a45;
      }
      if (uVar5 == 0x2000) {
LAB_00112928:
        uVar13 = 0;
LAB_0011292b:
        if ((*(byte *)(param_1 + 0x38) & 8) == 0) {
          __buf = "chardevice";
          if (uVar12 != 0) goto LAB_00112758;
          uVar1 = param_3->st_rdev;
          param_2 = (char *)(ulong)((uint)(uVar1 >> 0x20) & 0xfffff000 | (uint)(uVar1 >> 8) & 0xfff)
          ;
          puVar11 = (undefined1 *)0x118228;
          if (uVar13 == 0) {
            puVar11 = &DAT_0011ad97;
          }
          __buf = (char *)(ulong)((uint)uVar1 & 0xff | (uint)((uVar1 >> 0x14) << 8));
          __filename = "%scharacter special (%ld/%ld)";
          goto LAB_0011290d;
        }
        goto LAB_00112820;
      }
      if (uVar5 == 0x4000) {
        __buf = "directory";
        goto LAB_00112758;
      }
      if (uVar5 != 0x1000) goto LAB_00112705;
      if ((*(byte *)(param_1 + 0x38) & 8) == 0) {
        __buf = "fifo";
        goto LAB_00112758;
      }
    }
LAB_0011276b:
    uVar2 = 1;
  }
LAB_001125c2:
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return (ulong)uVar2;
}



void FUN_00112cb0(void)

{
                    // WARNING: Subroutine does not return
  __assert_fail("rx->rc == 0","funcs.c",0x1fe,"file_regexec");
}



void FUN_00112ce0(undefined4 param_1,const char* param_2, ...)

{
  char in_AL;
  char *pcVar1;
  long in_FS_OFFSET;
  undefined4 local_e8;
  undefined4 local_e4;
  undefined *local_e0;
  undefined *local_d8;
  long local_d0;
  undefined local_c8 [24];
  undefined8 local_b0;
  undefined8 local_a8;
  undefined8 local_a0;
  undefined4 local_98;
  undefined4 local_88;
  undefined4 local_78;
  undefined4 local_68;
  undefined4 local_58;
  undefined4 local_48;
  undefined4 local_38;
  undefined4 local_28;
  
  if (in_AL != '\0') {
    local_98 = param_1;
    local_88 = param_2;
 }
  local_d0 = *(long *)(in_FS_OFFSET + 0x28);
  local_e0 = &stack0x00000008;
  local_d8 = local_c8;
  local_e8 = 0x18;
  local_e4 = 0x30;
  if ((*(byte *)(param_1 + 0x3c) & 1) == 0) {
    if ((*(char **)(param_1 + 0x20) != (char *)0x0) && (**(char **)(param_1 + 0x20) != '\0'))
    {
      FUN_00112ee0(param_1,0x11af78);
    }
    FUN_00112e00(param_1,param_2,&local_e8);
    if (0 < param_1) {
      pcVar1 = strerror(param_2);
      FUN_00112ee0(param_1,0x11b88a,pcVar1);
    }
    *(uint *)(param_1 + 0x3c) = *(uint *)(param_1 + 0x3c) | 1;
    *(int *)(param_1 + 0x34) = param_2;
  }
  if (local_d0 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



ulong FUN_00112e00(long param_1,undefined8 param_2,undefined8 param_3)

{
  int iVar1;
  uint *puVar2;
  uint uVar3;
  long in_FS_OFFSET;
  void *local_30;
  void *local_28;
  long local_20;
  
  local_20 = *(long *)(in_FS_OFFSET + 0x28);
  uVar3 = *(uint *)(param_1 + 0x3c) & 1;
  if (uVar3 != 0) {
    uVar3 = 0;
    goto LAB_00112e22;
  }
  iVar1 = vasprintf(&local_30,1,param_2,param_3);
  if (iVar1 < 0) {
LAB_00112eb3:
    puVar2 = (uint *)__errno_location();
    uVar3 = 0xffffffff;
    FUN_00112ce0(param_1,(ulong)*puVar2,"vasprintf failed",0);
  }
  else {
    if (*(long *)(param_1 + 0x20) != 0) {
      iVar1 = asprintf(&local_28,1,&DAT_0011b6ee);
      free(local_30);
      if (iVar1 < 0) goto LAB_00112eb3;
      free(*(void **)(param_1 + 0x20));
      local_30 = local_28;
    }
    *(void **)(param_1 + 0x20) = local_30;
  }
LAB_00112e22:
  if (local_20 == *(long *)(in_FS_OFFSET + 0x28)) {
    return (ulong)uVar3;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



int FUN_00112ee0(undefined4 param_1,undefined4 param_2,...)
{
  char in_AL;
  long in_FS_OFFSET;
  undefined4 local_d8;
  undefined4 local_d4;
  undefined *local_d0;
  undefined *local_c8;
  long local_c0;
  undefined local_b8 [16];
  undefined8 local_a8;
  undefined8 local_a0;
  undefined8 local_98;
  undefined8 local_90;
  undefined4 local_88;
  undefined4 local_78;
  undefined4 local_68;
  undefined4 local_58;
  undefined4 local_48;
  undefined4 local_38;
  undefined4 local_28;
  undefined4 local_18;
  
  if (in_AL != '\0') {
    local_88 = param_1;
    local_78 = param_2;

  }
  local_c0 = *(long *)(in_FS_OFFSET + 0x28);
  local_d0 = &stack0x00000008;
  local_c8 = local_b8;
  local_d8 = 0x10;
  local_d4 = 0x30;



  if (local_c0 == *(long *)(in_FS_OFFSET + 0x28)) {
    return 0;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 FUN_00112fa0(undefined8 param_1,undefined4 *param_2)

{
  int iVar1;
  
  iVar1 = FUN_00112ee0(param_1,&DAT_00119dc8);
  if (iVar1 == -1) {
    *param_2 = 0xffffffff;
  }
  return 0;
}



void FUN_00112fc0(undefined4 param_1,const char* param_2,...)
{
  long lVar1;
  char in_AL;
  char *__ptr;
  long in_FS_OFFSET;
  undefined4 local_e8;
  undefined4 local_e4;
  undefined *local_e0;
  undefined *local_d8;
  long local_d0;
  undefined local_c8 [16];
  undefined8 local_b8;
  undefined8 local_b0;
  undefined8 local_a8;
  undefined8 local_a0;
  undefined4 local_98;
  undefined4 local_88;
  undefined4 local_78;
  undefined4 local_68;
  undefined4 local_58;
  undefined4 local_48;
  undefined4 local_38;
  undefined4 local_28;
  
  if (in_AL != '\0') {
    local_98 = param_1;
    local_88 = param_2;

  }
  local_d0 = *(long *)(in_FS_OFFSET + 0x28);
  local_e0 = &stack0x00000008;
  local_d8 = local_c8;
  local_e8 = 0x10;
  local_e4 = 0x30;
  if ((*(byte *)(param_1 + 0x3c) & 1) == 0) {
    lVar1 = *(long *)(param_1 + 0x48);
    __ptr = *(char **)(param_1 + 0x20);
    if (lVar1 != 0) {
      free(__ptr);
      *(undefined8 *)(param_1 + 0x20) = 0;
      FUN_00112ee0(param_1,"line %zu:",lVar1);
      __ptr = *(char **)(param_1 + 0x20);
    }
    if ((__ptr != (char *)0x0) && (*__ptr != '\0')) {
      FUN_00112ee0(param_1,0x11af78);
    }
    FUN_00112e00(param_1,param_2,&local_e8);
    *(uint *)(param_1 + 0x3c) = *(uint *)(param_1 + 0x3c) | 1;
    *(undefined4 *)(param_1 + 0x34) = 0;
  }
  if (local_d0 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void FUN_00113100(undefined8 param_1,undefined8 param_2)

{
  uint *puVar1;
  
  puVar1 = (uint *)__errno_location();
  FUN_00112ce0(param_1,(ulong)*puVar1,"cannot allocate %zu bytes",param_2,0);
  return;
}



void FUN_00113130(undefined8 param_1)

{
  uint *puVar1;
  
  puVar1 = (uint *)__errno_location();
  FUN_00112ce0(param_1,(ulong)*puVar1,"error seeking",0);
  return;
}



void FUN_00113150(undefined8 param_1)

{
  uint *puVar1;
  
  puVar1 = (uint *)__errno_location();
  FUN_00112ce0(param_1,(ulong)*puVar1,"error reading",0);
  return;
}



ulong FUN_00113170(long param_1,uint param_2,ulong param_3,undefined8 param_4,ulong param_5)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  ulong uVar4;
  char *pcVar5;
  ulong extraout_RDX;
  ulong extraout_RDX_00;
  char *pcVar6;
  ulong extraout_RDX_01;
  ulong extraout_RDX_02;
  ulong extraout_RDX_03;
  ulong extraout_RDX_04;
  ulong extraout_RDX_05;
  ulong extraout_RDX_06;
  ulong extraout_RDX_07;
  ulong extraout_RDX_08;
  ulong extraout_RDX_09;
  ulong extraout_RDX_10;
  ulong uVar7;
  char *pcVar8;
  ulong uVar9;
  long in_FS_OFFSET;
  uint local_6c;
  void *local_68;
  undefined local_60 [8];
  undefined8 local_58;
  char *local_50;
  undefined8 local_48;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_6c = 0;
  local_68 = (void *)0x0;
  local_58 = 0;
  local_50 = "binary";
  local_48 = 0;
  uVar1 = *(uint *)(param_1 + 0x38);
  if (param_5 == 0) {
    pcVar5 = "empty";
    pcVar6 = "application/x-empty";
LAB_0011331e:
    if ((uVar1 & 0x410) == 0) {
      pcVar8 = "UNKNUNKN";
      if ((uVar1 & 0x800) == 0) {
        pcVar8 = pcVar5;
        if ((uVar1 & 0x1000000) == 0) goto LAB_001133eb;
        pcVar8 = "???";
      }
      uVar1 = FUN_00112ee0(param_1,pcVar8,pcVar6,pcVar5);
joined_r0x001133a7:
      if (uVar1 == 0xffffffff) {
        local_6c = uVar1;
      }
      uVar1 = *(uint *)(param_1 + 0x38);
      uVar7 = 1;
      goto LAB_001133b1;
    }
    pcVar8 = pcVar6;
    if ((uVar1 & 0x10) != 0) {
LAB_001133eb:
      uVar1 = FUN_00112ee0(param_1,0x11ad2b,pcVar8,pcVar5);
      goto joined_r0x001133a7;
    }
    uVar7 = 1;
    if ((uVar1 & 0x400) == 0) goto LAB_00113340;
  }
  else {
    if (param_5 == 1) {
      pcVar5 = "very short file (no magic)";
      pcVar6 = "application/octet-stream";
      goto LAB_0011331e;
    }
    uVar9 = 0;
    uVar4 = param_3;
    if ((uVar1 & 0x200000) == 0) {
      uVar1 = FUN_0010fa40(param_1,param_4,param_5,&local_68,local_60,&local_58,&local_50,&local_48)
      ;
      uVar9 = (ulong)uVar1;
      uVar1 = *(uint *)(param_1 + 0x38);
      uVar4 = extraout_RDX_07;
    }
    if ((uVar1 & 0x1000) == 0) {
      uVar1 = FUN_00110550(param_1,(ulong)param_2,param_3,param_4,param_5);
      uVar7 = (ulong)uVar1;
      uVar4 = extraout_RDX_06;
      if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
        fprintf(stderr,1,"[try zmagic %d]\n",(ulong)uVar1);
        uVar4 = extraout_RDX_08;
      }
      if (uVar1 != 0) goto LAB_00113340;
      uVar1 = *(uint *)(param_1 + 0x38);
    }
    uVar7 = 0;
    if ((uVar1 & 0x2000) == 0) {
      uVar3 = FUN_001111d0(param_1,param_4,param_5);
      uVar7 = (ulong)uVar3;
      uVar1 = *(uint *)(param_1 + 0x38);
      uVar4 = extraout_RDX_01;
      if ((uVar1 & 1) != 0) {
        fprintf(stderr,1,"[try tar %d]\n",uVar7);
        uVar1 = *(uint *)(param_1 + 0x38);
        uVar4 = extraout_RDX_09;
      }
      if (uVar3 == 0) goto LAB_00113204;
      if ((uVar1 & 0x20) != 0) {
        iVar2 = FUN_00112fa0(param_1,&local_6c);
        uVar1 = *(uint *)(param_1 + 0x38);
        uVar4 = extraout_RDX_02;
        if (iVar2 == 0) goto LAB_00113204;
      }
      goto LAB_001133b1;
    }
LAB_00113204:
    if ((uVar1 & 0x40000) == 0) {
      uVar3 = FUN_00116f70(param_1,(ulong)param_2,param_4,param_5);
      uVar7 = (ulong)uVar3;
      uVar1 = *(uint *)(param_1 + 0x38);
      uVar4 = extraout_RDX_03;
      if ((uVar1 & 1) != 0) {
        fprintf(stderr,1,"[try cdf %d]\n",uVar7);
        uVar1 = *(uint *)(param_1 + 0x38);
        uVar4 = extraout_RDX_10;
      }
      if (uVar3 == 0) goto LAB_0011320f;
      if ((uVar1 & 0x20) != 0) {
        iVar2 = FUN_00112fa0(param_1,&local_6c);
        uVar1 = *(uint *)(param_1 + 0x38);
        uVar4 = extraout_RDX_04;
        if (iVar2 == 0) goto LAB_0011320f;
      }
    }
    else {
LAB_0011320f:
      if ((uVar1 & 0x4000) == 0) {
        uVar4 = uVar9;
        uVar1 = FUN_0010d8f0(param_1,param_4,param_5,0,0,0x20,0);
        uVar7 = (ulong)uVar1;
        uVar1 = *(uint *)(param_1 + 0x38);
      }
      if ((uVar1 & 1) != 0) {
        fprintf(stderr,1,"[try softmagic %d]\n",uVar7);
        uVar1 = *(uint *)(param_1 + 0x38);
        uVar4 = extraout_RDX_05;
      }
      if ((int)uVar7 == 0) {
LAB_001132a0:
        pcVar5 = "data";
        pcVar6 = "application/octet-stream";
        if ((uVar1 & 0x20000) != 0) goto LAB_0011331e;
        uVar3 = FUN_0010f780(param_1,param_4,param_5,uVar9);
        uVar7 = (ulong)uVar3;
        uVar1 = *(uint *)(param_1 + 0x38);
        if ((uVar1 & 1) != 0) {
          fprintf(stderr,1,"[try ascmagic %d]\n",uVar7);
          uVar1 = *(uint *)(param_1 + 0x38);
        }
        if (uVar3 == 0) {
LAB_00113300:
          pcVar5 = "data";
          pcVar6 = "application/octet-stream";
          goto LAB_0011331e;
        }
        if ((uVar1 & 0x20) != 0) {
          iVar2 = FUN_00112fa0(param_1,&local_6c);
          uVar1 = *(uint *)(param_1 + 0x38);
          if (iVar2 == 0) goto LAB_00113300;
        }
      }
      else {
        if (((((uVar1 & 0x10000) == 0) && ((int)uVar7 == 1)) && (5 < param_5)) &&
           (param_2 != 0xffffffff)) {
          uVar1 = FUN_00111390(param_1,(ulong)param_2,param_4,param_5);
          uVar7 = (ulong)uVar1;
          uVar1 = *(uint *)(param_1 + 0x38);
          uVar4 = extraout_RDX;
          if ((uVar1 & 1) != 0) {
            fprintf(stderr,1,"[try elf %d]\n",uVar7);
            uVar1 = *(uint *)(param_1 + 0x38);
            uVar4 = extraout_RDX_00;
          }
        }
        if ((uVar1 & 0x20) != 0) {
          iVar2 = FUN_00112fa0(param_1,&local_6c);
          uVar1 = *(uint *)(param_1 + 0x38);
          if (iVar2 == 0) goto LAB_001132a0;
        }
      }
    }
LAB_001133b1:
    if ((uVar1 & 0x400) == 0) goto LAB_00113340;
    if (((uVar1 & 0x10) != 0) && (uVar1 = FUN_00112ee0(param_1,"; charset="), uVar1 == 0xffffffff))
    {
      local_6c = uVar1;
    }
  }
  uVar1 = FUN_00112ee0(param_1,0x11ad2b,local_50);
  if (uVar1 == 0xffffffff) {
    local_6c = uVar1;
  }
LAB_00113340:
  free(local_68);
  uVar4 = (ulong)local_6c;
  if (local_6c == 0) {
    uVar4 = uVar7;
  }
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar4;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 FUN_00113670(long *param_1)

{
  if (*param_1 != 0) {
    if ((void *)param_1[4] != (void *)0x0) {
      free((void *)param_1[4]);
      param_1[4] = 0;
    }
    if ((void *)param_1[5] != (void *)0x0) {
      free((void *)param_1[5]);
      param_1[5] = 0;
    }
    *(uint *)((long)param_1 + 0x3c) = *(uint *)((long)param_1 + 0x3c) & 0xfffffffe;
    *(undefined4 *)((long)param_1 + 0x34) = 0xffffffff;
    return 0;
  }
  FUN_00112ce0(param_1,0,"no magic files loaded",0);
  return 0xffffffff;
}



char * FUN_001136d0(long param_1)

{
  size_t __size;
  int iVar1;
  size_t __n;
  undefined *puVar2;
  ushort **ppuVar3;
  char *__s;
  undefined *__dest;
  byte *pbVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte bVar7;
  byte *__src;
  long in_FS_OFFSET;
  wint_t local_4c;
  mbstate_t local_48;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  if ((*(byte *)(param_1 + 0x3c) & 1) == 0) {
    __s = *(char **)(param_1 + 0x20);
    if (((*(byte *)(param_1 + 0x39) & 1) == 0) && (__s != (char *)0x0)) {
      __n = strlen(__s);
      if (__n < 0x4000000000000000) {
        __size = __n * 4 + 1;
        __dest = (undefined *)realloc(*(void **)(param_1 + 0x28),__size);
        if (__dest == (undefined *)0x0) {
          FUN_00113100(param_1,__size);
          __s = (char *)0x0;
        }
        else {
          __src = *(byte **)(param_1 + 0x20);
          *(undefined **)(param_1 + 0x28) = __dest;

          pbVar5 = __src + __n;
          if (__src < pbVar5) {
            do {
              __n = mbrtowc((wchar_t *)&local_4c,(char *)__src,(size_t)(pbVar5 + -(long)__src),
                            &local_48);
              if (__n + 2 < 2) {
                *__dest = 0;
                __src = *(byte **)(param_1 + 0x28);
                pbVar5 = *(byte **)(param_1 + 0x20);
                while (bVar7 = *pbVar5, pbVar4 = pbVar5, pbVar6 = __src, bVar7 != 0) {
                  while( true ) {
                    ppuVar3 = __ctype_b_loc();
                    pbVar5 = pbVar4 + 1;
                    if ((*(byte *)((long)*ppuVar3 + (ulong)bVar7 * 2 + 1) & 0x40) == 0) break;
                    *pbVar6 = bVar7;
                    bVar7 = *pbVar5;
                    pbVar6 = pbVar6 + 1;
                    pbVar4 = pbVar5;
                    if (bVar7 == 0) goto LAB_0011389e;
                  }
                  *pbVar6 = 0x5c;
                  __src = pbVar6 + 4;
                  pbVar6[1] = (*pbVar4 >> 6) + 0x30;
                  pbVar6[2] = ((byte)((uint)(int)(char)*pbVar4 >> 3) & 7) + 0x30;
                  pbVar6[3] = (*pbVar4 & 7) + 0x30;
                }
LAB_0011389e:
                *pbVar6 = 0;
                __s = *(char **)(param_1 + 0x28);
                goto LAB_00113819;
              }
              iVar1 = iswprint(local_4c);
              if (iVar1 == 0) {
                pbVar4 = __src + __n;
                puVar2 = __dest;
                pbVar6 = __src;
                if (__n != 0) {
                  do {
                    *puVar2 = 0x5c;
                    __src = pbVar6 + 1;
                    puVar2[1] = (*pbVar6 >> 6) + 0x30;
                    puVar2[2] = ((byte)((uint)(int)(char)*pbVar6 >> 3) & 7) + 0x30;
                    puVar2[3] = (*pbVar6 & 7) + 0x30;
                    puVar2 = puVar2 + 4;
                    pbVar6 = __src;
                  } while (__src != pbVar4);
                  __dest = __dest + __n * 4;
                }
              }
              else {
                memcpy(__dest,__src,__n);
                __src = __src + __n;
                __dest = __dest + __n;
              }
            } while (__src < pbVar5);
          }
          *__dest = 0;
          __s = *(char **)(param_1 + 0x28);
        }
      }
      else {
        FUN_00113100(param_1,__n);
        __s = (char *)0x0;
      }
    }
  }
  else {
    __s = (char *)0x0;
  }
LAB_00113819:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return __s;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 FUN_00113920(long param_1,uint param_2)

{
  void *__ptr;
  size_t __size;
  
  __ptr = *(void **)(param_1 + 0x18);
  if (*(ulong *)(param_1 + 0x10) <= (ulong)param_2) {
    *(ulong *)(param_1 + 0x10) = (ulong)(param_2 + 0x14);
    __size = (ulong)(param_2 + 0x14) << 4;
    if (__ptr == (void *)0x0) {
      __ptr = malloc(__size);
    }
    else {
      __ptr = realloc(__ptr,__size);
    }
    *(void **)(param_1 + 0x18) = __ptr;
    if (__ptr == (void *)0x0) {
      FUN_00113100(param_1,__size);
      return 0xffffffff;
    }
  }
  __ptr = (void *)((long)__ptr + (ulong)param_2 * 0x10);
  *(undefined8 *)((long)__ptr + 4) = 0;
  *(undefined4 *)((long)__ptr + 0xc) = 0;
  return 0;
}



size_t FUN_001139a0(long param_1)

{
  size_t sVar1;
  
  if (*(char **)(param_1 + 0x20) != (char *)0x0) {
    sVar1 = strlen(*(char **)(param_1 + 0x20));
    return sVar1;
  }
  return 0;
}



void FUN_001139c0(char **param_1,char *param_2,int param_3)

{
  int iVar1;
  __locale_t __dataset;
  
  __dataset = newlocale(1,"C",(__locale_t)0x0);
  *(__locale_t *)(param_1 + 2) = __dataset;
  if (__dataset == (__locale_t)0x0) {
                    // WARNING: Subroutine does not return
    __assert_fail("rx->c_lc_ctype != NULL","funcs.c",0x1ef,"file_regcomp");
  }
  __dataset = uselocale(__dataset);
  *(__locale_t *)(param_1 + 1) = __dataset;
  if (__dataset != (__locale_t)0x0) {
    *param_1 = param_2;
    iVar1 = regcomp((regex_t *)(param_1 + 4),param_2,param_3);
    *(int *)(param_1 + 3) = iVar1;
    return;
  }
                    // WARNING: Subroutine does not return
  __assert_fail("rx->old_lc_ctype != NULL","funcs.c",0x1f1,"file_regcomp");
}



void FUN_00113a60(long param_1,char *param_2,size_t param_3,regmatch_t *param_4,int param_5)

{
  if (*(int *)(param_1 + 0x18) == 0) {
    regexec((regex_t *)(param_1 + 0x20),param_2,param_3,param_4,param_5);
    return;
  }
  FUN_00112cb0();
  if (*(int *)(param_1 + 0x18) == 0) {
    regfree((regex_t *)(param_1 + 0x20));
  }
  uselocale(*(__locale_t *)(param_1 + 8));
  freelocale(*(__locale_t *)(param_1 + 0x10));
  return;
}



void FUN_00113a80(long param_1)

{
  if (*(int *)(param_1 + 0x18) == 0) {
    regfree((regex_t *)(param_1 + 0x20));
  }
  uselocale(*(__locale_t *)(param_1 + 8));
  freelocale(*(__locale_t *)(param_1 + 0x10));
  return;
}



void FUN_00113ab0(undefined8 *param_1,uint param_2,undefined8 param_3)

{
  long in_FS_OFFSET;
  char acStack568 [520];
  long local_30;
  
  local_30 = *(long *)(in_FS_OFFSET + 0x28);
  regerror(param_2,(regex_t *)(param_1 + 4),acStack568,0x200);
  FUN_00112fc0(param_3,"regex error %d for `%s\', (%s)",(ulong)param_2,*param_1,acStack568,0);
  if (local_30 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



ulong FUN_00113b30(long param_1,undefined8 param_2,undefined8 param_3)

{
  uint uVar1;
  int iVar2;
  undefined1 *puVar3;
  uint uVar4;
  char *__string;
  long in_FS_OFFSET;
  regmatch_t local_b0;
  undefined local_a8 [24];
  uint local_90;
  regex_t local_88;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  FUN_001139c0(local_a8,param_2,1);
  if (uVar1 == 0) {
    __string = *(char **)(param_1 + 0x20);
    if (local_90 == 0) {
      uVar4 = local_90;
      do {
        iVar2 = regexec(&local_88,__string,1,&local_b0,0);
        uVar1 = uVar4;
        if (iVar2 != 0) goto LAB_00113bf1;
        puVar3 = &DAT_0011ad97;
        *(undefined *)(*(long *)(param_1 + 0x20) + (long)local_b0.rm_so) = 0;
        if (local_b0.rm_eo != 0) {
          puVar3 = (undefined1 *)((long)local_b0.rm_eo + *(long *)(param_1 + 0x20));
        }
        uVar1 = FUN_00112ee0(param_1,&DAT_0011b6ee,param_3,puVar3);
        if (uVar1 == 0xffffffff) goto LAB_00113bf1;
        uVar4 = uVar4 + 1;
        __string = *(char **)(param_1 + 0x20);
      } while (local_90 == 0);
    }
    FUN_00112cb0();
  }
  else {
    FUN_00113ab0(local_a8,(ulong)uVar1,param_1);
    uVar1 = 0xffffffff;
LAB_00113bf1:
    FUN_00113a80(local_a8);
    if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
      return (ulong)uVar1;
    }
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 * FUN_00113c50(long param_1)

{
  undefined4 uVar1;
  undefined8 uVar2;
  undefined8 *puVar3;
  
  if ((*(byte *)(param_1 + 0x3c) & 1) == 0) {
    puVar3 = (undefined8 *)malloc(0x10);
    if (puVar3 != (undefined8 *)0x0) {
      uVar2 = *(undefined8 *)(param_1 + 0x20);
      *(undefined8 *)(param_1 + 0x20) = 0;
      *puVar3 = uVar2;
      uVar1 = *(undefined4 *)(param_1 + 0x30);
      *(undefined4 *)(param_1 + 0x30) = 0;
      *(undefined4 *)(puVar3 + 1) = uVar1;
    }
    return puVar3;
  }
  return (undefined8 *)0;
}



undefined8 FUN_00113ca0(long param_1,void **param_2)

{
  undefined8 uVar1;
  
  if ((*(byte *)(param_1 + 0x3c) & 1) == 0) {
    uVar1 = *(undefined8 *)(param_1 + 0x20);
    *(void **)(param_1 + 0x20) = *param_2;
    *(undefined4 *)(param_1 + 0x30) = *(undefined4 *)(param_2 + 1);
    free(param_2);
  }
  else {
    uVar1 = 0;
    free(*param_2);
    free(param_2);
  }
  return uVar1;
}



byte * FUN_00113cf0(byte *param_1,long param_2,byte *param_3)

{
  byte *pbVar1;
  ushort **ppuVar2;
  byte *pbVar3;
  byte bVar4;
  
  pbVar1 = param_1 + param_2 + -1;
  pbVar3 = param_1;
  if ((param_1 < pbVar1) && (bVar4 = *param_3, bVar4 != 0)) {
    ppuVar2 = __ctype_b_loc();
    do {
      if ((*(byte *)((long)*ppuVar2 + (ulong)bVar4 * 2 + 1) & 0x40) == 0) {
        if (pbVar1 + -3 <= pbVar3) break;
        *pbVar3 = 0x5c;
        pbVar3[1] = (*param_3 >> 6) + 0x30;
        pbVar3[2] = (*param_3 >> 3 & 7) + 0x30;
        pbVar3[3] = (*param_3 & 7) + 0x30;
        pbVar3 = pbVar3 + 4;
      }
      else {
        *pbVar3 = bVar4;
        pbVar3 = pbVar3 + 1;
      }
      if (pbVar1 <= pbVar3) break;
      param_3 = param_3 + 1;
      bVar4 = *param_3;
    } while (bVar4 != 0);
  }
  *pbVar3 = 0;
  return param_1;
}



ulong FUN_00113dc0(long param_1,ulong *param_2,ulong param_3)

{
  ulong uVar1;
  byte bVar2;
  ulong uVar3;
  ulong uVar4;
  
  uVar1 = *param_2;
  if (uVar1 < param_3) {
    uVar4 = uVar1 + 1;
    *param_2 = uVar4;
    bVar2 = *(byte *)(param_1 + uVar1);
    if (-1 < (char)bVar2) {
      return (ulong)bVar2;
    }
    bVar2 = bVar2 & 0x7f;
    if (bVar2 + uVar4 < param_3) {
      if (bVar2 != 0) {
        uVar3 = 0;
        do {
          uVar4 = uVar4 + 1;
          *param_2 = uVar4;
          uVar3 = uVar3 << 8 | (ulong)*(byte *)(param_1 + -1 + uVar4);
        } while (uVar1 + 2 + (ulong)(byte)(bVar2 - 1) != uVar4);
        return uVar3;
      }
      return 0;
    }
  }
  return 0xffffffff;
}



ulong FUN_00113e40(long param_1,ulong *param_2,ulong param_3)

{
  byte bVar1;
  ulong uVar2;
  ulong uVar3;
  
  uVar2 = *param_2;
  if (uVar2 < param_3) {
    uVar3 = uVar2 + 1;
    *param_2 = uVar3;
    bVar1 = *(byte *)(param_1 + uVar2) & 0x1f;
    if (bVar1 != 0x1f) {
      return (ulong)bVar1;
    }
    uVar2 = 0x1f;
    while (uVar3 < param_3) {
      if (-1 < *(char *)(param_1 + uVar3)) {
        return uVar2;
      }
      uVar3 = uVar3 + 1;
      *param_2 = uVar3;
      uVar2 = (ulong)((int)uVar2 * 0x80 + -0x80 + (uint)*(byte *)(param_1 + -1 + uVar3));
    }
  }
  return 0xffffffff;
}



ulong FUN_00113ea0(long param_1,ushort *param_2,ulong param_3)

{
  int iVar1;
  uint uVar2;
  ulong uVar3;
  long in_FS_OFFSET;
  ulong local_28;
  long local_20;
  
  local_20 = *(long *)(in_FS_OFFSET + 0x28);
  local_28 = 0;
  uVar3 = *(ulong *)(param_1 + 0x58);
  if (*(ulong *)(param_1 + 0x58) == 0) {
    uVar3 = param_3;
  }
  iVar1 = FUN_00113e40(*(undefined8 *)(param_1 + 0x50),&local_28,uVar3);
  if (iVar1 != -1) {
    uVar2 = FUN_00113dc0(param_1, param_2, param_3);
    if (uVar2 != 0xffffffff) {
      local_28 = (uint)(*(int *)(param_2 + 6) + *(int *)(param_1 + 0x30)) + local_28;
      if (*param_2 != 0) {
        if (param_3 < uVar2 + local_28) goto LAB_00113f50;
        *(int *)((ulong)*param_2 * 0x10 + *(long *)(param_1 + 0x18) + -0x10) = uVar2 + (int)local_28
        ;
      }
      uVar3 = local_28 & 0xffffffff;
      goto LAB_00113f11;
    }
  }
LAB_00113f50:
  uVar3 = 0xffffffff;
LAB_00113f11:
  if (local_20 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar3;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 FUN_00113f60(long param_1,long param_2)

{
  char *__s2;
  byte *pbVar1;
  byte bVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  ushort **ppuVar7;
  ulong uVar8;
  long lVar9;
  byte *pbVar10;
  uint *puVar11;
  uint *puVar12;
  size_t __n;
  byte *__s2_00;
  ulong uVar13;
  ulong uVar14;
  long in_FS_OFFSET;
  bool bVar15;
  bool bVar16;
  byte bVar17;
  undefined8 uVar18;
  long local_d0;
  uint local_c8 [34];
  long local_40;
  
  bVar17 = 0;
  __s2 = (char *)(param_2 + 0x20);
  lVar9 = *(long *)(param_1 + 0x50);
  local_d0 = 0;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  uVar3 = FUN_00113e40(lVar9,&local_d0,*(undefined8 *)(param_1 + 0x58));
  if (uVar3 != 0xffffffff) {
    uVar4 = FUN_00113dc0(param_1, param_2, 0);
    uVar14 = (ulong)uVar4;
    if (uVar4 != 0xffffffff) {
      if (uVar3 < 0x1f) {
        uVar18 = 0x114240;
        FUN_00117c00(local_c8,(&PTR_DAT_0031f920)[uVar3],0x80);
        bVar2 = *(byte *)(param_1 + 0x38);
      }
      else {
        uVar18 = 0x113ffe;
        snprintf(local_c8,0x80,1,0x80,&DAT_0011bc1f,(ulong)uVar3);
        bVar2 = *(byte *)(param_1 + 0x38);
      }
      if ((bVar2 & 1) != 0) {
        fprintf(stderr,1,"%s: tag %p got=%s exp=%s\n","der_cmp",lVar9,local_c8,__s2,uVar18);
      }
      puVar12 = local_c8;
      do {
        puVar11 = puVar12;
        uVar5 = *puVar11 + 0xfefefeff & ~*puVar11;
        _bVar2 = uVar5 & 0x80808080;
        bVar2 = (byte)_bVar2;
        puVar12 = puVar11 + 1;
      } while (_bVar2 == 0);
      bVar15 = (uVar5 & 0x8080) == 0;
      if (bVar15) {
        bVar2 = (byte)(_bVar2 >> 0x10);
      }
      if (bVar15) {
        puVar12 = (uint *)((long)puVar11 + 6);
      }
      __n = (long)puVar12 + ((-3 - (ulong)CARRY1(bVar2,bVar2)) - (long)local_c8);
      uVar18 = 0x114056;
      iVar6 = strncmp((char *)local_c8,__s2,__n);
      __s2_00 = (byte *)(__s2 + __n);
      if (iVar6 == 0) {
LAB_00114065:
        bVar2 = *__s2_00;
        uVar8 = (ulong)bVar2;
        if (bVar2 == 0) {
          uVar18 = 1;
          goto LAB_001141f2;
        }
        if (bVar2 != 0x3d) {
          uVar18 = 0x114169;
          ppuVar7 = __ctype_b_loc();
          if ((*(byte *)((long)*ppuVar7 + (ulong)bVar2 * 2 + 1) & 8) != 0) goto code_r0x00114176;
          goto LAB_001141f0;
        }
        pbVar10 = (byte *)(lVar9 + local_d0);
        __s2_00 = __s2_00 + 1;
        if ((uVar3 < 0x18) && ((1 << ((byte)uVar3 & 0x3f) & 0xc81000U) != 0)) {
          snprintf(local_c8,0x80,1,0x80,0x11b1ee,uVar14,pbVar10,uVar18);
        }
        else {
          if (uVar4 != 0) {
            uVar3 = 0;
            pbVar1 = pbVar10 + (ulong)(uVar4 - 1) + 1;
            do {
              if (uVar3 < 0x7e) {
                snprintf((ulong)uVar3 + (long)local_c8,0x80 - (ulong)uVar3,1,
                               0xffffffffffffffff,&DAT_0011bc3d,(ulong)*pbVar10);
              }
              uVar3 = uVar3 + 2;
              pbVar10 = pbVar10 + 1;
            } while (pbVar1 != pbVar10);
          }
        }
        if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
          fprintf(stderr,1,"%s: data %s %s\n","der_cmp",local_c8,__s2_00);
        }
        iVar6 = strcmp((char *)local_c8,(char *)__s2_00);
        bVar15 = false;
        bVar16 = iVar6 == 0;
        if (bVar16) {
LAB_0011413d:
          FUN_00117c00(param_1 + 0x70,local_c8,0x60);
          uVar18 = 1;
          goto LAB_001141f2;
        }
        lVar9 = 2;
        pbVar10 = &DAT_0011bc21;
        do {
          if (lVar9 == 0) break;
          lVar9 = lVar9 + -1;
          bVar15 = *pbVar10 < *__s2_00;
          bVar16 = *pbVar10 == *__s2_00;
          pbVar10 = pbVar10 + (ulong)bVar17 * -2 + 1;
          __s2_00 = __s2_00 + (ulong)bVar17 * -2 + 1;
        } while (bVar16);
        if ((!bVar15 && !bVar16) == bVar15) goto LAB_0011413d;
      }
LAB_001141f0:
      uVar18 = 0;
      goto LAB_001141f2;
    }
  }
  uVar18 = 0xffffffff;
LAB_001141f2:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar18;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
code_r0x00114176:
  uVar13 = 0;
  do {
    __s2_00 = __s2_00 + 1;
    uVar13 = (long)(char)uVar8 + -0x30 + uVar13 * 10;
    uVar8 = (ulong)*__s2_00;
  } while ((*(byte *)((long)*ppuVar7 + uVar8 * 2 + 1) & 8) != 0);
  if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
    uVar18 = 0x1141d9;
    fprintf(stderr,1,"%s: len %zu %u\n","der_cmp",uVar13,uVar14);
  }
  if (uVar14 != uVar13) goto LAB_001141f0;
  goto LAB_00114065;
}



size_t FUN_00114310(int *param_1,long param_2,void *param_3,size_t param_4)

{
  size_t sVar1;
  size_t sVar2;
  int *piVar3;
  
  if ((*(long *)(param_1 + 2) != 0) && (param_2 + param_4 <= *(ulong *)(param_1 + 4))) {
    memcpy(param_3,(void *)(param_2 + *(long *)(param_1 + 2)),param_4);
    return param_4;
  }
  if (*param_1 != -1) {
    sVar1 = pread(*param_1,param_3,param_4,param_2);
    sVar2 = 0xffffffffffffffff;
    if (param_4 == sVar1) {
      sVar2 = param_4;
    }
    return sVar2;
  }
  piVar3 = __errno_location();
  *piVar3 = 0x16;
  return 0xffffffffffffffff;
}



ulong FUN_00114380(ulong *param_1,long param_2,long param_3,long param_4)

{
  byte bVar1;
  int *piVar2;
  undefined8 uVar3;
  ulong uVar4;
  uint uVar5;
  long in_FS_OFFSET;
  ushort uStack26;
  
  uVar5 = (uint)param_1;
  bVar1 = (byte)*(undefined2 *)(param_2 + 0x20);
  if ((ulong)*(uint *)(param_2 + 0x38) <= param_1[2]) {
    bVar1 = (byte)*(undefined2 *)(param_2 + 0x1e);
  }
  if (param_1[3] == (long)(1 << (bVar1 & 0x1f))) {
    if (((ulong)(param_3 + param_4) < *param_1) ||
       (param_1[3] * param_1[1] < (param_3 + param_4) - *param_1)) {
      piVar2 = __errno_location();
      *piVar2 = 0x16;
      uVar3 = 0xffffffff;
    }
    else {
      uVar3 = 0;
    }
    return uVar3;
  }
  FUN_00106330();
  uVar4 = (ulong)uVar5;
  if (DAT_003204f8 == 0x1020304) {
    uStack26 = CONCAT11((char)uVar5,(char)((ulong)uVar5 >> 8));
    uVar4 = (ulong)uStack26;
  }
  if (*(long *)(in_FS_OFFSET + 0x28) == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar4;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined* FUN_001143f0(uint param_1)

{
  ulong uVar1;
  long in_FS_OFFSET;
  ushort local_12;
  
  uVar1 = (ulong)param_1;
  if (DAT_003204f8 == 0x1020304) {
    local_12 = CONCAT11((char)param_1,(char)((ulong)param_1 >> 8));
    uVar1 = (ulong)local_12;
  }
  if (*(long *)(in_FS_OFFSET + 0x28) == *(long *)(in_FS_OFFSET + 0x28)) {
    return ZEXT816(uVar1);
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void FUN_00114530(undefined8 *param_1)

{
  uint uVar1;
  long lVar2;
  undefined8 uVar3;
  int iVar4;
  uint uVar5;
  undefined8 *puVar6;
  long in_FS_OFFSET;
  
  iVar4 = DAT_003204f8;
  lVar2 = *(long *)(in_FS_OFFSET + 0x28);
  uVar5 = *(uint *)(param_1 + 9);
  if (DAT_003204f8 == 0x1020304) {
    uVar3 = *param_1;
    *param_1 = CONCAT17((char)uVar3,
                        CONCAT16((char)((ulong)uVar3 >> 8),
                                 CONCAT15((char)((ulong)uVar3 >> 0x10),
                                          CONCAT14((char)((ulong)uVar3 >> 0x18),
                                                   CONCAT13((char)((ulong)uVar3 >> 0x20),
                                                            CONCAT12((char)((ulong)uVar3 >> 0x28),
                                                                     CONCAT11((char)((ulong)uVar3 >>
                                                                                    0x30),
                                                                              (char)((ulong)uVar3 >>
                                                                                    0x38))))))));
    uVar3 = param_1[1];
    param_1[1] = CONCAT17((char)uVar3,
                          CONCAT16((char)((ulong)uVar3 >> 8),
                                   CONCAT15((char)((ulong)uVar3 >> 0x10),
                                            CONCAT14((char)((ulong)uVar3 >> 0x18),
                                                     CONCAT13((char)((ulong)uVar3 >> 0x20),
                                                              CONCAT12((char)((ulong)uVar3 >> 0x28),
                                                                       CONCAT11((char)((ulong)uVar3
                                                                                      >> 0x30),
                                                                                (char)((ulong)uVar3
                                                                                      >> 0x38)))))))
                         );
    uVar3 = param_1[2];
    param_1[2] = CONCAT17((char)uVar3,
                          CONCAT16((char)((ulong)uVar3 >> 8),
                                   CONCAT15((char)((ulong)uVar3 >> 0x10),
                                            CONCAT14((char)((ulong)uVar3 >> 0x18),
                                                     CONCAT13((char)((ulong)uVar3 >> 0x20),
                                                              CONCAT12((char)((ulong)uVar3 >> 0x28),
                                                                       CONCAT11((char)((ulong)uVar3
                                                                                      >> 0x30),
                                                                                (char)((ulong)uVar3
                                                                                      >> 0x38)))))))
                         );
    *(ushort *)(param_1 + 3) =
         CONCAT11((char)*(ushort *)(param_1 + 3),(char)((ulong)*(ushort *)(param_1 + 3) >> 8));
    *(undefined2 *)((long)param_1 + 0x1a) =
         CONCAT11((char)*(ushort *)((long)param_1 + 0x1a),
                  (char)((ulong)*(ushort *)((long)param_1 + 0x1a) >> 8));
    *(undefined2 *)((long)param_1 + 0x1c) =
         CONCAT11((char)*(ushort *)((long)param_1 + 0x1c),
                  (char)((ulong)*(ushort *)((long)param_1 + 0x1c) >> 8));
    *(undefined2 *)((long)param_1 + 0x1e) =
         CONCAT11((char)*(ushort *)((long)param_1 + 0x1e),
                  (char)((ulong)*(ushort *)((long)param_1 + 0x1e) >> 8));
    *(ushort *)(param_1 + 4) =
         CONCAT11((char)*(ushort *)(param_1 + 4),(char)((ulong)*(ushort *)(param_1 + 4) >> 8));
    uVar1 = *(uint *)((long)param_1 + 0x2c);
    *(undefined4 *)((long)param_1 + 0x2c) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((ulong)uVar1 >> 8),
                           CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18))));
    uVar1 = *(uint *)(param_1 + 6);
    *(uint *)(param_1 + 6) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((ulong)uVar1 >> 8),
                           CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18))));
    uVar1 = *(uint *)(param_1 + 7);
    *(uint *)(param_1 + 7) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((ulong)uVar1 >> 8),
                           CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18))));
    uVar1 = *(uint *)((long)param_1 + 0x3c);
    *(undefined4 *)((long)param_1 + 0x3c) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((ulong)uVar1 >> 8),
                           CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18))));
    uVar1 = *(uint *)(param_1 + 8);
    *(uint *)(param_1 + 8) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((ulong)uVar1 >> 8),
                           CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18))));
    uVar1 = *(uint *)((long)param_1 + 0x44);
    *(undefined4 *)((long)param_1 + 0x44) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((ulong)uVar1 >> 8),
                           CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18))));
    uVar5 = CONCAT13((char)uVar5,
                     CONCAT12((char)((ulong)uVar5 >> 8),
                              CONCAT11((char)(uVar5 >> 0x10),(char)(uVar5 >> 0x18))));
  }
  *(uint *)(param_1 + 9) = uVar5;
  puVar6 = (undefined8 *)((long)param_1 + 0x4c);
  do {
    uVar5 = *(uint *)puVar6;
    if (iVar4 == 0x1020304) {
      uVar5 = CONCAT13((char)uVar5,
                       CONCAT12((char)((ulong)uVar5 >> 8),
                                CONCAT11((char)(uVar5 >> 0x10),(char)(uVar5 >> 0x18))));
    }
    *(uint *)puVar6 = uVar5;
    puVar6 = (undefined8 *)((long)puVar6 + 4);
  } while (param_1 + 0x40 != puVar6);
  if (lVar2 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void FUN_00114820(undefined8 *param_1,undefined8 *param_2)

{
  undefined auVar1 [16];
  long lVar2;
  
  *param_1 = *param_2;
                    // WARNING: Load size is inaccurate
  auVar1[0] = *(undefined *)(param_2 + 1);
  *(int *)(param_1 + 1) = SUB164(auVar1,0);
  *(undefined4 *)((long)param_1 + 0xc) = SUB164(auVar1[0] >> 0x20,0);
  *(int *)(param_1 + 2) = SUB164(auVar1[0] >> 0x40,0);
  *(undefined4 *)((long)param_1 + 0x14) = SUB164(auVar1[0] >> 0x60,0);
  *(undefined2 *)(param_1 + 3) = *(undefined2 *)(param_2 + 3);
  *(undefined2 *)((long)param_1 + 0x1a) = *(undefined2 *)((long)param_2 + 0x1a);
  *(undefined2 *)((long)param_1 + 0x1c) = *(undefined2 *)((long)param_2 + 0x1c);
  *(undefined2 *)((long)param_1 + 0x1e) = *(undefined2 *)((long)param_2 + 0x1e);
  *(undefined2 *)(param_1 + 4) = *(undefined2 *)(param_2 + 4);
  *(undefined8 *)((long)param_1 + 0x22) = *(undefined8 *)((long)param_2 + 0x22);
  *(undefined2 *)((long)param_1 + 0x2a) = *(undefined2 *)((long)param_2 + 0x2a);
  *(undefined4 *)((long)param_1 + 0x2c) = *(undefined4 *)((long)param_2 + 0x2c);
  *(undefined4 *)(param_1 + 6) = *(undefined4 *)(param_2 + 6);
  *(undefined4 *)((long)param_1 + 0x34) = *(undefined4 *)((long)param_2 + 0x34);
  *(undefined4 *)(param_1 + 7) = *(undefined4 *)(param_2 + 7);
  *(undefined4 *)((long)param_1 + 0x3c) = *(undefined4 *)((long)param_2 + 0x3c);
  *(undefined4 *)(param_1 + 8) = *(undefined4 *)(param_2 + 8);
  *(undefined4 *)((long)param_1 + 0x44) = *(undefined4 *)((long)param_2 + 0x44);
  *(undefined4 *)(param_1 + 9) = *(undefined4 *)(param_2 + 9);
  lVar2 = 0x4c;
  do {
    *(undefined4 *)((long)param_1 + lVar2) = *(undefined4 *)((long)param_2 + lVar2);
    lVar2 = lVar2 + 4;
  } while (lVar2 != 0x200);
  return;
}



void FUN_001148c0(long param_1)

{
  uint uVar1;
  long lVar2;
  undefined8 uVar3;
  uint uVar4;
  long in_FS_OFFSET;
  
  lVar2 = *(long *)(in_FS_OFFSET + 0x28);
  uVar4 = *(uint *)(param_1 + 0x7c);
  if (DAT_003204f8 == 0x1020304) {
    *(undefined2 *)(param_1 + 0x40) =
         CONCAT11((char)*(ushort *)(param_1 + 0x40),(char)((ulong)*(ushort *)(param_1 + 0x40) >> 8))
    ;
    uVar1 = *(uint *)(param_1 + 0x44);
    *(undefined4 *)(param_1 + 0x44) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((ulong)uVar1 >> 8),
                           CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18))));
    uVar1 = *(uint *)(param_1 + 0x48);
    *(undefined4 *)(param_1 + 0x48) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((ulong)uVar1 >> 8),
                           CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18))));
    uVar1 = *(uint *)(param_1 + 0x4c);
    *(undefined4 *)(param_1 + 0x4c) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((ulong)uVar1 >> 8),
                           CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18))));
    uVar3 = *(undefined8 *)(param_1 + 0x50);
    *(undefined8 *)(param_1 + 0x50) =
         CONCAT17((char)uVar3,
                  CONCAT16((char)((ulong)uVar3 >> 8),
                           CONCAT15((char)((ulong)uVar3 >> 0x10),
                                    CONCAT14((char)((ulong)uVar3 >> 0x18),
                                             CONCAT13((char)((ulong)uVar3 >> 0x20),
                                                      CONCAT12((char)((ulong)uVar3 >> 0x28),
                                                               CONCAT11((char)((ulong)uVar3 >> 0x30)
                                                                        ,(char)((ulong)uVar3 >> 0x38
                                                                               ))))))));
    uVar3 = *(undefined8 *)(param_1 + 0x58);
    *(undefined8 *)(param_1 + 0x58) =
         CONCAT17((char)uVar3,
                  CONCAT16((char)((ulong)uVar3 >> 8),
                           CONCAT15((char)((ulong)uVar3 >> 0x10),
                                    CONCAT14((char)((ulong)uVar3 >> 0x18),
                                             CONCAT13((char)((ulong)uVar3 >> 0x20),
                                                      CONCAT12((char)((ulong)uVar3 >> 0x28),
                                                               CONCAT11((char)((ulong)uVar3 >> 0x30)
                                                                        ,(char)((ulong)uVar3 >> 0x38
                                                                               ))))))));
    uVar1 = *(uint *)(param_1 + 0x60);
    *(undefined4 *)(param_1 + 0x60) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((ulong)uVar1 >> 8),
                           CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18))));
    uVar3 = *(undefined8 *)(param_1 + 0x68);
    *(undefined8 *)(param_1 + 0x68) =
         CONCAT17((char)uVar3,
                  CONCAT16((char)((ulong)uVar3 >> 8),
                           CONCAT15((char)((ulong)uVar3 >> 0x10),
                                    CONCAT14((char)((ulong)uVar3 >> 0x18),
                                             CONCAT13((char)((ulong)uVar3 >> 0x20),
                                                      CONCAT12((char)((ulong)uVar3 >> 0x28),
                                                               CONCAT11((char)((ulong)uVar3 >> 0x30)
                                                                        ,(char)((ulong)uVar3 >> 0x38
                                                                               ))))))));
    uVar3 = *(undefined8 *)(param_1 + 0x70);
    *(undefined8 *)(param_1 + 0x70) =
         CONCAT17((char)uVar3,
                  CONCAT16((char)((ulong)uVar3 >> 8),
                           CONCAT15((char)((ulong)uVar3 >> 0x10),
                                    CONCAT14((char)((ulong)uVar3 >> 0x18),
                                             CONCAT13((char)((ulong)uVar3 >> 0x20),
                                                      CONCAT12((char)((ulong)uVar3 >> 0x28),
                                                               CONCAT11((char)((ulong)uVar3 >> 0x30)
                                                                        ,(char)((ulong)uVar3 >> 0x38
                                                                               ))))))));
    uVar1 = *(uint *)(param_1 + 0x78);
    *(undefined4 *)(param_1 + 0x78) =
         CONCAT13((char)uVar1,
                  CONCAT12((char)((ulong)uVar1 >> 8),
                           CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18))));
    uVar4 = CONCAT13((char)uVar4,
                     CONCAT12((char)((ulong)uVar4 >> 8),
                              CONCAT11((char)(uVar4 >> 0x10),(char)(uVar4 >> 0x18))));
  }
  *(uint *)(param_1 + 0x7c) = uVar4;
  if (lVar2 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void FUN_00114b40(uint *param_1)

{
  uint uVar1;
  long lVar2;
  ushort uVar3;
  long in_FS_OFFSET;
  
  lVar2 = *(long *)(in_FS_OFFSET + 0x28);
  uVar3 = *(ushort *)((long)param_1 + 6);
  if (DAT_003204f8 == 0x1020304) {
    uVar1 = *param_1;
    *param_1 = CONCAT22(CONCAT11((char)uVar1,(char)((ulong)uVar1 >> 8)),
                        CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18)));
    *(ushort *)(param_1 + 1) =
         CONCAT11((char)*(ushort *)(param_1 + 1),(char)((ulong)*(ushort *)(param_1 + 1) >> 8));
    uVar3 = CONCAT11((char)uVar3,(char)((ulong)uVar3 >> 8));
  }
  *(ushort *)((long)param_1 + 6) = uVar3;
  if (lVar2 == *(long *)(in_FS_OFFSET + 0x28)) {
    return;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void FUN_00114bd0(undefined4 *param_1,undefined *param_2)

{
  undefined auVar1 [16];
  
                    // WARNING: Load size is inaccurate
  auVar1[0] = *(undefined *)param_2;
  *param_1 = SUB164(auVar1,0);
  param_1[1] = SUB164(auVar1[0] >> 0x20,0);
  param_1[2] = SUB164(auVar1[0] >> 0x40,0);
  param_1[3] = SUB164(auVar1[0] >> 0x60,0);
                    // WARNING: Load size is inaccurate
  auVar1[0] = *(undefined *)(param_2 + 0x10);
  param_1[4] = SUB164(auVar1,0);
  param_1[5] = SUB164(auVar1[0] >> 0x20,0);
  param_1[6] = SUB164(auVar1[0] >> 0x40,0);
  param_1[7] = SUB164(auVar1[0] >> 0x60,0);
                    // WARNING: Load size is inaccurate
  auVar1[0] = *(undefined *)(param_2 + 0x20);
  param_1[8] = SUB164(auVar1,0);
  param_1[9] = SUB164(auVar1[0] >> 0x20,0);
  param_1[10] = SUB164(auVar1[0] >> 0x40,0);
  param_1[0xb] = SUB164(auVar1[0] >> 0x60,0);
                    // WARNING: Load size is inaccurate
  auVar1[0] = *(undefined *)(param_2 + 0x30);
  param_1[0xc] = SUB164(auVar1,0);
  param_1[0xd] = SUB164(auVar1[0] >> 0x20,0);
  param_1[0xe] = SUB164(auVar1[0] >> 0x40,0);
  param_1[0xf] = SUB164(auVar1[0] >> 0x60,0);
  *(undefined2 *)(param_1 + 0x10) = *(undefined2 *)(param_2 + 0x40);
  *(undefined *)((long)param_1 + 0x42) = param_2[0x42];
  *(undefined *)((long)param_1 + 0x43) = param_2[0x43];
  param_1[0x11] = *(undefined4 *)(param_2 + 0x44);
  param_1[0x12] = *(undefined4 *)(param_2 + 0x48);
  param_1[0x13] = *(undefined4 *)(param_2 + 0x4c);
                    // WARNING: Load size is inaccurate
  auVar1[0] = *(undefined *)(param_2 + 0x50);
  param_1[0x14] = SUB164(auVar1,0);
  param_1[0x15] = SUB164(auVar1[0] >> 0x20,0);
  param_1[0x16] = SUB164(auVar1[0] >> 0x40,0);
  param_1[0x17] = SUB164(auVar1[0] >> 0x60,0);
  param_1[0x18] = *(undefined4 *)(param_2 + 0x60);
  *(undefined8 *)(param_1 + 0x1a) = *(undefined8 *)(param_2 + 100);
  *(undefined8 *)(param_1 + 0x1c) = *(undefined8 *)(param_2 + 0x6c);
  param_1[0x1e] = *(undefined4 *)(param_2 + 0x74);
  param_1[0x1f] = *(undefined4 *)(param_2 + 0x78);
  param_1[0x20] = *(undefined4 *)(param_2 + 0x7c);
  return;
}



long FUN_00114c50(undefined8 param_1,long *param_2)

{
  long lVar1;
  int *piVar2;
  long in_FS_OFFSET;
  undefined auStack552 [520];
  long local_20;
  
  DAT_003204f8 = 0x4030201;
  local_20 = *(long *)(in_FS_OFFSET + 0x28);
  lVar1 = FUN_00114310(param_1,0,auStack552,0x200);
  if (lVar1 != -1) {
    FUN_00114820(param_2,auStack552);
    FUN_00114530(0);
    if (((*param_2 == -0x1ee54e5e1fee3030) && (*(ushort *)((long)param_2 + 0x1e) < 0x15)) &&
       (*(ushort *)(param_2 + 4) < 0x15)) {
      lVar1 = 0;
    }
    else {
      piVar2 = __errno_location();
      *piVar2 = 0x16;
      lVar1 = 0xffffffff;
    }
  }
  if (local_20 == *(long *)(in_FS_OFFSET + 0x28)) {
    return lVar1;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void FUN_00114d00(undefined8 param_1,long param_2,long param_3,long param_4,long param_5,int param_6
                 )

{
  long lVar1;
  
  lVar1 = (long)(1 << ((byte)*(undefined2 *)(param_5 + 0x1e) & 0x1f));
  if (lVar1 == param_4) {
    FUN_00114310(param_1,((long)param_6 + 1) * lVar1,param_3 + param_2,0);
    return;
  }
                    // WARNING: Subroutine does not return
  __assert_fail("ss == len","cdf.c",0x173,"cdf_read_sector");
}



size_t FUN_00114d50(long *param_1,long param_2,long param_3,size_t param_4,long param_5,int param_6)

{
  int *piVar1;
  size_t __n;
  
  __n = SEXT48(1 << ((byte)*(undefined2 *)(param_5 + 0x20) & 0x1f));
  if (__n != param_4) {
                    // WARNING: Subroutine does not return
    __assert_fail("ss == len","cdf.c",0x17d,"cdf_read_short_sector");
  }
  if (__n + (long)param_6 * __n <=
      (ulong)((long)(1 << ((byte)*(undefined2 *)(param_5 + 0x1e) & 0x1f)) * param_1[1])) {
    memcpy((void *)(param_2 + param_3),(void *)(*param_1 + (long)param_6 * __n),__n);
    return __n;
  }
  piVar1 = __errno_location();
  *piVar1 = 0x16;
  return 0xffffffffffffffff;
}



undefined8 FUN_00114df0(undefined8 param_1,long param_2,void **param_3)

{
  uint uVar1;
  long lVar2;
  undefined auVar3 [16];
  ulong uVar4;
  void *__nmemb;
  void *__ptr;
  ulong uVar5;
  void *pvVar6;
  ulong uVar7;
  undefined8 uVar8;
  int *piVar9;
  ulong __size;
  void *__ptr_00;
  long lVar10;
  long lVar11;
  long in_FS_OFFSET;
  ulong local_58;
  uint local_44;
  
  uVar5 = 0;
  lVar2 = *(long *)(in_FS_OFFSET + 0x28);
  __size = SEXT48(1 << ((byte)*(undefined2 *)(param_2 + 0x1e) & 0x1f));
  uVar4 = (__size >> 2) - 1;
  do {
    if (*(int *)(param_2 + 0x4c + uVar5 * 4) == -1) break;
    uVar5 = uVar5 + 1;
  } while (uVar5 != 0x6d);
  auVar3[0] = (ZEXT816(0) << 0x40 | ZEXT816(0xffffffff)) / ZEXT816(__size * 4);
  if (((uVar4 == 0) ||
              (uVar5 <= SUB168(auVar3,0)))) {
    __nmemb = (void *)(uVar5 + *(uint *)(param_2 + 0x48) * uVar4);
    param_3[1] = __nmemb;
    __nmemb = calloc((size_t)__nmemb,__size);
    *param_3 = __nmemb;
    if (__nmemb == (void *)0x0) {
      uVar8 = 0xffffffff;
    }
    else {
      lVar10 = 0;
      __nmemb = (void *)0x0;
      do {
        if (*(int *)(param_2 + 0x4c + (long)__nmemb * 4) < 0) break;
        FUN_00114d00(param_1,*param_3,lVar10,__size,param_2,0);
        if (uVar5 != __size) goto LAB_00115040;
        (void *)((long)__nmemb + 1);
        lVar10 = lVar10 + __size;
      } while (__nmemb != (void *)0x6d);
      __ptr = calloc(1,__size);
      if (__ptr == (void *)0x0) {
LAB_00115040:
        __ptr_00 = *param_3;
      }
      else {
        if ((*(int *)(param_2 + 0x48) == 0) || (*(int *)(param_2 + 0x44) < 0)) {
LAB_0011502b:
          param_3[1] = __nmemb;
          free(__ptr);
          uVar8 = 0;
          goto LAB_00115051;
        }
        local_58 = 0;
        do {
          FUN_00114d00(param_1,__ptr,0,__size,param_2,0);
          if (uVar5 != __size) {
LAB_00115123:
            __ptr_00 = *param_3;
            goto LAB_00115127;
          }
          if (uVar4 != 0) {
            pvVar6 = (void *)(uVar4 + (long)__nmemb);
            lVar11 = __size * (long)__nmemb;
            lVar10 = (long)__nmemb * -4;
            do {
              uVar1 = *(uint *)((long)__ptr + (long)__nmemb * 4 + lVar10);
              local_44 = uVar1;
              if (DAT_003204f8 == 0x1020304) {
                local_44 = uVar1 << 0x18;
                local_44 = local_44 |
                           CONCAT12((char)((ulong)uVar1 >> 8),
                                    CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18)));
              }
              if ((int)local_44 < 0) goto LAB_0011502b;
              __ptr_00 = *param_3;
              if (param_3[1] < __nmemb || param_3[1] == __nmemb) goto LAB_00115100;
              FUN_00114d00(param_1,__ptr_00,lVar11,__size,param_2,0);
              if (uVar5 != uVar7) goto LAB_00115123;
              __nmemb = (void *)((long)__nmemb + 1);
              lVar11 = lVar11 + __size;
            } while (pvVar6 != __nmemb);
          }
          uVar1 = *(uint *)((long)__ptr + uVar4 * 4);
          local_44 = uVar1;
          if (DAT_003204f8 == 0x1020304) {
            local_44 = uVar1 << 0x18;
            local_44 = local_44 |
                       CONCAT12((char)((ulong)uVar1 >> 8),
                                CONCAT11((char)(uVar1 >> 0x10),(char)(uVar1 >> 0x18)));
          }
          local_58 = local_58 + 1;
          if ((*(uint *)(param_2 + 0x48) <= local_58) || ((int)local_44 < 0)) goto LAB_0011502b;
        } while (local_58 != 10000);
        __ptr_00 = *param_3;
LAB_00115100:
        piVar9 = __errno_location();
        *piVar9 = 0x16;
LAB_00115127:
        free(__ptr);
      }
      free(__ptr_00);
      uVar8 = 0xffffffff;
    }
  }
  else {
    piVar9 = __errno_location();
    *piVar9 = 0x16;
    uVar8 = 0xffffffff;
  }
LAB_00115051:
  if (lVar2 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar8;
}



long FUN_00115150(long *param_1,int param_2,long param_3)

{
  int iVar1;
  long lVar2;
  long lVar3;
  int *piVar4;
  long lVar5;
  int iVar6;
  long in_FS_OFFSET;
  
  lVar5 = (long)param_2;
  lVar2 = *(long *)(in_FS_OFFSET + 0x28);
  lVar3 = 0;
  if (param_2 != -2) {
    if ((-1 < param_2) && (iVar6 = (int)((ulong)(param_3 * param_1[1]) >> 2), param_2 < iVar6)) {
      do {
        iVar1 = *(int *)(*param_1 + lVar5 * 4);
        lVar5 = (long)iVar1;
        if (DAT_003204f8 == 0x1020304) {
          lVar5 = (long)CONCAT22(CONCAT11((char)iVar1,(char)((ulong)lVar5 >> 8)),
                                 CONCAT11((char)((uint)iVar1 >> 0x10),(char)((uint)iVar1 >> 0x18)));
        }
        lVar3 = lVar3 + 1;
        if ((int)lVar5 < 0) goto LAB_001151eb;
      } while ((int)lVar5 < iVar6 && lVar3 != 10000);
    }
    piVar4 = __errno_location();
    *piVar4 = 0x16;
    lVar3 = -1;
  }
LAB_001151eb:
  if (lVar2 == *(long *)(in_FS_OFFSET + 0x28)) {
    return lVar3;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



// WARNING: Could not reconcile some variable overlaps

undefined8 FUN_001155c0(undefined8 param_1,long param_2,long *param_3,void **param_4)

{
  int iVar1;
  long lVar2;
  long lVar3;
  void *__ptr;
  void *__ptr_00;
  ulong uVar4;
  ulong uVar5;
  int *piVar6;
  undefined8 uVar7;
  long extraout_RDX;
  long lVar8;
  ulong uVar9;
  long lVar10;
  long lVar11;
  ulong __size;
  ulong uVar12;
  long lVar13;
  long in_FS_OFFSET;
  int local_44;
  
  uVar9 = SEXT48((int)*(uint *)(param_2 + 0x30));
  lVar2 = *(long *)(in_FS_OFFSET + 0x28);
  __size = SEXT48(1 << ((byte)*(undefined2 *)(param_2 + 0x1e) & 0x1f));
  lVar3 = FUN_00115150(param_3,(ulong)*(uint *)(param_2 + 0x30),__size);
  if (lVar3 != -1) {
    uVar12 = __size >> 7;
    param_4[1] = (void *)(lVar3 * uVar12);
    __ptr = calloc((size_t)(void *)(lVar3 * uVar12),0x88);
    *param_4 = __ptr;
    if (__ptr != (void *)0x0) {
      __ptr_00 = malloc(__size);
      if (__ptr_00 == (void *)0x0) {
        free(__ptr);
        uVar7 = 0xffffffff;
        goto LAB_00115784;
      }
      if (lVar3 == 0) {
LAB_001157aa:
        free(__ptr_00);
        uVar7 = 0;
        goto LAB_00115784;
      }
      uVar4 = 1;
      if (uVar12 != 0) {
        uVar4 = uVar12 + 1;
      }
      lVar11 = 0;
      lVar13 = 0;
      do {
        FUN_00114d00(param_1,__ptr_00,0,__size,param_2,uVar9 & 0xffffffff);
        if (uVar5 != __size) break;
        if (uVar12 != 0) {
          lVar10 = uVar12 * 0x88 + lVar11;
          __ptr = __ptr_00;
          lVar8 = lVar11;
          do {
            FUN_00114bd0((long)*param_4 + lVar8,__ptr);
            lVar8 = extraout_RDX + 0x88;
            __ptr = (void *)((long)__ptr + 0x80);
          } while (lVar10 != lVar8);
        }
        iVar1 = *(int *)(*param_3 + uVar9 * 4);
        uVar9 = SEXT48(iVar1);
        if (DAT_003204f8 == 0x1020304) {
          local_44 = CONCAT22(CONCAT11((char)iVar1,(char)(uVar9 >> 8)),
                              CONCAT11((char)((uint)iVar1 >> 0x10),(char)(uVar9 >> 0x18)));
          uVar9 = SEXT48(local_44);
        }
        lVar13 = lVar13 + 1;
        if (lVar3 == lVar13) {
          if ((DAT_003204f8 == 0x1020304) && (param_4[1] != (void *)0x0)) {
            lVar3 = 0;
            __ptr = (void *)0x0;
            do {
              __ptr = (void *)((long)__ptr + 1);
              lVar11 = (long)*param_4 + lVar3;
              lVar3 = lVar3 + 0x88;
              FUN_001148c0(lVar11);
            } while (__ptr <= param_4[1] && param_4[1] != __ptr);
            free(__ptr_00);
            uVar7 = 0;
            goto LAB_00115784;
          }
          goto LAB_001157aa;
        }
        lVar11 = lVar11 + uVar12 * 0x88;
      } while (uVar4 < 10000);
      free(*param_4);
      free(__ptr_00);
      piVar6 = __errno_location();
      *piVar6 = 0x16;
    }
  }
  uVar7 = 0xffffffff;
LAB_00115784:
  if (lVar2 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar7;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



// WARNING: Could not reconcile some variable overlaps

undefined8 FUN_00115810(undefined8 param_1,long param_2,long *param_3,void **param_4)

{
  undefined2 uVar1;
  uint uVar2;
  int iVar3;
  long lVar4;
  void *__ptr;
  size_t sVar5;
  undefined8 uVar6;
  int *piVar7;
  ulong uVar8;
  size_t __size;
  long lVar9;
  void *__nmemb;
  long in_FS_OFFSET;
  int local_44;
  
  uVar1 = *(undefined2 *)(param_2 + 0x1e);
  uVar2 = *(uint *)(param_2 + 0x3c);
  uVar8 = SEXT48((int)uVar2);
  lVar4 = *(long *)(in_FS_OFFSET + 0x28);
  *param_4 = (void *)0x0;
  __size = SEXT48(1 << ((byte)uVar1 & 0x1f));
  __nmemb = (void *)FUN_00115150(param_3,(ulong)uVar2,__size);
  param_4[1] = __nmemb;
  if (__nmemb == (void *)0xffffffffffffffff) {
    __ptr = *param_4;
LAB_00115958:
    piVar7 = __errno_location();
    *piVar7 = 0x16;
  }
  else {
    __ptr = calloc((size_t)__nmemb,__size);
    *param_4 = __ptr;
    if (__ptr != (void *)0x0) {
      if ((int)uVar2 < 0) {
LAB_00115970:
        uVar6 = 0;
        goto LAB_00115932;
      }
      if (__nmemb != (void *)0x0) {
        lVar9 = 0;
        __nmemb = (void *)0x0;
        do {
          FUN_00114d00(param_1,__ptr,lVar9,__size,param_2,uVar8 & 0xffffffff);
          if (sVar5 != __size) {
            __ptr = *param_4;
            goto LAB_00115925;
          }
          iVar3 = *(int *)(*param_3 + uVar8 * 4);
          uVar8 = SEXT48(iVar3);
          if (DAT_003204f8 == 0x1020304) {
            local_44 = CONCAT22(CONCAT11((char)iVar3,(char)(uVar8 >> 8)),
                                CONCAT11((char)((uint)iVar3 >> 0x10),(char)(uVar8 >> 0x18)));
            uVar8 = SEXT48(local_44);
          }
          __nmemb = (void *)((long)__nmemb + 1);
          if ((int)uVar8 < 0) goto LAB_00115970;
          __ptr = *param_4;
        } while ((__nmemb != (void *)0x2710) &&
                (lVar9 = lVar9 + __size, __nmemb <= param_4[1] && param_4[1] != __nmemb));
      }
      goto LAB_00115958;
    }
  }
LAB_00115925:
  free(__ptr);
  uVar6 = 0xffffffff;
LAB_00115932:
  if (lVar4 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar6;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



// WARNING: Could not reconcile some variable overlaps

undefined8
FUN_00115980(undefined8 param_1,long param_2,long *param_3,long *param_4,void **param_5,
            long *param_6)

{
  char *pcVar1;
  undefined2 uVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  long lVar6;
  long lVar7;
  void *__ptr;
  int *piVar8;
  undefined8 uVar9;
  long lVar10;
  long lVar11;
  ulong uVar12;
  void *__size;
  void *__nmemb;
  long in_FS_OFFSET;
  int local_44;
  
  lVar6 = param_4[1];
  *param_6 = 0;
  if (lVar6 == 0) {
LAB_001159c0:
    param_5[1] = (void *)0x0;
    param_5[2] = (void *)0x0;
    param_5[3] = (void *)0x0;
    *param_5 = (void *)0x0;
    return 0;
  }
  lVar10 = *param_4;
  if (*(char *)(lVar10 + 0x42) != '\x05') {
    lVar11 = 0;
    lVar7 = lVar10;
    do {
      lVar10 = lVar7 + 0x88;
      lVar11 = lVar11 + 1;
      if (lVar6 == lVar11) goto LAB_001159c0;
      pcVar1 = (char *)(lVar7 + 0xca);
      lVar7 = lVar10;
    } while (*pcVar1 != '\x05');
  }
  uVar4 = *(uint *)(lVar10 + 0x78);
  *param_6 = lVar10;
  if ((int)uVar4 < 0) goto LAB_001159c0;
  uVar5 = *(uint *)(lVar10 + 0x7c);
  uVar12 = SEXT48((int)uVar4);
  uVar2 = *(undefined2 *)(param_2 + 0x1e);
  *param_5 = (void *)0x0;
  lVar6 = *(long *)(in_FS_OFFSET + 0x28);
  __size = (void *)(long)(1 << ((byte)uVar2 & 0x1f));
  __nmemb = (void *)FUN_00115150(param_3,(ulong)uVar4,__size);
  param_5[1] = __nmemb;
  param_5[2] = (void *)(ulong)uVar5;
  param_5[3] = __size;
  if (__nmemb == (void *)0xffffffffffffffff) {
LAB_00115356:
    __ptr = *param_5;
  }
  else {
    __ptr = calloc((size_t)__nmemb,(size_t)__size);
    *param_5 = __ptr;
    if (__ptr == (void *)0x0) {
      param_5[1] = (void *)0x0;
      param_5[2] = (void *)0x0;
      uVar9 = 0xffffffff;
      param_5[3] = (void *)0x0;
      goto LAB_00115337;
    }
    if ((int)uVar4 < 0) {
LAB_00115335:
      uVar9 = 0;
      goto LAB_00115337;
    }
    if (__nmemb != (void *)0x0) {
      lVar10 = 0;
      __nmemb = (void *)0x0;
      do {
        FUN_00114d00(param_1,__ptr,lVar10,__size,param_2,uVar12 & 0xffffffff);
        if (__ptr != __size) {
          if (((void *)((long)param_5[1] + -1) != __nmemb) || ((long)__ptr < 1)) goto LAB_00115356;
          goto LAB_00115335;
        }
        iVar3 = *(int *)(*param_3 + uVar12 * 4);
        uVar12 = SEXT48(iVar3);
        if (DAT_003204f8 == 0x1020304) {
          local_44 = CONCAT22(CONCAT11((char)iVar3,(char)(uVar12 >> 8)),
                              CONCAT11((char)((uint)iVar3 >> 0x10),(char)(uVar12 >> 0x18)));
          uVar12 = SEXT48(local_44);
        }
        __nmemb = (void *)((long)__nmemb + 1);
        if ((int)uVar12 < 0) goto LAB_00115335;
        __ptr = *param_5;
      } while ((__nmemb != (void *)0x2710) &&
              (lVar10 = lVar10 + (long)__size, __nmemb <= param_5[1] && param_5[1] != __nmemb));
    }
  }
  piVar8 = __errno_location();
  *piVar8 = 0x16;
  param_5[1] = (void *)0x0;
  param_5[2] = (void *)0x0;
  param_5[3] = (void *)0x0;
  free(__ptr);
  *param_5 = (void *)0x0;
  uVar9 = 0xffffffff;
LAB_00115337:
  if (lVar6 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar9;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



ulong FUN_00115a00(long *param_1,char *param_2,uint param_3)

{
  ushort uVar1;
  long lVar2;
  undefined uVar3;
  uint uVar4;
  size_t sVar5;
  int *piVar6;
  ushort *puVar7;
  char *pcVar8;
  ulong uVar9;
  byte *pbVar10;
  long in_FS_OFFSET;
  
  lVar2 = *(long *)(in_FS_OFFSET + 0x28);
  sVar5 = strlen(param_2);
  uVar9 = param_1[1];
  if (uVar9 != 0) {
    pbVar10 = (byte *)(*param_1 + -0x46 + uVar9 * 0x88);
    do {
      if ((uint)*pbVar10 == param_3) {
        puVar7 = (ushort *)(pbVar10 + -0x42);
        pcVar8 = param_2;
        while( true ) {
          uVar1 = *puVar7;
          uVar4 = (uint)uVar1;
          uVar3 = (undefined)uVar1;
          if (DAT_003204f8 == 0x1020304) {
            uVar1 = CONCAT11(uVar3,(char)((ulong)uVar1 >> 8));
          }
          if ((int)*pcVar8 != (uint)uVar1) break;
          puVar7 = puVar7 + 1;
          pcVar8 = pcVar8 + 1;
          if ((ushort *)(pbVar10 + sVar5 * 2 + -0x40) == puVar7) goto LAB_00115af0;
        }
        if (DAT_003204f8 == 0x1020304) {
          uVar4 = (uint)CONCAT11(uVar3,(char)((ulong)uVar4 >> 8));
        }
        if (((int)*pcVar8 & 0xffU) == uVar4) {
LAB_00115af0:
          uVar9 = uVar9 & 0xffffffff;
          goto LAB_00115b05;
        }
      }
      pbVar10 = pbVar10 + -0x88;
      uVar9 = uVar9 - 1;
    } while (uVar9 != 0);
  }
  piVar6 = __errno_location();
  *piVar6 = 3;
  uVar9 = 0;
LAB_00115b05:
  if (lVar2 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return uVar9;
}



// WARNING: Could not reconcile some variable overlaps

undefined8
FUN_00115b30(undefined8 param_1,long param_2,long *param_3,long *param_4,long *param_5,long *param_6
            ,undefined8 param_7,void **param_8)

{
  long lVar1;
  undefined2 uVar2;
  uint local_4;
  uint uVar3;
  int iVar4;
  void *__ptr;
  int *piVar5;
  undefined8 uVar6;
  ulong uVar7;
  void *__nmemb;
  void *__size;
  long lVar8;
  long in_FS_OFFSET;
  int local_44;
  
  iVar4 = FUN_00115a00(param_6,param_7,2);
  if (iVar4 < 1) {
    *(undefined4 *)param_8 = 0;
    *(undefined4 *)((long)param_8 + 4) = 0;
    *(undefined4 *)(param_8 + 1) = 0;
    *(undefined4 *)((long)param_8 + 0xc) = 0;
    *(undefined4 *)(param_8 + 2) = 0;
    *(undefined4 *)((long)param_8 + 0x14) = 0;
    *(undefined4 *)(param_8 + 3) = 0;
    *(undefined4 *)((long)param_8 + 0x1c) = 0;
    return 0xffffffff;
  }
  lVar1 = *param_6 + -0x88 + (long)iVar4 * 0x88;
  uVar3 = *(uint *)(lVar1 + 0x78);
  __ptr = (void *)(ulong)*(uint *)(lVar1 + 0x7c);
  if ((__ptr < (void *)(ulong)*(uint *)(param_2 + 0x38)) && (*param_5 != 0)) {
    uVar7 = SEXT48((int)uVar3);
    uVar2 = *(undefined2 *)(param_2 + 0x20);
    *param_8 = (void *)0x0;
    lVar1 = *(long *)(in_FS_OFFSET + 0x28);
    __size = (void *)(long)(1 << ((byte)uVar2 & 0x1f));
    __nmemb = (void *)FUN_00115150(param_4,(ulong)uVar3,
                                   (long)(1 << ((byte)*(ushort *)(param_2 + 0x1e) & 0x1f)));

    param_8[1] = __nmemb;
    param_8[2] = __ptr;
    param_8[3] = __size;
    if (__nmemb == (void *)0xffffffffffffffff) {
LAB_001154ef:
      __ptr = *param_8;
    }
    else {

      __ptr = calloc((size_t)__nmemb,(size_t)__size);
      *param_8 = __ptr;
      if (__ptr == (void *)0x0) {
        param_8[1] = (void *)0x0;
        param_8[2] = (void *)0x0;
        uVar6 = 0xffffffff;
        param_8[3] = (void *)0x0;
        goto LAB_00115531;
      }
      if ((int)uVar3 < 0) {
LAB_00115550:
        uVar6 = 0;
        goto LAB_00115531;
      }
      if (__nmemb != (void *)0x0) {
        lVar8 = 0;
        __nmemb = (void *)0x0;
        do {
          __ptr = (void *)FUN_00114d50(param_5,__ptr,lVar8,__size,param_2,uVar7 & 0xffffffff);
          if (__ptr != __size) goto LAB_001154ef;
          iVar4 = *(int *)(*param_4 + uVar7 * 4);
          uVar7 = SEXT48(iVar4);
          if (DAT_003204f8 == 0x1020304) {
            local_4 = CONCAT11((char)((uint)iVar4 >> 0x10),(char)(uVar7 >> 0x18));
            local_4 = CONCAT22(CONCAT11((char)iVar4,(char)(uVar7 >> 8)),(undefined2)local_44);
            uVar7 = SEXT48(local_44);
          }
          __nmemb = (void *)((long)__nmemb + 1);
          if ((int)uVar7 < 0) goto LAB_00115550;
          __ptr = *param_8;
        } while ((__nmemb != (void *)0x2710) &&
                (lVar8 = lVar8 + (long)__size, __nmemb <= param_8[1] && param_8[1] != __nmemb));
      }
    }
    piVar5 = __errno_location();
    *piVar5 = 0x16;
    param_8[1] = (void *)0x0;
    param_8[2] = (void *)0x0;
    param_8[3] = (void *)0x0;
    free(__ptr);
    *param_8 = (void *)0x0;
    uVar6 = 0xffffffff;
LAB_00115531:
    if (lVar1 == *(long *)(in_FS_OFFSET + 0x28)) {
      return uVar6;
    }
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  uVar7 = SEXT48((int)uVar3);
  uVar2 = *(undefined2 *)(param_2 + 0x1e);
  *param_8 = (void *)0x0;
  lVar1 = *(long *)(in_FS_OFFSET + 0x28);
  __size = (void *)(long)(1 << ((byte)uVar2 & 0x1f));
  __nmemb = (void *)FUN_00115150(param_3,(ulong)uVar3,__size);
  param_8[1] = __nmemb;
  param_8[2] = __ptr;
  param_8[3] = __size;
  if (__nmemb == (void *)0xffffffffffffffff) {
LAB_00115356:
    __ptr = *param_8;
  }
  else {
    __ptr = calloc((size_t)__nmemb,(size_t)__size);
    *param_8 = __ptr;
    if (__ptr == (void *)0x0) {
      param_8[1] = (void *)0x0;
      param_8[2] = (void *)0x0;
      uVar6 = 0xffffffff;
      param_8[3] = (void *)0x0;
      goto LAB_00115337;
    }
    if ((int)uVar3 < 0) {
LAB_00115335:
      uVar6 = 0;
      goto LAB_00115337;
    }
    if (__nmemb != (void *)0x0) {
      lVar8 = 0;
      __nmemb = (void *)0x0;
      do {
        FUN_00114d00(param_1,__ptr,lVar8,__size,param_2,uVar7 & 0xffffffff);
        if (__ptr != __size) {
          if (((void *)((long)param_8[1] + -1) != __nmemb) || ((long)__ptr < 1)) goto LAB_00115356;
          goto LAB_00115335;
        }
        iVar4 = *(int *)(*param_3 + uVar7 * 4);
        uVar7 = SEXT48(iVar4);
        if (DAT_003204f8 == 0x1020304) {
          local_44 = CONCAT11((char)((uint)iVar4 >> 0x10),(char)(uVar7 >> 0x18));
          local_44 = CONCAT22(CONCAT11((char)iVar4,(char)(uVar7 >> 8)),(undefined2)local_44);
          uVar7 = SEXT48(local_44);
        }
        __nmemb = (void *)((long)__nmemb + 1);
        if ((int)uVar7 < 0) goto LAB_00115335;
        __ptr = *param_8;
      } while ((__nmemb != (void *)0x2710) &&
              (lVar8 = lVar8 + (long)__size, __nmemb <= param_8[1] && param_8[1] != __nmemb));
    }
  }
  piVar5 = __errno_location();
  *piVar5 = 0x16;
  param_8[1] = (void *)0x0;
  param_8[2] = (void *)0x0;
  param_8[3] = (void *)0x0;
  free(__ptr);
  *param_8 = (void *)0x0;
  uVar6 = 0xffffffff;
LAB_00115337:
  if (lVar1 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar6;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void FUN_00115be0(void)

{

  return;
}



undefined8
FUN_00115c00(long *param_1,undefined8 param_2,uint param_3,void **param_4,long *param_5,
            ulong *param_6)

{
  uint *puVar1;
  uint *puVar2;
  long lVar3;
  uint uVar4;
  ushort uVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  void *pvVar9;
  int *piVar10;
  undefined8 uVar11;
  ulong uVar12;
  void *pvVar13;
  uint *puVar14;
  uint uVar15;
  ulong uVar16;
  uint *puVar17;
  uint uVar18;
  void *__ptr;
  ulong uVar19;
  long lVar20;
  long lVar21;
  ulong uVar22;
  long in_FS_OFFSET;
  
  lVar3 = *(long *)(in_FS_OFFSET + 0x28);
  if (0x3fffffff < param_3) goto LAB_001161f6;
  puVar17 = (uint *)(*param_1 + (ulong)param_3);
  iVar6 = FUN_00114380(param_1,param_2,puVar17,0);
  if (iVar6 == -1) goto LAB_00115f88;
  uVar8 = *puVar17;
  if (DAT_003204f8 == 0x1020304) {
    uVar8 = CONCAT13((char)uVar8,
                     CONCAT12((char)((ulong)uVar8 >> 8),
                              CONCAT11((char)(uVar8 >> 0x10),(char)(uVar8 >> 0x18))));
    if (0x1fffffff < uVar8) goto LAB_001161f6;
    uVar15 = puVar17[1];
    uVar15 = CONCAT13((char)uVar15,
                      CONCAT12((char)((ulong)uVar15 >> 8),
                               CONCAT11((char)(uVar15 >> 0x10),(char)(uVar15 >> 0x18))));
LAB_00115c83:
    if (0x2aaaaaa < uVar15) {
LAB_00115f88:
      piVar10 = __errno_location();
      __ptr = *param_4;
      goto LAB_00115f95;
    }
    uVar22 = *param_6;
    if (uVar22 == 0) {
      *param_6 = (ulong)uVar15;
      pvVar9 = malloc((ulong)uVar15 * 0x18);
    }
    else {
      __ptr = *param_4;
      if (0x2aaaaaa < uVar22) {
LAB_0011620e:
        piVar10 = __errno_location();
        goto LAB_00115f95;
      }
      *param_6 = uVar22 + uVar15;
      pvVar9 = realloc(__ptr,(uVar22 + uVar15) * 0x18);
    }
    uVar22 = (ulong)uVar15;
    if (pvVar9 != (void *)0x0) {
      *param_4 = pvVar9;
      lVar21 = *param_5;
      *param_5 = lVar21 + uVar22;
      pvVar9 = (void *)((long)pvVar9 + lVar21 * 0x18);
      puVar1 = (uint *)(*param_1 + 8 + (ulong)param_3);
      puVar17 = (uint *)((long)puVar17 + (ulong)uVar8);
      iVar6 = FUN_00114380(param_1,param_2,puVar17,0);
      if (iVar6 != -1) {
        if (uVar15 != 0) {
          uVar16 = 0;
          do {
            iVar7 = FUN_00114380(param_1,param_2,puVar1,0);
            iVar6 = DAT_003204f8;
            if (iVar7 == -1) goto LAB_00115f88;
            uVar8 = puVar1[uVar16 * 2 + 1];
            uVar19 = (ulong)uVar8;
            if (DAT_003204f8 == 0x1020304) {
              uVar19 = (ulong)CONCAT13((char)uVar8,
                                       CONCAT12((char)(uVar19 >> 8),
                                                CONCAT11((char)(uVar8 >> 0x10),(char)(uVar8 >> 0x18)
                                                        )));
            }
            puVar2 = (uint *)((long)puVar1 + (uVar19 - 8));
            if ((puVar17 < puVar2) || (puVar2 < puVar1)) goto LAB_00115f88;
            uVar8 = puVar1[uVar16 * 2];
            puVar14 = (uint *)((long)pvVar9 + uVar16 * 0x18);
            if (DAT_003204f8 == 0x1020304) {
              *puVar14 = CONCAT13((char)uVar8,
                                  CONCAT12((char)((ulong)uVar8 >> 8),
                                           CONCAT11((char)(uVar8 >> 0x10),(char)(uVar8 >> 0x18))));
              uVar15 = *puVar2;
              uVar4 = CONCAT12((char)((ulong)uVar15 >> 8),
                               CONCAT11((char)(uVar15 >> 0x10),(char)(uVar15 >> 0x18)));
              uVar8 = CONCAT13((char)uVar15,uVar4);
              puVar14[1] = uVar8;
              uVar18 = (uint)uVar4 & 0x1000;
              if ((uVar15 & 0x100000) == 0) goto LAB_00115ee0;
              uVar15 = puVar2[1];
              uVar15 = CONCAT13((char)uVar15,
                                CONCAT12((char)((ulong)uVar15 >> 8),
                                         CONCAT11((char)(uVar15 >> 0x10),(char)(uVar15 >> 0x18))));
LAB_00115df6:
              uVar19 = (ulong)uVar15;
              if (uVar15 == 0) goto LAB_00115f88;
              lVar21 = 8;
              lVar20 = 2;
            }
            else {
              *puVar14 = uVar8;
              uVar8 = *puVar2;
              puVar14[1] = uVar8;
              uVar18 = uVar8 & 0x1000;
              if (uVar18 != 0) {
                uVar15 = puVar2[1];
                goto LAB_00115df6;
              }
LAB_00115ee0:
              lVar21 = 4;
              uVar19 = 1;
              lVar20 = 1;
            }
            if ((uVar8 & 0xe000) != 0) goto switchD_00115e30_caseD_0;
            switch(uVar8 & 0xfff) {
            case 2:
              if (uVar18 != 0) break;
              uVar5 = *(ushort *)((long)puVar2 + lVar21);
              if (iVar6 == 0x1020304) {
                uVar5 = CONCAT11((char)uVar5,(char)((ulong)uVar5 >> 8));
              }
              *(ushort *)(puVar14 + 2) = uVar5;
joined_r0x00115ed7:
              uVar16 = uVar16 + 1;
              goto joined_r0x00115ed7;
            case 3:
            case 4:
            case 0xb:
            case 0x13:
              if (uVar18 == 0) {
                uVar8 = *(uint *)((long)puVar2 + lVar21);
                if (iVar6 == 0x1020304) {
                  puVar14[2] = CONCAT13((char)uVar8,
                                        CONCAT12((char)((ulong)uVar8 >> 8),
                                                 CONCAT11((char)(uVar8 >> 0x10),
                                                          (char)(uVar8 >> 0x18))));
                }
                else {
                  puVar14[2] = uVar8;
                }
                goto joined_r0x00115ed7;
              }
              break;
            case 5:
            case 0x14:
            case 0x15:
            case 0x40:
              if (uVar18 == 0) {
                uVar11 = *(undefined8 *)((long)puVar2 + lVar21);
                if (iVar6 == 0x1020304) {
                  uVar11 = CONCAT17((char)uVar11,
                                    CONCAT16((char)((ulong)uVar11 >> 8),
                                             CONCAT15((char)((ulong)uVar11 >> 0x10),
                                                      CONCAT14((char)((ulong)uVar11 >> 0x18),
                                                               CONCAT13((char)((ulong)uVar11 >> 0x20
                                                                              ),CONCAT12((char)((
                                                  ulong)uVar11 >> 0x28),
                                                  CONCAT11((char)((ulong)uVar11 >> 0x30),
                                                           (char)((ulong)uVar11 >> 0x38))))))));
                }
                *(undefined8 *)(puVar14 + 2) = uVar11;
              }
              break;
            case 0x1e:
            case 0x1f:
              if (uVar19 != 1) {
                __ptr = *param_4;
                if ((0x2aaaaaa < *param_6) || (0x2aaaaaa < uVar19)) goto LAB_0011620e;
                uVar12 = *param_6 + uVar19;
                *param_6 = uVar12;
                pvVar13 = realloc(__ptr,uVar12 * 0x18);
                if (pvVar13 == (void *)0x0) goto LAB_00116220;
                pvVar9 = (void *)((long)((long)pvVar9 - (long)__ptr) + (long)pvVar13);
                *param_4 = pvVar13;
              }
              if (uVar16 < uVar22) {
                puVar14 = (uint *)((long)pvVar9 + uVar16 * 0x18 + 8);
                uVar19 = uVar19 + uVar16;
                do {
                  uVar8 = puVar2[lVar20];
                  if (iVar6 == 0x1020304) {
                    uVar8 = CONCAT13((char)uVar8,
                                     CONCAT12((char)((ulong)uVar8 >> 8),
                                              CONCAT11((char)(uVar8 >> 0x10),(char)(uVar8 >> 0x18)))
                                    );
                  }
                  *puVar14 = uVar8;
                  *(long *)(puVar14 + 2) = (long)puVar2 + lVar21 + 4;
                  lVar20 = lVar20 + (ulong)((uVar8 + 1) - (uint)((uVar8 & 1) == 0) >> 1);
                  if (puVar17 <= (uint *)((long)puVar2 + lVar20)) goto LAB_00115f88;
                  uVar16 = uVar16 + 1;
                  lVar21 = lVar20 * 4;
                } while ((uVar16 != uVar19) && (puVar14 = puVar14 + 6, uVar22 != uVar16));
              }
              goto joined_r0x00115ed7;
            }
switchD_00115e30_caseD_0:
            uVar16 = uVar16 + 1;

          } while (uVar16 < uVar22);
        }

joined_r0x00115ed77:
        uVar11 = 0;
        goto LAB_00115fa5;
      }
      goto LAB_00115f88;
    }
LAB_00116220:
    __ptr = *param_4;
  }
  else {
    if (uVar8 < 0x20000000) {
      uVar15 = puVar17[1];
      goto LAB_00115c83;
    }
LAB_001161f6:
    piVar10 = __errno_location();
    *piVar10 = 0x16;
    __ptr = *param_4;
LAB_00115f95:
    *piVar10 = 0x16;
  }
  free(__ptr);
  uVar11 = 0xffffffff;
LAB_00115fa5:
  if (lVar3 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar11;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



// WARNING: Could not reconcile some variable overlaps

ulong FUN_00116240(ushort **param_1,undefined8 param_2,ushort *param_3,undefined8 *param_4,
                  undefined8 *param_5)

{
  undefined auVar1 [16];
  ushort uVar2;
  ushort uVar3;
  ushort uVar4;
  uint uVar5;
  ushort *puVar6;
  int iVar7;
  ulong uVar8;
  long in_FS_OFFSET;
  undefined8 local_48;
  long local_40;
  
  puVar6 = *param_1;
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  iVar7 = FUN_00114380(param_1,param_2,puVar6,0x1c);
  if (iVar7 != -1) {
    iVar7 = FUN_00114380(param_1,param_2,puVar6 + 0xe,0);
    if (iVar7 != -1) {
      uVar2 = *puVar6;
      uVar3 = puVar6[2];
      uVar4 = puVar6[3];
      if (DAT_003204f8 == 0x1020304) {
        local_48 = CONCAT71(CONCAT61(local_48,(char)uVar2),(char)((ulong)uVar2 >> 8));
        *param_3 = (ushort)local_48;
        local_48 = CONCAT71(CONCAT61(local_48,(char)uVar3),(char)((ulong)uVar3 >> 8));
        param_3[2] = (ushort)local_48;
        local_48 = CONCAT71(CONCAT61(local_48,(char)uVar4),(char)((ulong)uVar4 >> 8));
                    // WARNING: Load size is inaccurate
        auVar1[0] = *(undefined *)(puVar6 + 4);
        *(int *)(param_3 + 4) = SUB164(auVar1,0);
        *(int *)(param_3 + 6) = SUB164(auVar1[0] >> 0x20,0);
        *(int *)(param_3 + 8) = SUB164(auVar1[0] >> 0x40,0);
        *(int *)(param_3 + 10) = SUB164(auVar1[0] >> 0x60,0);
        param_3[3] = (ushort)local_48;
        FUN_00114b40(SUB168(auVar1,0));
        uVar5 = *(uint *)(puVar6 + 0xc);
        *(uint *)(param_3 + 0xc) =
             CONCAT22(CONCAT11((char)uVar5,(char)((ulong)uVar5 >> 8)),
                      CONCAT11((char)(uVar5 >> 0x10),(char)(uVar5 >> 0x18)));
        uVar5 = *(uint *)(puVar6 + 0x16);
        *param_5 = 0;
        *param_4 = 0;
        uVar5 = CONCAT22(CONCAT11((char)uVar5,(char)((ulong)uVar5 >> 8)),
                         CONCAT11((char)(uVar5 >> 0x10),(char)(uVar5 >> 0x18)));
      }
      else {
                    // WARNING: Load size is inaccurate
        auVar1[0] = *(undefined *)(puVar6 + 4);
        param_3[2] = uVar3;
        param_3[3] = uVar4;
        *(int *)(param_3 + 4) = SUB164(auVar1,0);
        *(int *)(param_3 + 6) = SUB164(auVar1[0] >> 0x20,0);
        *(int *)(param_3 + 8) = SUB164(auVar1[0] >> 0x40,0);
        *(int *)(param_3 + 10) = SUB164(auVar1[0] >> 0x60,0);
        *param_3 = uVar2;
        FUN_00114b40(SUB168(auVar1,0));
        uVar5 = *(uint *)(puVar6 + 0x16);
        *(undefined4 *)(param_3 + 0xc) = *(undefined4 *)(puVar6 + 0xc);
        *param_5 = 0;
        *param_4 = 0;
      }
      local_48 = 0;
      iVar7 = FUN_00115c00(param_1,param_2,(ulong)uVar5,param_4,param_5,&local_48);
      uVar8 = (ulong)-(uint)(iVar7 == -1);
      goto LAB_0011632b;
    }
  }
  uVar8 = 0xffffffff;
LAB_0011632b:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar8;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



undefined8 FUN_00116420(long param_1,ushort **param_2,ulong **param_3)

{
  ushort uVar1;
  uint uVar2;
  undefined4 uVar3;
  long lVar4;
  ushort *puVar5;
  ushort *puVar6;
  undefined8 uVar7;
  byte bVar8;
  ushort uVar9;
  ushort *puVar10;
  ushort *puVar11;
  ulong uVar12;
  ushort *puVar13;
  ulong uVar14;
  ulong uVar15;
  ulong *puVar16;
  ulong uVar17;
  long lVar18;
  ulong uVar19;
  int iVar20;
  long in_FS_OFFSET;
  
  iVar20 = DAT_003204f8;
  lVar4 = *(long *)(in_FS_OFFSET + 0x28);
  bVar8 = (byte)*(undefined2 *)(param_1 + 0x20);
  if ((ushort *)(ulong)*(uint *)(param_1 + 0x38) <= param_2[2]) {
    bVar8 = (byte)*(undefined2 *)(param_1 + 0x1e);
  }
  if (param_2[3] != (ushort *)(long)(1 << (bVar8 & 0x1f))) {
    FUN_00106330();
    goto LAB_0011679f;
  }
  puVar10 = *param_2;
  lVar18 = 0;
  puVar13 = (ushort *)((long)param_2[3] * (long)param_2[1] + (long)puVar10);
  while( true ) {
    uVar19 = (ulong)*puVar10;
    if (DAT_003204f8 == 0x1020304) {
      uVar19 = (ulong)CONCAT11((char)*puVar10,(char)(uVar19 >> 8));
    }
    if (((short)uVar19 == 0) || (puVar10 = (ushort *)((long)puVar10 + uVar19), puVar13 < puVar10))
    break;
    lVar18 = lVar18 + 1;
  }
  if (lVar18 == 0) {
LAB_0011678e:
    uVar7 = 0xffffffff;
  }
  else {
    uVar19 = lVar18 - 1;
    puVar16 = (ulong *)malloc(uVar19 * 0x210 + 0x218);
    *param_3 = puVar16;
    if (puVar16 == (ulong *)0x0) goto LAB_0011678e;
    puVar5 = (ushort *)memset(puVar16 + 1,0,uVar19 * 0x210);
    puVar10 = *param_2;
    if (uVar19 == 0) {
      uVar15 = 0;
    }
    else {
      uVar15 = 0;
      puVar6 = puVar5;
      if (puVar10 + 1 <= puVar13) {
        uVar14 = 0;
        do {
          uVar1 = *puVar10;
          puVar11 = puVar5 + uVar14 * 0x108;
          *puVar6 = uVar1;
          if (iVar20 == 0x1020304) {
            *puVar11 = CONCAT11((char)uVar1,(char)((ulong)uVar1 >> 8));
            if (puVar10 + 4 <= puVar13) {
              uVar3 = *(undefined4 *)(puVar10 + 2);
              *(undefined4 *)(puVar6 + 2) = uVar3;
              *(uint *)(puVar11 + 2) =
                   (uint)CONCAT11((char)((uint)uVar3 >> 0x10),(char)((uint)uVar3 >> 0x18));
              if (puVar10 + 8 <= puVar13) {
                uVar7 = *(undefined8 *)(puVar10 + 4);
                *(undefined8 *)(puVar6 + 4) = uVar7;
                uVar7 = CONCAT17((char)uVar7,
                                 CONCAT16((char)((ulong)uVar7 >> 8),
                                          CONCAT15((char)((ulong)uVar7 >> 0x10),
                                                   CONCAT14((char)((ulong)uVar7 >> 0x18),
                                                            CONCAT13((char)((ulong)uVar7 >> 0x20),
                                                                     CONCAT12((char)((ulong)uVar7 >>
                                                                                    0x28),
                                                                              CONCAT11((char)((ulong
                                                  )uVar7 >> 0x30),(char)((ulong)uVar7 >> 0x38)))))))
                                );
                goto LAB_001165cd;
              }
            }
LAB_00116750:
            *puVar6 = 0;
            puVar16 = *param_3;
            goto LAB_0011675c;
          }
          *puVar11 = uVar1;
          if (puVar13 < puVar10 + 4) goto LAB_00116750;
          uVar2 = *(uint *)(puVar10 + 2);
          *(uint *)(puVar6 + 2) = uVar2;
          *(uint *)(puVar11 + 2) = uVar2 & 0xffff;
          if (puVar13 < puVar10 + 8) goto LAB_00116750;
          uVar7 = *(undefined8 *)(puVar10 + 4);
          *(undefined8 *)(puVar6 + 4) = uVar7;
LAB_001165cd:
          *(undefined8 *)(puVar11 + 4) = uVar7;
          uVar1 = *puVar6;
          if (uVar1 < 0xe) {
            *puVar6 = 0;
            uVar17 = uVar14;
            iVar20 = DAT_003204f8;
          }
          else {
            uVar9 = uVar1 - 0xe;
            *puVar6 = 0xff;
            if (uVar9 < 0xff) {
              uVar17 = (ulong)uVar9;
              *puVar6 = uVar9;
              if (puVar13 < puVar10 + 8 + uVar17) goto LAB_00116750;
              uVar15 = (ulong)uVar9;
              if (uVar9 != 0) goto LAB_00116616;
            }
            else {
              if (puVar13 < puVar10 + 0x107) goto LAB_00116750;
              uVar15 = 0xff;
              uVar17 = 0xff;
LAB_00116616:
              uVar12 = 0;
              do {
                puVar6[uVar12 + 8] = (puVar10 + 8)[uVar12];
                uVar12 = uVar12 + 1;
              } while (uVar12 < uVar17);
            }
            puVar6[uVar15 + 8] = 0;
            uVar17 = uVar14 + 1;
            uVar15 = uVar14;
            iVar20 = DAT_003204f8;
          }
          uVar14 = uVar17;
          DAT_003204f8 = iVar20;
          if (uVar19 <= uVar14) {
            puVar16 = *param_3;
            goto LAB_0011675c;
          }
          puVar10 = (ushort *)((long)puVar10 + (ulong)uVar1);
          puVar6 = puVar5 + uVar15 * 0x108;
        } while (puVar10 + 1 <= puVar13);
        puVar16 = *param_3;
      }
      *puVar6 = 0;
    }
LAB_0011675c:
    *puVar16 = uVar15;
    uVar7 = 0;
  }
  if (lVar4 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar7;
  }
LAB_0011679f:
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
}



void FUN_00116810(char *param_1,size_t param_2,uint param_3)

{
  long lVar1;
  uint *puVar2;
  uint uVar3;
  
  puVar2 = &DAT_0031fa30;
  uVar3 = 1;
  lVar1 = 0;
  while( true ) {
    if (uVar3 == param_3) {
      snprintf(param_1,param_2,"%s",(&PTR_s_Code_page_0031fa28)[lVar1 * 2]);
      return;
    }
    lVar1 = lVar1 + 1;
    if (lVar1 == 0x14) break;
    uVar3 = *puVar2;
    puVar2 = puVar2 + 4;
  }
  snprintf(param_1,param_2,1,0xffffffffffffffff,&DAT_0011bdca,(ulong)param_3);
  return;
}



ulong FUN_00116880(long param_1,ulong param_2,long param_3)

{
  int iVar1;
  ulong uVar2;
  ulong uVar3;
  ulong uVar4;
  long lVar5;
  uint uVar6;
  
  lVar5 = param_3 / 36000000000;
  uVar2 = lVar5 + ((lVar5 / 6 + (lVar5 >> 0x3f) >> 2) - (lVar5 >> 0x3f)) * -0x18;
  if (param_3 / 864000000000 + (param_3 >> 0x3f) == param_3 >> 0x3f) {
    uVar6 = 0;
    uVar4 = param_2;
    uVar3 = param_2;
    lVar5 = param_1;
    if (uVar2 != 0) goto LAB_001169e4;
  }
  else {
    uVar6 = snprintf(param_1,param_2,1,0xffffffffffffffff,&DAT_0011bdcf);
    uVar4 = SEXT48((int)uVar6);
    if (param_2 <= uVar4) goto LAB_00116999;
    uVar3 = param_2 - uVar4;
    lVar5 = uVar4 + param_1;
LAB_001169e4:
    iVar1 = snprintf(lVar5,uVar3,1,0xffffffffffffffff,"%.2d:",uVar2 & 0xffffffff);
    uVar6 = uVar6 + iVar1;
    uVar4 = (ulong)uVar6;
    uVar2 = SEXT48((int)uVar6);
    if (param_2 <= uVar2) goto LAB_00116999;
    uVar4 = param_2 - uVar2;
    lVar5 = uVar2 + param_1;
  }
  iVar1 = snprintf(lVar5,uVar4,1,0xffffffffffffffff,"%.2d:",
                         (ulong)(uint)((int)(param_3 / 600000000) +
                                      (int)((param_3 / 600000000) / 0x3c) * -0x3c));
  uVar6 = uVar6 + iVar1;
  uVar4 = (ulong)uVar6;
  uVar2 = SEXT48((int)uVar6);
  if (uVar2 < param_2) {
    iVar1 = snprintf(uVar2 + param_1,param_2 - uVar2,1,0xffffffffffffffff,&DAT_0011bdda,
                           (ulong)(uint)((int)(param_3 / 10000000) +
                                        (int)((param_3 / 10000000) / 0x3c) * -0x3c));
    uVar4 = (ulong)(uVar6 + iVar1);
  }
LAB_00116999:
  return uVar4 & 0xffffffff;
}



void FUN_00116a90(undefined *param_1,long param_2,short *param_3)

{
  short sVar1;
  undefined *puVar2;
  undefined *puVar3;
  
  if ((param_2 == 0) || (sVar1 = *param_3, sVar1 == 0)) {
    *param_1 = 0;
    return;
  }
  param_3 = param_3 + 1;
  puVar2 = param_1 + 1;
  do {
    puVar3 = puVar2;
    puVar3[-1] = (char)sVar1;
    if (puVar3 == param_1 + param_2) break;
    sVar1 = *param_3;
    param_3 = param_3 + 1;
    puVar2 = puVar3 + 1;
  } while (sVar1 != 0);
  *puVar3 = 0;
  return;
}



undefined8 FUN_00116ae0(time_t *param_1,long param_2)

{
  int iVar1;
  time_t tVar2;
  undefined8 uVar3;
  int *piVar4;
  int iVar5;
  ulong uVar6;
  long lVar7;
  uint uVar8;
  uint uVar9;
  ulong uVar10;
  int iVar11;
  long lVar12;
  long in_FS_OFFSET;
  int local_58;
  int local_54;
  int local_50;
  uint local_4c;
  int local_48;
  int local_44;
  undefined8 local_40;
  int local_38;
  char *local_28;
  long local_20;
  
  local_20 = *(long *)(in_FS_OFFSET + 0x28);
  param_1[1] = (param_2 % 10000000) * 100;
  local_58 = (int)(param_2 / 10000000) + (int)((param_2 / 10000000) / 0x3c) * -0x3c;
  local_54 = (int)(param_2 / 600000000) + (int)((param_2 / 600000000) / 0x3c) * -0x3c;
  lVar12 = param_2 / 36000000000;
  local_50 = (int)lVar12 +
             ((int)(lVar12 / 6 + (lVar12 >> 0x3f) >> 2) - (int)(lVar12 >> 0x3f)) * -0x18;
  local_44 = (int)(param_2 / 0x11ed178c6c000);
  lVar12 = -1;
  uVar8 = local_44 + 0x641;
  if (0x641 < (int)uVar8) {
    iVar11 = 0;
    uVar6 = 0x641;
    do {
      iVar1 = 0x16d;
      iVar5 = (int)uVar6;
      if (((uVar6 & 3) == 0) && (iVar1 = 0x16e, iVar5 == (int)(uVar6 / 100) * 100)) {
        iVar1 = (uint)(iVar5 == (int)(uVar6 / 400) * 400) + 0x16d;
      }
      uVar6 = (ulong)(iVar5 + 1U);
      iVar11 = iVar11 + iVar1;
    } while (uVar8 != iVar5 + 1U);
    lVar12 = (long)(iVar11 + -1);
  }
  uVar10 = param_2 / 864000000000 - lVar12;
  iVar11 = 0x1f;
  lVar12 = 1;
  uVar6 = uVar10;
  do {
    local_4c = (uint)uVar6;
    if (((lVar12 == 2) && ((uVar8 & 3) == 0)) &&
       (((int)uVar8 % 100 != 0 || ((int)uVar8 % 400 == 0)))) {
      if ((int)local_4c < iVar11 + 1) break;
      local_4c = local_4c - (iVar11 + 1);
    }
    else {
      if (((int)local_4c < iVar11) || (local_4c = local_4c - iVar11, lVar12 == 0xc)) break;
    }
    uVar6 = (ulong)local_4c;
    iVar11 = *(int *)(&DAT_0011c100 + lVar12 * 4);
    lVar12 = lVar12 + 1;
  } while( true );
  lVar12 = 1;
  lVar7 = 0;
  iVar11 = 0x1f;
  do {
    local_48 = (int)lVar7;
    uVar9 = (int)uVar10 - iVar11;
    uVar10 = (ulong)uVar9;
    if (lVar7 == 1) {
      if (((uVar8 & 3) == 0) && (((int)uVar8 % 100 != 0 || ((int)uVar8 % 400 == 0)))) {
        uVar10 = (ulong)(uVar9 - 1);
      }
      if ((int)uVar10 < 1) goto LAB_00116d70;
    }
    else {
      if ((int)uVar9 < 1) goto LAB_00116d70;
      if (lVar12 == 0xc) {
        local_48 = 0xc;
LAB_00116d70:
        local_44 = local_44 + -299;
        local_40 = 0;
        local_38 = 0;
        local_28 = &DAT_003204c0;
        tVar2 = mktime((tm *)&local_58);
        *param_1 = tVar2;
        if (tVar2 == -1) {
          piVar4 = __errno_location();
          *piVar4 = 0x16;
          uVar3 = 0xffffffff;
        }
        else {
          uVar3 = 0;
        }
        if (local_20 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
          __stack_chk_fail();
        }
        return uVar3;
      }
    }
    iVar11 = *(int *)(&DAT_0011c100 + lVar12 * 4);
    lVar7 = lVar7 + 1;
    lVar12 = lVar12 + 1;
  } while( true );
}



char * FUN_00116e50(time_t *param_1,char *param_2)

{
  char *pcVar1;
  
  pcVar1 = ctime_r(param_1,param_2);
  if (pcVar1 != (char *)0x0) {
    return param_2;
  }
  snprintf(param_2,0x1a,1,0xffffffffffffffff,"*Bad* 0x%16.16llx\n",*param_1);
  return param_2;
}



char * FUN_00116ea0(char *param_1,char **param_2)

{
  __locale_t __dataset;
  __locale_t __dataset_00;
  char *pcVar1;
  
  __dataset = newlocale(1,"C",(__locale_t)0x0);
  if (__dataset == (__locale_t)0x0) {
                    // WARNING: Subroutine does not return
    __assert_fail("c_lc_ctype != NULL","readcdf.c",0x7b,"cdf_app_to_mime");
  }
  __dataset_00 = uselocale(__dataset);
  if (__dataset_00 == (__locale_t)0x0) {
                    // WARNING: Subroutine does not return
    __assert_fail("old_lc_ctype != NULL","readcdf.c",0x7d,"cdf_app_to_mime");
  }
  do {
    if (*param_2 == (char *)0x0) {
      pcVar1 = (char *)0x0;
LAB_00116efb:
      uselocale(__dataset_00);
      freelocale(__dataset);
      return pcVar1;
    }
    pcVar1 = strcasestr(param_1,*param_2);
    if (pcVar1 != (char *)0x0) {
      pcVar1 = param_2[1];
      goto LAB_00116efb;
    }
    param_2 = param_2 + 2;
  } while( true );
}



ulong FUN_00116f70(long param_1,undefined4 param_2,undefined8 param_3,undefined8 param_4)

{
  void *pvVar1;
  byte bVar2;
  int iVar3;
  uint uVar4;
  int *piVar5;
  long *plVar6;
  ushort **ppuVar7;
  undefined8 uVar8;
  char *__s;
  byte *pbVar9;
  uint uVar10;
  ulong uVar11;
  long lVar12;
  undefined **ppuVar13;
  char *pcVar14;
  ulong uVar15;
  long lVar16;
  ulong *puVar17;
  undefined *puVar18;
  uint *puVar19;
  long in_FS_OFFSET;
  double dVar20;
  ulong **ppuVar21;
  long local_7a8;
  char *local_798;
  long local_760;
  uint *local_758;
  long local_750;
  void *local_748 [2];
  void *local_738 [2];
  void *local_728;
  ulong local_720;
  ulong *local_718 [2];
  undefined4 local_708 [2];
  undefined8 local_700;
  undefined8 local_6f8;
  void *local_6e8 [4];
  ulong *local_6c8;
  undefined8 local_6c0;
  ulong local_6b8;
  short local_6a8 [2];
  ushort local_6a4;
  ushort local_6a2;
  undefined local_688 [512];
  undefined local_488 [64];
  byte local_448 [1032];
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  local_708[0] = param_2;
  local_700 = param_3;
  local_6f8 = param_4;
  if ((*(uint *)(param_1 + 0x38) & 0x1000800) == 0) {
    iVar3 = FUN_00114c50(local_708,local_688);
    if (iVar3 != -1) {
      iVar3 = FUN_00114df0(local_708,local_688,local_748);
      __s = "Can\'t read SAT";
      if (iVar3 == -1) {
LAB_0011702a:
        if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
          iVar3 = FUN_00112ee0(param_1,"Composite Document File V2 Document");
          if (iVar3 != -1) {
            if (*__s != '\0') {
              iVar3 = FUN_00112ee0(param_1,0x11ad29);
              goto joined_r0x00117244;
            }
            goto LAB_0011724a;
          }
        }
        else {
          iVar3 = FUN_00112ee0(param_1,"application/CDFV2-unknown");
joined_r0x00117244:
          if (iVar3 != -1) {
LAB_0011724a:
            uVar15 = 1;
            goto LAB_00116fb7;
          }
        }
      }
      else {
        iVar3 = FUN_00115810(local_708,local_688,local_748,local_738);
        if (iVar3 == -1) {
          free(local_748[0]);
          __s = "Can\'t read SSAT";
          goto LAB_0011702a;
        }
        iVar3 = FUN_001155c0(local_708,local_688,local_748,&local_728);
        if (iVar3 == -1) {
          free(local_738[0]);
          free(local_748[0]);
          __s = "Can\'t read directory";
          goto LAB_0011702a;
        }
        iVar3 = FUN_00115980(local_708,local_688,local_748,&local_728,local_6e8,&local_760);
        if (iVar3 == -1) {
          free(local_728);
          free(local_738[0]);
          free(local_748[0]);
          __s = "Cannot read short stream";
          goto LAB_0011702a;
        }
        ppuVar21 = &local_6c8;
        iVar3 = FUN_00115b30(local_708,local_688,local_748,local_738,local_6e8,&local_728,0,0);
        if (iVar3 == -1) {
LAB_00117195:
          FUN_00115be0();

          if (uVar4 == 0xffffffff) {
            piVar5 = __errno_location();
            __s = "Cannot read summary info";
            if (*piVar5 == 3) {
              __s = "Catalog";
              ppuVar21 = &local_6c8;
              iVar3 = FUN_00115b30(local_708,local_688,local_748,local_738,local_6e8,&local_728,0,0);
              if (iVar3 == -1) {
LAB_00117a08:
                __s = "EncryptedPackage";
                lVar12 = 0;
                do {
                  iVar3 = FUN_00115a00(&local_728,__s,(ulong)(uint)(&DAT_0031fb98)[lVar12]);
                  if (iVar3 < 1) {
                    __s = "mfbu_header";
                    lVar12 = 0;
                    goto LAB_00117a6a;
                  }
                  lVar12 = lVar12 + 1;
                  __s = (&PTR_s_EncryptedPackage_0031fb70)[lVar12];
                } while (__s != (char *)0x0);
                lVar12 = 0;
                goto LAB_00117b81;
              }
              if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
                iVar3 = FUN_00112ee0(param_1,"Microsoft Thumbs.db [",__s,ppuVar21);
                if ((iVar3 != -1) &&
                   (iVar3 = FUN_00116420(local_688,&local_6c8,local_718), iVar3 != -1)) {
                  uVar15 = *local_718[0];
                  if (1 < uVar15) {
                    puVar17 = local_718[0] + 0x45;
                    uVar11 = 1;
                    do {
                      puVar18 = &DAT_0011c18a;
                      if (uVar11 != uVar15 - 1) {
                        puVar18 = (undefined *)0x118228;
                      }
                      FUN_00116a90(local_448,(ulong)*(ushort *)(puVar17 + -2),puVar17);
                      iVar3 = FUN_00112ee0(param_1,&DAT_0011b6ee,uVar8,puVar18);
                      if (iVar3 == -1) {
                        free(local_718[0]);
                        goto LAB_00117a08;
                      }
                      uVar11 = uVar11 + 1;
                      puVar17 = puVar17 + 0x42;
                      uVar15 = *local_718[0];
                    } while (uVar11 < uVar15);
                  }
                  free(local_718[0]);
                  __s = "";
                  uVar4 = 1;
                  goto LAB_001171df;
                }
                goto LAB_00117a08;
              }
              iVar3 = FUN_00112ee0(param_1,"application/CDFV2",__s,ppuVar21);
              if (iVar3 == -1) goto LAB_00117a08;
              goto LAB_00117b4e;
            }
          }
          else {
            iVar3 = FUN_00116240(&local_6c8,local_688,local_6a8,&local_758,&local_750);
            if (iVar3 == -1) {
LAB_00117bbc:
              __s = "Can\'t expand summary_info";
              uVar4 = 0xffffffff;
              goto LAB_00117560;
            }
            uVar4 = *(uint *)(param_1 + 0x38) & 0x410;
            if (uVar4 == 0) {
              iVar3 = FUN_00112ee0(param_1,"Composite Document File V2 Document");
              if (iVar3 == -1) goto LAB_00117bbc;
              __s = "Big";
              if (local_6a8[0] == -2) {
                __s = "Little";
              }
              iVar3 = FUN_00112ee0(param_1,", %s Endian",__s);
              if (iVar3 != -1) {
                uVar15 = (ulong)(local_6a4 >> 8);
                if (local_6a2 == 1) {
                  __s = ", Os: MacOS, Version %d.%d";
LAB_0011738c:
                  iVar3 = FUN_00112ee0(param_1,__s,uVar15);
                  local_7a8 = local_750;
                }
                else {
                  if (local_6a2 == 2) {
                    __s = ", Os: Windows, Version %d.%d";
                    uVar15 = (ulong)(byte)local_6a4;
                    goto LAB_0011738c;
                  }
                  iVar3 = FUN_00112ee0(param_1,", Os %d, Version: %d.%d",(ulong)local_6a2,
                                       (ulong)(byte)local_6a4,uVar15);
                  local_7a8 = local_750;
                }
                if (iVar3 != -1) {
                  if (local_760 != 0) {
                    plVar6 = &DAT_0031fc18;
                    lVar12 = 0xc1084;
                    __s = "MSI Installer";
                    while ((local_750 = local_7a8, *(long *)(local_760 + 0x50) != lVar12 ||
                           (*(long *)(local_760 + 0x58) != plVar6[-2]))) {
                      __s = (char *)plVar6[2];
                      if (__s == (char *)0x0) goto LAB_00117402;
                      lVar12 = *plVar6;
                      plVar6 = plVar6 + 3;
                    }
                    iVar3 = FUN_00112ee0(param_1,0x11ad29,__s);
                    if (iVar3 == -1) goto LAB_001175ec;
LAB_00117402:
                    uVar4 = *(uint *)(param_1 + 0x38) & 0x410;
                    goto LAB_0011740a;
                  }
                  local_798 = (char *)0x0;
                  goto LAB_00117468;
                }
              }
LAB_001175ec:
              __s = "Can\'t expand summary_info";
              uVar4 = 0xfffffffe;
            }
            else {
LAB_0011740a:
              local_7a8 = local_750;
              if ((uVar4 == 0) || (local_760 == 0)) {
                local_798 = (char *)0x0;
              }
              else {
                plVar6 = &DAT_0031fc58;
                lVar12 = 0xc1084;
                local_798 = "x-msi";
                while (((*(long *)(local_760 + 0x50) != lVar12 ||
                        (*(long *)(local_760 + 0x58) != plVar6[-2])) &&
                       (local_798 = (char *)plVar6[2], local_798 != (char *)0x0))) {
                  lVar12 = *plVar6;
                  plVar6 = plVar6 + 3;
                }
              }
LAB_00117468:
              if (local_7a8 != 0) {
                lVar12 = 0;
                puVar19 = local_758;
                do {
                  FUN_00116810(local_488,0x40,(ulong)*puVar19);
                  uVar4 = puVar19[1];
                  switch(uVar4) {
                  default:
                    goto LAB_001175e7;
                  case 1:
                  case 0x47:
                    break;
                  case 2:
                    if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
                      __s = ", %s: %hd";
LAB_001176eb:
                      iVar3 = FUN_00112ee0(param_1,__s,local_488);
joined_r0x001175dc:
                      if (iVar3 == -1) goto LAB_001175e7;
                    }
                    break;
                  case 3:
                    if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
                      __s = ", %s: %d";
                      goto LAB_001176eb;
                    }
                    break;
                  case 4:
                    if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
                      dVar20 = (double)(float)puVar19[2];
LAB_0011771b:
                      iVar3 = FUN_00112ee0(dVar20,param_1,", %s: %g",local_488);
                      goto joined_r0x001175dc;
                    }
                    break;
                  case 5:
                    if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
                      dVar20 = *(double *)(puVar19 + 2);
                      goto LAB_0011771b;
                    }
                    break;
                  case 0x13:
                    if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
                      __s = ", %s: %u";
                      goto LAB_001176eb;
                    }
                    break;
                  case 0x1e:
                  case 0x1f:
                    uVar10 = puVar19[2];
                    if (1 < (int)uVar10) {
                      pbVar9 = *(byte **)(puVar19 + 4);
                      lVar16 = 0;
                      do {
                        uVar10 = uVar10 - 1;
                        if ((uVar10 == 0xffffffff) || (bVar2 = *pbVar9, bVar2 == 0))
                        goto LAB_0011769f;
                        ppuVar7 = __ctype_b_loc();
                        if ((*(byte *)((long)*ppuVar7 + (ulong)bVar2 * 2 + 1) & 0x40) != 0) {
                          local_448[lVar16] = bVar2;
                          lVar16 = lVar16 + 1;
                        }
                        pbVar9 = pbVar9 + (ulong)(uVar4 == 0x1f) + 1;
                      } while (lVar16 != 0x400);
                      lVar16 = 0x3ff;
LAB_0011769f:
                      uVar4 = *(uint *)(param_1 + 0x38);
                      local_448[lVar16] = 0;
                      if ((uVar4 & 0x410) == 0) {
                        if (local_448[0] != 0) goto LAB_001175c5;
                      }
                      else {
                        if ((local_798 == (char *)0x0) && (*puVar19 == 0x12)) {
                          local_798 = (char *)FUN_00116ea0(local_448,&DAT_0031fd40);
                        }
                      }
                    }
                    break;
                  case 0x40:
                    lVar16 = *(long *)(puVar19 + 2);
                    if (lVar16 != 0) {
                      if (lVar16 < 1000000000000000) {
                        FUN_00116880(local_448,0x40,0);
                        uVar4 = *(uint *)(param_1 + 0x38);
                      }
                      else {
                        FUN_00116ae0(local_718,lVar16);
                        __s = (char *)FUN_00116e50(local_718,local_448);
                        if ((__s != (char *)0x0) && (__s = strchr(__s,10), __s != (char *)0x0)) {
                          *__s = '\0';
                        }
                        uVar4 = *(uint *)(param_1 + 0x38);
                      }
                      if ((uVar4 & 0x410) == 0) {
LAB_001175c5:
                        iVar3 = FUN_00112ee0(param_1,", %s: %s",local_488);
                        goto joined_r0x001175dc;
                      }
                    }
                  }
                  lVar12 = lVar12 + 1;
                  puVar19 = puVar19 + 6;
                } while (lVar12 != local_7a8);
              }
              if ((*(uint *)(param_1 + 0x38) & 0x410) != 0) {
                if (local_798 == (char *)0x0) {
                  lVar12 = 0;
                  uVar15 = 0;
                  free(local_758);
                  do {
                    pvVar1 = local_728;
                    if (local_720 <= uVar15) {
                      __s = "vnd.ms-office";
                      uVar4 = *(uint *)(param_1 + 0x38) & 0x410;
                      if (uVar4 != 0) goto LAB_00117835;
                      goto LAB_00117858;
                    }
                    lVar16 = 0;
                    do {
                      bVar2 = FUN_001143f0((ulong)*(ushort *)((long)pvVar1 + lVar16 * 2 + lVar12));
                      local_448[lVar16] = bVar2;
                      lVar16 = lVar16 + 1;
                    } while (lVar16 != 0x20);
                    ppuVar13 = &PTR_DAT_0031fc80;
                    if ((*(uint *)(param_1 + 0x38) & 0x410) != 0) {
                      ppuVar13 = &PTR_DAT_0031fce0;
                    }
                    uVar15 = uVar15 + 1;
                    lVar12 = lVar12 + 0x88;
                    __s = (char *)FUN_00116ea0(local_448,ppuVar13);
                  } while (__s == (char *)0x0);
                  pcVar14 = "%s";
                  if ((*(uint *)(param_1 + 0x38) & 0x410) != 0) {
LAB_00117835:
                    pcVar14 = "application/%s";
                  }
                  iVar3 = FUN_00112ee0(param_1,pcVar14,__s);
                  if (iVar3 != -1) {
                    uVar4 = 1;
LAB_00117858:
                    __s = "";
                    goto LAB_00117560;
                  }
                  goto LAB_00117078;
                }
                iVar3 = FUN_00112ee0(param_1,"application/%s",local_798);
                if (iVar3 == -1) {
LAB_001175e7:
                  free(local_758);
                  goto LAB_001175ec;
                }
              }
              free(local_758);
              __s = "";
              uVar4 = 1;
            }
LAB_00117560:
            free(local_6c8);
          }
          goto LAB_001171df;
        }
        if (((local_6b8 < 0x11) ||
            ((local_6c8[1] ^ 0x6c694620746e656d | *local_6c8 ^ 0x75636f4420505748) != 0)) ||
           (*(char *)(local_6c8 + 2) != 'e')) {
          ppuVar21 = (ulong **)0x117171;
          free(local_6c8);
          local_6c8 = (ulong *)0x0;
          local_6c0 = 0;
          local_6b8 = 0;
          goto LAB_00117195;
        }
        __s = "application/x-hwp";
        if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
          __s = "Hangul (Korean) Word Processor File 5.x";
        }
        iVar3 = FUN_00112ee0(param_1,__s);
        if (iVar3 != -1) {
          __s = "";
          uVar4 = 1;
          goto LAB_00117560;
        }
      }
LAB_00117078:
      uVar15 = 0xffffffff;
      goto LAB_00116fb7;
    }
  }
  uVar15 = 0;
LAB_00116fb7:
  if (local_40 == *(long *)(in_FS_OFFSET + 0x28)) {
    return uVar15;
  }
                    // WARNING: Subroutine does not return
  __stack_chk_fail();
  while( true ) {
    lVar12 = lVar12 + 1;
    __s = (&PTR_s_mfbu_header_0031fbc0)[lVar12];
    if (__s == (char *)0x0) break;
LAB_00117a6a:
    iVar3 = FUN_00115a00(&local_728,__s,(ulong)(uint)(&DAT_0031fbe8)[lVar12]);
    if (iVar3 < 1) goto LAB_00117a7e;
  }
  lVar12 = 1;
LAB_00117b81:
  if ((*(uint *)(param_1 + 0x38) & 0x410) == 0) {
    __s = "CDFV2 %s";
    puVar18 = (&PTR_s_Encrypted_0031fb60)[lVar12 * 10];
  }
  else {
    __s = "application/CDFV2-%s";
    puVar18 = (&PTR_s_encrypted_0031fb68)[lVar12 * 10];
  }
  iVar3 = FUN_00112ee0(param_1,__s,puVar18);
  if (iVar3 == -1) {
LAB_00117a7e:
    __s = "Cannot read section info";
  }
  else {
LAB_00117b4e:
    __s = "";
    uVar4 = 1;
  }
LAB_001171df:
  free(local_6e8[0]);
  free(local_728);
  free(local_738[0]);
  free(local_748[0]);
  uVar15 = (ulong)uVar4;
  if (uVar4 != 0xffffffff) goto LAB_00116fb7;
  goto LAB_0011702a;
}



char * FUN_00117c00(char *param_1,char *param_2,long param_3)

{
  char *pcVar1;
  char cVar2;
  char *pcVar3;
  char *pcVar4;
  
  pcVar4 = param_2;
  if (param_3 == 0) {
LAB_00117c38:
    do {
      pcVar3 = pcVar4 + 1;
      if (*pcVar4 == '\0') break;
      pcVar3 = pcVar4 + 2;
      pcVar1 = pcVar4 + 1;
      pcVar4 = pcVar3;
    } while (*pcVar1 != '\0');
  }
  else {
    do {
      param_3 = param_3 + -1;
      if (param_3 == 0) {
        *param_1 = '\0';
        goto LAB_00117c38;
      }
      pcVar3 = pcVar4 + 1;
      cVar2 = *pcVar4;
      *param_1 = cVar2;
      pcVar4 = pcVar3;
      param_1 = param_1 + 1;
    } while (cVar2 != '\0');
  }
  return pcVar3 + (-1 - (long)param_2);
}



char * FUN_00117c50(char *param_1,char *param_2,long param_3)

{
  char cVar1;
  size_t sVar2;
  char *pcVar3;
  char *pcVar4;
  
  if (param_3 != 0) {
    if (*param_1 == '\0') {
      pcVar3 = (char *)0x0;
    }
    else {
      pcVar4 = param_1;
      do {
        pcVar4 = pcVar4 + 1;
        if (pcVar4 == param_1 + param_3) break;
      } while (*pcVar4 != '\0');
      pcVar3 = pcVar4 + -(long)param_1;
      param_3 = param_3 - (long)pcVar3;
      param_1 = pcVar4;
      if (param_3 == 0) goto LAB_00117cc2;
    }
    cVar1 = *param_2;
    pcVar4 = param_2;
    if (cVar1 != '\0') {
      do {
        if (param_3 != 1) {
          *param_1 = cVar1;
          param_3 = param_3 + -1;
          param_1 = param_1 + 1;
        }
        pcVar4 = pcVar4 + 1;
        cVar1 = *pcVar4;
      } while (cVar1 != '\0');
      pcVar3 = pcVar3 + (long)(pcVar4 + -(long)param_2);
    }
    *param_1 = '\0';
    return pcVar3;
  }
  pcVar3 = (char *)0x0;
LAB_00117cc2:
  sVar2 = strlen(param_2);
  return pcVar3 + sVar2;
}



undefined8 FUN_00118040(byte **param_1,int param_2)

{
  char *pcVar1;
  undefined8 uVar2;
  ushort **ppuVar3;
  byte bVar4;
  byte *pbVar5;
  byte *__s;
  int iVar6;
  int iVar7;
  int iVar8;
  int local_40;
  int local_3c;
  
  __s = *param_1;
  if (param_2 == 0xc) {
    *param_1 = __s + 1;
LAB_00117fc0:
    __s = *param_1;
    if (*__s == 0x2e) {
      pbVar5 = __s + 1;
      bVar4 = __s[1];
      if (bVar4 == 0x2a) {
        *param_1 = pbVar5;
        return 0xd;
      }
      ppuVar3 = __ctype_b_loc();
      while ((*(byte *)((long)*ppuVar3 + (ulong)bVar4 * 2 + 1) & 8) != 0) {
        pbVar5 = pbVar5 + 1;
        bVar4 = *pbVar5;
      }
      *param_1 = pbVar5;
      if (bVar4 == 0) {
        return 0xf;
      }
    }
    else {
      *param_1 = __s;
    }
  }
  else {
    if (param_2 != 0xd) {
      while( true ) {
        pcVar1 = strchr((char *)__s,0x25);
        if (pcVar1 == (char *)0x0) {
          *param_1 = (byte *)0x0;
          return 0xe;
        }
        bVar4 = pcVar1[1];
        __s = (byte *)(pcVar1 + 1);
        if (bVar4 == 0) {
          *param_1 = __s;
          return 0xf;
        }
        if (bVar4 != 0x25) break;
        __s = (byte *)(pcVar1 + 2);
      }
      do {
        pcVar1 = strchr("#0- +",(int)(char)bVar4);
        if (pcVar1 == (char *)0x0) {
          if (bVar4 == 0x2a) {
            *param_1 = __s;
            return 0xc;
          }
          bVar4 = *__s;
          break;
        }
        __s = __s + 1;
        bVar4 = *__s;
      } while (bVar4 != 0);
      ppuVar3 = __ctype_b_loc();
      while ((*(byte *)((long)*ppuVar3 + (ulong)bVar4 * 2 + 1) & 8) != 0) {
        __s = __s + 1;
        bVar4 = *__s;
      }
      *param_1 = __s;
      if (bVar4 == 0) {
        return 0xf;
      }
      goto LAB_00117fc0;
    }
    *param_1 = __s + 1;
  }
  __s = *param_1;
  bVar4 = *__s;
  if (bVar4 == 0x68) {
    bVar4 = __s[1];
    iVar6 = 0;
    pbVar5 = __s + 1;
    iVar7 = 0;
    iVar8 = 1;
LAB_00117d29:
    if (bVar4 == 0) goto LAB_00117d54;
    local_40 = (int)(char)bVar4;
    pcVar1 = strchr("diouxX",local_40);
    if (pcVar1 != (char *)0x0) {
      if (iVar6 == 0) {
        *param_1 = pbVar5;
        if (iVar7 == 0) {
          return 2;
        }
        return 4;
      }
      goto LAB_00117d54;
    }
    local_3c = 0;
  }
  else {
    if ((char)bVar4 < 'i') {
      if (bVar4 == 0x4c) {
        bVar4 = __s[1];
        iVar6 = 1;
        pbVar5 = __s + 1;
        iVar7 = 0;
        iVar8 = 0;
      }
      else {
LAB_00117de0:
        iVar6 = 0;
        iVar7 = 0;
        iVar8 = 0;
        pbVar5 = __s;
      }
      goto LAB_00117d29;
    }
    if (bVar4 != 0x6c) {
      if (bVar4 != 0x71) goto LAB_00117de0;
      bVar4 = __s[1];
      iVar6 = 0;
      iVar7 = 1;
      iVar8 = 0;
      pbVar5 = __s + 1;
      goto LAB_00117d29;
    }
    bVar4 = __s[1];
    pbVar5 = __s + 1;
    if (bVar4 == 0) {
      *param_1 = pbVar5;
      return 0xf;
    }
    if (bVar4 == 0x6c) {
      bVar4 = __s[2];
      iVar6 = 0;
      pbVar5 = __s + 2;
      iVar7 = 1;
      iVar8 = 0;
      goto LAB_00117d29;
    }
    local_40 = (int)(char)bVar4;
    pcVar1 = strchr("diouxX",local_40);
    if (pcVar1 != (char *)0x0) {
      *param_1 = pbVar5;
      return 3;
    }
    iVar6 = 0;
    iVar7 = 0;
    local_3c = 1;
    iVar8 = 0;
  }
  if (bVar4 == 0x6e) {
    if (iVar6 == 0) {
      if (iVar8 != 0) {
        *param_1 = pbVar5;
        return 5;
      }
      *param_1 = pbVar5;
      if (local_3c != 0) {
        return 7;
      }
      if (iVar7 == 0) {
        return 6;
      }
      return 8;
    }
LAB_00117d54:
    *param_1 = pbVar5;
    return 0xf;
  }
  pcVar1 = strchr("DOU",local_40);
  if (pcVar1 == (char *)0x0) {
    pcVar1 = strchr("eEfg",local_40);
    if (pcVar1 != (char *)0x0) {
      if (iVar6 != 0) {
        *param_1 = pbVar5;
        return 10;
      }
      *param_1 = pbVar5;
      uVar2 = 9;
      iVar6 = iVar8 + local_3c + iVar7;
      goto joined_r0x00117fac;
    }
    if (bVar4 == 99) {
      *param_1 = pbVar5;
      if (iVar7 + iVar8 + local_3c + iVar6 != 0) {
        return 0xf;
      }
      return 2;
    }
    if (bVar4 == 0x73) {
      *param_1 = pbVar5;
      uVar2 = 0xb;
      iVar6 = iVar7 + iVar8 + local_3c + iVar6;
      goto joined_r0x00117fac;
    }
    if (bVar4 != 0x70) goto LAB_00117d54;
  }
  *param_1 = pbVar5;
  uVar2 = 3;
  iVar6 = iVar7 + iVar8 + local_3c + iVar6;
joined_r0x00117fac:
  if (iVar6 != 0) {
    return 0xf;
  }
  return uVar2;
}



long FUN_00118170(long param_1,long param_2)

{
  uint uVar1;
  uint uVar2;
  long lVar3;
  long in_FS_OFFSET;
  long local_50;
  long local_48;
  long local_40;
  
  local_40 = *(long *)(in_FS_OFFSET + 0x28);
  lVar3 = param_2;
  if (param_1 != 0) {
    uVar1 = 0;
    uVar2 = 0;
    local_50 = param_1;
    local_48 = param_2;
    do {
      uVar2 = FUN_00118040(&local_50,(ulong)uVar2);
      lVar3 = param_1;
      if ((uVar2 == 0xe) || (lVar3 = param_2, uVar2 == 0xf)) break;
      uVar1 = FUN_00118040(&local_48,(ulong)uVar1);
    } while (uVar2 == uVar1);
  }
  if (local_40 != *(long *)(in_FS_OFFSET + 0x28)) {
                    // WARNING: Subroutine does not return
    __stack_chk_fail();
  }
  return lVar3;
}


//
//void _fini(void)
//
//{
//  return;
//}
//
//
