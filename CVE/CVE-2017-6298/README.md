# Project 

ytnef (https://github.com/Yeraze/ytnef) a stream reader for winmail.dat, commit 3306917 (PROBABLY!) 

# Description

The bug is a null-pointer dereference because of an unchecked return value. In the file lib/ytnef.c, line number 549
we have:

	vl->data = calloc(vl->size, sizeof(WORD));
	temp_word = SwapWord((BYTE*)d, sizeof(WORD));
	memcpy(vl->data, &temp_word, vl->size);

The ```calloc()``` return value is not checked, and thus leads to a potential null-pointer dereference.

# Detections

1. flawfinder
2. Clang Static Analyser
3. Joern
4. ikos
5. Infer

# Decompiled code


In this case there is no big difference between decompiled and original code: tools like joern or flawfinder work pretty good even if the decompiler cannot guess the correct type

Scan-build/Infer do not work on the decomp2recomp version, however Ikos does (i.e., it detects the potential null pointer dereference)

# Actions

Time: 1.5 h

1. Headers
2. Global variables
3. Fix function definitions/implementations

To make scan-build/infer work on the decomp2recom code, we needed to declare the dereferenced null pointer as a ```void *``` and initialize it to null


